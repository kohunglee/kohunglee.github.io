<meta http-equiv="cache-control" content="no-cache">
<meta http-equiv="expires" content="0">
<meta http-equiv="pragma" content="no-cache">
<style>body{margin: 0;}</style>
<script src="./js/w_mod.js"></script>
<script src="./js/cannon.js"></script>
<script src="./js/mymode.js"></script>
<script src="./js/ccgxk_mod.js"></script>
<img src='./img/texture.jpeg' id=marble hidden>
<canvas id=c width=320 height=300></canvas>
<div id="fpsInfo"></div>
<span id="shiftInfo"></span>
<span id="posInfo"></span>
<span id="metrics"></span>
<span id="cpuInfo"></span>
<span id="modListCount"></span>
<span id="posIDMVP"></span>
<!-- <span> <a href="http://127.0.0.1:5505/emloglab/workspace/%E4%B8%89%E7%BB%B4%E6%B2%99%E7%9B%92/obj.html">obj</a></span> -->
<script>
// w.js 初始化
c.width = window.innerWidth - 100
c.height = window.innerHeight - 100
W.reset(c);
W.ambient(0.7);
W.light({ x: 0.5, y: -0.3, z: -0.5});
W.clearColor("8Af");

// 绘制原点坐标轴
W.group({n:'posZero',x:0,y:1,z:0});
W.cube({g:'posZero',x:5,w:10,h:.5,d:.5,b:"f44"});
W.cube({g:'posZero',y:5,h:10,w:.5,d:.5,b:"4f4"});
W.cube({g:'posZero',z:5,d:10,w:.5,h:.5,b:"44f"});
W.pyramid({g:'posZero',size:1,x:10,rz:-90,b:"f44"});
W.pyramid({g:'posZero',size:1,y:10,b:"4f4"});
W.pyramid({g:'posZero', n:'test0001' ,size:1,z:10,rx:90,b:"44f"});




var k = ccgxk;
k.initWorld();
var list = k.bodylist;

k.mainVPlayer = k.addBox({  // 创建一个立方体，并设置为主角
    name: 'mainPlayer', DPZ : 1,
    colliGroup: 1,
    // X: cPos().x + 15, Y: 20, Z: cPos().z + 30,
    X:-8.19, Y:1.00, Z:-22.75,
    rX: 0, rY: 0, rZ: 0, size:1,
    mass: 50, texture: marble
});

k.addBox({  // 创建一个 旋转测试 细长物理体
    DPZ : 2,
    colliGroup: 1,
    name: 'longThin', X: 20, Y: 10, Z: -30,
    mass: 1, width: 40, depth: 2, height: 2, texture: marble
});

k.addBox({  // 创建一个 旋转测试 细长物理体
    DPZ : 2,
    colliGroup: 2,
    name: 'longThin02', X: 20, Y: 10, Z: -50,
    mass: 1, width: 40, depth: 2, height: 2, texture: marble
});

k.addBox({  // 创建地面
    DPZ : 1,
    colliGroup: 1,
    name: 'groundPlane', X: 0, Y: -0.5, Z: 0,
    mass: 0, width: 10000, depth: 10000, height: 2,
    texture: marble, background: '#FFF', mixValue: 0.71,
    XNumber: 10
});

// 随机生成 n 个模型
var yVlaue = 10;
for(var i = 0; i < 1_00; i++){
    k.addBox({
        DPZ : 1,
        isPhysical: true,
        X: Math.floor( Math.random() * 9900 + 1 - 5000), Y: yVlaue, Z: Math.floor( Math.random() * 9900 + 1 - 5000),
        mass: 0, width: Math.floor( Math.random() * 30 + 1), depth: 5, height: Math.floor( Math.random() * 5 + 1),
        background: `#${Math.floor(Math.random() * 16777216).toString(16).padStart(6, '0')}`, mixValue: 0.71,
        texture: marble,
    });
}



// /* ---------- ---------- ---------- ---------- ---------- ---------- ----------*/ /* ---------- ---------- ---------- ---------- ---------- ---------- ----------*/
// // 下面是模型区
// //  x1b1 西一北一区 测试区
// /* ---------- ---------- ---------- ---------- ---------- ---------- ----------*/ /* ---------- ---------- ---------- ---------- ---------- ---------- ----------*/

const red = '#FF0000';
const green = '#00FF00';
const blue = '#0000FF';
const white = '#FFFFFF';
const black = '#000000';
const gray = '#808080';
const yellow = '#FFFF00';
const cyan = '#00FFFF';
const magenta = '#FF00FF';
const orange = '#FFA500';
const brown = '#A52A2A';
var areaid;

// 智能函数
areaid = {ax: -1, az: -1};
function cPos(x = 0, z = 0){
    var poolpos = {x: 1000 * areaid.ax - (500 * Math.sign(areaid.ax)), z: 1000 * areaid.az  - (500 * Math.sign(areaid.az))}; // 中心点
    return {x: x + poolpos.x, z: z + poolpos.z};
}

// 房子地面
k.addBox({
    X: cPos().x, Y: 2, Z: cPos().z,
    mass: 0, width: 100, depth: 100, height: 1,
    background : green, texture: marble
});

// // 随机生成 n 个模型
// var yVlaue = 10;
// for(var i = 0; i < 3_0000; i++){
//     k.addBox({
//         DPZ : 4,
//         isPhysical: true,
//         X: Math.floor( Math.random() * 1000 + 1 - 500), Y: yVlaue, Z: Math.floor( Math.random() * 1000 + 1 - 500),
//         mass: 90, width: 0.03, depth: 0.03, height: 0.03, texture: marble,
//         background: `#00ffff52`, mixValue: 0.71
//     });
// }



// 日本国旗
function drawjpflag(ctx, w, h) {
    const radius = 150;
    ctx.beginPath();
    ctx.arc(w / 2, h / 2, radius, 0, Math.PI * 2);
    ctx.fillStyle = 'red';
    ctx.fill();
    ctx.stroke();
}

// 随机噪音
function drawRandomNoise(ctx, w, h) {
    ctx.fillStyle = '#8B8B83'; ctx.fillRect(0, 0, w, h);
    for(let i = 0; i < 50; i++) {
        const x = Math.random()*w, y = Math.random()*h;
        const s = Math.random()*30, c = `rgba(10,0,10,${Math.random()*0.3})`;
        ctx.fillStyle = c; ctx.beginPath();
        ctx.arc(x, y, s, 0, Math.PI*2); ctx.fill();
    }
}



// 写字
function drawText(ctx){
    ctx.font = "30px Arial";          // 字体大小和类型
    ctx.fillStyle = "red";            // 填充颜色
    ctx.strokeStyle = "blue";         // 描边颜色
    ctx.textAlign = "center";         // 水平对齐方式（left/center/right）
    ctx.textBaseline = "middle";      // 垂直对齐方式（top/middle/bottom）
    ctx.fillText("日本狗香", 150, 50);
}

// 绘制模型
const drawList = [
    {func:drawRandomNoise, id:'xnoise'},
    {func:drawjpflag, id:'jpflag'},
    {func:drawText, id:'xjapangood'}
];

k.loadTexture(drawList).then(res => {
    k.addBox({  // 创建一个立方体，测试我的纹理系统
        DPZ : 2,
        name: 'testTexture', X: 60, Y: 200, Z: -60, XNumber: 5,
        mass: 100, size:90, texture: jpflag, mixValue: 0.1
    });
    W.cube({n:'test0002',x:60,y:200,z:-900, t:jpflag,size:90, xNumber: 5});
})

</script>