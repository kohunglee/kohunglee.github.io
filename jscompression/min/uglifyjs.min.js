// util
"use strict";function characters(t){return t.split("")}function member(t,n){return 0<=n.indexOf(t)}function find_if(t,n){for(var e=n.length;0<=--e;)if(t(n[e]))return n[e]}function configure_error_stack(e,r){var i=e.name+": "+e.message;Object.defineProperty(e,"stack",{get:function(){var t,n;return r&&(r.name=""+e.name,i=""+r.stack,t=""+r.message,r=null,n=(n=i.indexOf(t))<0?0:i.indexOf("\n",n+=t.length)+1,i=i.slice(0,n)+i.slice(i.indexOf("\n",n)+1)),i}})}function DefaultsError(t,n){this.message=t,this.defs=n;try{throw new Error(t)}catch(t){configure_error_stack(this,t)}}function defaults(t,n,e){if(e)for(var r in t)if(HOP(t,r)&&!HOP(n,r))throw new DefaultsError("`"+r+"` is not a supported option",n);for(var r in t)HOP(t,r)&&(n[r]=t[r]);return n}function noop(){}function return_false(){return!1}function return_true(){return!0}function return_this(){return this}function return_null(){return null}DefaultsError.prototype=Object.create(Error.prototype),(DefaultsError.prototype.constructor=DefaultsError).prototype.name="DefaultsError";var List=function(){function t(t,n){for(var e=[],r=0;r<t.length;r++){var i=n(t[r],r);i!==o&&(i instanceof u?e.push.apply(e,i.v):e.push(i))}return e}t.is_op=function(t){return t===o||t instanceof u},t.splice=function(t){return new u(t)};var o=t.skip={};function u(t){this.v=t}return t}();function push_uniq(t,n){if(t.indexOf(n)<0)return t.push(n)}function string_template(t,e){return t.replace(/\{([^{}]+)\}/g,function(t,n){n="this"==n?e:e[n];return n instanceof AST_Node?n.print_to_string():n instanceof AST_Token?n.file+":"+n.line+","+n.col:n})}function remove(t,n){n=t.indexOf(n);0<=n&&t.splice(n,1)}function makePredicate(t){Array.isArray(t)||(t=t.split(" "));var n=Object.create(null);return t.forEach(function(t){n[t]=!0}),n}function all(t,n){for(var e=t.length;0<=--e;)if(!n(t[e],e))return!1;return!0}function Dictionary(){this.values=Object.create(null)}function HOP(t,n){return Object.prototype.hasOwnProperty.call(t,n)}function first_in_statement(t,n,e){for(var r,i=t.parent(-1),o=0;r=t.parent(o++);i=r){if(is_arrow(r))return n&&r.value===i;if(r instanceof AST_Binary){if(r.left===i)continue}else if("Call"==r.TYPE){if(r.expression===i)continue}else if(r instanceof AST_Conditional){if(r.condition===i)continue}else{if(r instanceof AST_ExportDefault)return e;if(r instanceof AST_PropAccess){if(r.expression===i)continue}else if(r instanceof AST_Sequence){if(r.expressions[0]===i)continue}else{if(r instanceof AST_SimpleStatement)return!0;if(r instanceof AST_Template){if(r.tag===i)continue}else if(r instanceof AST_UnaryPostfix&&r.expression===i)continue}}return!1}}function DEF_BITPROPS(r,t){if(31<t.length)throw new Error("Too many properties: "+t.length+"\n"+t.join(", "));t.forEach(function(t,n){var e=1<<n;Object.defineProperty(r.prototype,t,{get:function(){return!!(this._bits&e)},set:function(t){t?this._bits|=e:this._bits&=~e}})})}Dictionary.prototype={set:function(t,n){return"__proto__"==t?this.proto_value=n:this.values[t]=n,this},add:function(t,n){var e=this.get(t);return e?e.push(n):this.set(t,[n]),this},get:function(t){return"__proto__"==t?this.proto_value:this.values[t]},del:function(t){return"__proto__"==t?delete this.proto_value:delete this.values[t],this},has:function(t){return"__proto__"==t?"proto_value"in this:t in this.values},all:function(t){for(var n in this.values)if(!t(this.values[n],n))return!1;return!("proto_value"in this&&!t(this.proto_value,"__proto__"))},each:function(t){for(var n in this.values)t(this.values[n],n);"proto_value"in this&&t(this.proto_value,"__proto__")},size:function(){return Object.keys(this.values).length+("proto_value"in this)},map:function(t){var n,e=[];for(n in this.values)e.push(t(this.values[n],n));return"proto_value"in this&&e.push(t(this.proto_value,"__proto__")),e},clone:function(){var e=new Dictionary;return this.each(function(t,n){e.set(n,t)}),e},toObject:function(){var e={};return this.each(function(t,n){e["$"+n]=t}),e}},Dictionary.fromObject=function(t){var n,e=new Dictionary;for(n in t)HOP(t,n)&&e.set(n.slice(1),t[n]);return e};


// mini
"use strict";var to_ascii,to_base64;function read_source_map(e,a){for(var r=a.end.comments_after,n=r.length;0<=--n;){var o=r[n];if("comment1"!=o.type)break;o=/^# ([^\s=]+)=(\S+)\s*$/.exec(o.value);if(!o)break;if("sourceMappingURL"==o[1]){if(o=/^data:application\/json(;.*?)?;base64,([^,]+)$/.exec(o[2]))return to_ascii(o[2]);break}}AST_Node.warn("inline source map not found: {name}",{name:e})}function parse_source_map(a){try{return JSON.parse(a)}catch(e){throw new Error("invalid input source map: "+a)}}function set_shorthand(a,r,e){e.forEach(function(e){r[e]&&("object"!=typeof r[e]&&(r[e]={}),a in r[e]||(r[e][a]=r[a]))})}function init_cache(e){e&&("props"in e?e.props instanceof Dictionary||(e.props=Dictionary.fromObject(e.props)):e.props=new Dictionary)}function to_json(e){return{props:e.props.toObject()}}function minify(n,o){try{(o=defaults(o,{annotations:void 0,compress:{},enclose:!1,expression:!1,ie:!1,ie8:!1,keep_fargs:!1,keep_fnames:!1,mangle:{},module:void 0,nameCache:null,output:{},parse:{},rename:void 0,sourceMap:!1,timings:!1,toplevel:!(!o||o.expression||!o.module)||void 0,v8:!1,validate:!1,warnings:!1,webkit:!1,wrap:!1},!0)).validate&&AST_Node.enable_validation();var e,s,a=o.timings&&{start:Date.now()},r=(void 0!==o.annotations&&set_shorthand("annotations",o,["compress","output"]),o.expression&&set_shorthand("expression",o,["compress","parse"]),o.ie8&&(o.ie=o.ie||o.ie8),o.ie&&set_shorthand("ie",o,["compress","mangle","output","rename"]),o.keep_fargs&&set_shorthand("keep_fargs",o,["compress","mangle","rename"]),o.keep_fnames&&set_shorthand("keep_fnames",o,["compress","mangle","rename"]),void 0!==o.module||o.ie||(o.module=!0),o.module&&set_shorthand("module",o,["compress","parse"]),void 0!==o.toplevel&&set_shorthand("toplevel",o,["compress","mangle","rename"]),o.v8&&set_shorthand("v8",o,["mangle","output","rename"]),o.webkit&&set_shorthand("webkit",o,["compress","mangle","output","rename"]),o.mangle&&(o.mangle=defaults(o.mangle,{cache:o.nameCache&&(o.nameCache.vars||{}),eval:!1,ie:!1,keep_fargs:!1,keep_fnames:!1,properties:!1,reserved:[],toplevel:!1,v8:!1,webkit:!1},!0),o.mangle.properties&&("object"!=typeof o.mangle.properties&&(o.mangle.properties={}),o.mangle.properties.keep_quoted&&(e=o.mangle.properties.reserved,Array.isArray(e)||(e=[]),o.mangle.properties.reserved=e),!o.nameCache||"cache"in o.mangle.properties||(o.mangle.properties.cache=o.nameCache.props||{})),init_cache(o.mangle.cache),init_cache(o.mangle.properties.cache)),void 0===o.rename&&(o.rename=o.compress&&o.mangle),o.sourceMap&&(o.sourceMap=defaults(o.sourceMap,{content:null,filename:null,includeSources:!1,names:!0,root:null,url:null},!0)),[]);if(o.warnings&&AST_Node.log_function(function(e){r.push(e)},"verbose"==o.warnings),a&&(a.parse=Date.now()),o.parse=o.parse||{},n instanceof AST_Node)s=n;else{"string"==typeof n&&(n=[n]),o.parse.toplevel=null;var t,p=o.sourceMap&&o.sourceMap.content;for(l in(p="string"==typeof p&&"inline"!=p?parse_source_map(p):p)&&(o.sourceMap.orig=Object.create(null)),n)HOP(n,l)&&(o.parse.filename=l,o.parse.toplevel=s=parse(n[l],o.parse),"inline"==p?(t=read_source_map(l,s))&&(o.sourceMap.orig[l]=parse_source_map(t)):p&&(o.sourceMap.orig[l]=p))}o.parse.expression&&(s=s.wrap_expression()),e&&reserve_quoted_keys(s,e),["enclose","wrap"].forEach(function(e){var a,r=o[e];r&&(a=s.print_to_string().slice(0,-1),s=s[e](r),n[s.start.file]=s.print_to_string().replace(a,""))}),o.validate&&s.validate_ast(),a&&(a.rename=Date.now()),o.rename&&(s.figure_out_scope(o.rename),s.expand_names(o.rename)),a&&(a.compress=Date.now()),o.compress&&(s=new Compressor(o.compress).compress(s),o.validate)&&s.validate_ast(),a&&(a.scope=Date.now()),o.mangle&&s.figure_out_scope(o.mangle),a&&(a.mangle=Date.now()),o.mangle&&(s.compute_char_frequency(o.mangle),s.mangle_names(o.mangle)),a&&(a.properties=Date.now()),e&&reserve_quoted_keys(s,e),o.mangle&&o.mangle.properties&&mangle_properties(s,o.mangle.properties),o.parse.expression&&(s=s.unwrap_expression()),a&&(a.output=Date.now());var i={},c=defaults(o.output,{ast:!1,code:!0});if(c.ast&&(i.ast=s),c.code){if(o.sourceMap&&(c.source_map=SourceMap(o.sourceMap),o.sourceMap.includeSources)){if(n instanceof AST_Toplevel)throw new Error("original source content unavailable");for(var l in n)HOP(n,l)&&c.source_map.setSourceContent(l,n[l])}delete c.ast,delete c.code;var m,u=OutputStream(c);s.print(u),i.code=u.get(),o.sourceMap&&(i.map=c.source_map.toString(),m=o.sourceMap.url)&&(i.code=i.code.replace(/\n\/\/# sourceMappingURL=\S+\s*$/,""),i.code+="inline"==m?"\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,"+to_base64(i.map):"\n//# sourceMappingURL="+m)}return o.nameCache&&o.mangle&&(o.mangle.cache&&(o.nameCache.vars=to_json(o.mangle.cache)),o.mangle.properties)&&o.mangle.properties.cache&&(o.nameCache.props=to_json(o.mangle.properties.cache)),a&&(a.end=Date.now(),i.timings={parse:.001*(a.rename-a.parse),rename:.001*(a.compress-a.rename),compress:.001*(a.scope-a.compress),scope:.001*(a.mangle-a.scope),mangle:.001*(a.properties-a.mangle),properties:.001*(a.output-a.properties),output:.001*(a.end-a.output),total:.001*(a.end-a.start)}),r.length&&(i.warnings=r),i}catch(e){return{error:e}}finally{AST_Node.log_function(),AST_Node.disable_validation()}}to_base64="undefined"==typeof Buffer?(to_ascii=atob,btoa):void 0===Buffer.alloc?(to_ascii=function(e){return new Buffer(e,"base64").toString()},function(e){return new Buffer(e).toString("base64")}):(to_ascii=function(e){return Buffer.from(e,"base64").toString()},function(e){return Buffer.from(e).toString("base64")});


// ast -0
"use strict";function DEFNODE(e,t,n,o){void 0===o&&(o=AST_Node);var i,a=t=t?t.split(/\s+/):[],s=(o&&o.PROPS&&(t=t.concat(o.PROPS)),["return function AST_",e,"(props){","this._bits=0;","if(props){"]),r=(t.forEach(function(e){s.push("this.",e,"=props.",e,";")}),s.push("}"),Object.create(o&&o.prototype)),l=((n.initialize||r.initialize)&&s.push("this.initialize();"),s.push("};"),new Function(s.join(""))());for(i in l.prototype=r,(l.prototype.CTOR=l).prototype.TYPE=l.TYPE=e,o&&(l.BASE=o).SUBCLASSES.push(l),l.DEFMETHOD=function(e,t){this.prototype[e]=t},l.PROPS=t,l.SELF_PROPS=a,l.SUBCLASSES=[],n)HOP(n,i)&&(/^\$/.test(i)?l[i.substr(1)]=n[i]:l.DEFMETHOD(i,n[i]));return"undefined"!=typeof exports&&(exports["AST_"+e]=l),l}var AST_Token=DEFNODE("Token","type value line col pos endline endcol endpos nlb comments_before comments_after file raw",{},null),AST_Node=DEFNODE("Node","start end",{_clone:function(e){var t;return e?(t=this.clone()).transform(new TreeTransformer(function(e){if(e!==t)return e.clone(!0)})):new this.CTOR(this)},clone:function(e){return this._clone(e)},$documentation:"Base class of all AST nodes",$propdoc:{start:"[AST_Token] The first token of this node",end:"[AST_Token] The last token of this node"},equals:function(e){return this.TYPE==e.TYPE&&this._equals(e)},walk:function(e){e.visit(this)},_validate:function(){if("Node"==this.TYPE)throw new Error("should not instantiate AST_Node")},validate:function(){for(var e=this.CTOR;e.prototype._validate.call(this),e=e.BASE;);},validate_ast:function(){var t={};this.walk(new TreeWalker(function(e){if(e.validate_visited===t)throw new Error(string_template("cannot reuse AST_{TYPE} from [{start}]",e));e.validate_visited=t}))}},null),restore_transforms=(DEF_BITPROPS(AST_Node,["_optimized","_squeezed","call_only","collapse_scanning","defined","evaluating","falsy","in_arg","in_bool","is_undefined","inlined","length_read","nested","new","optional","private","pure","single_use","static","terminal","truthy","uses_eval","uses_with"]),(AST_Node.log_function=function(t,e){var n;function o(e){n[e]||(n[e]=!0,t(e))}"function"!=typeof t?AST_Node.info=AST_Node.warn=noop:(n=Object.create(null),AST_Node.info=e?function(e,t){o("INFO: "+string_template(e,t))}:noop,AST_Node.warn=function(e,t){o("WARN: "+string_template(e,t))})})(),[]);function all_equals(e,n){return e.length==n.length&&all(e,function(e,t){return e.equals(n[t])})}function list_equals(e,n){return e.length==n.length&&all(e,function(e,t){return e==n[t]})}function prop_equals(e,t){return e===t||(null==e?null==t:e instanceof AST_Node&&t instanceof AST_Node&&e.equals(t))}AST_Node.enable_validation=function(){AST_Node.disable_validation(),function e(t){var n;t.SUBCLASSES.forEach(e),HOP(t.prototype,"transform")&&(n=t.prototype.transform,t.prototype.transform=function(e,t){e=n.call(this,e,t);if(e instanceof AST_Node)e.validate();else if(!(null===e||t&&List.is_op(e)))throw new Error("invalid transformed value: "+e);return e},restore_transforms.push(function(){t.prototype.transform=n}))}(this)},AST_Node.disable_validation=function(){for(var e;e=restore_transforms.pop();)e()};var AST_Statement=DEFNODE("Statement",null,{$documentation:"Base class of all statements",_validate:function(){if("Statement"==this.TYPE)throw new Error("should not instantiate AST_Statement")}}),AST_Debugger=DEFNODE("Debugger",null,{$documentation:"Represents a debugger statement",_equals:return_true},AST_Statement),AST_Directive=DEFNODE("Directive","quote value",{$documentation:'Represents a directive, like "use strict";',$propdoc:{quote:"[string?] the original quote character",value:"[string] The value of this directive as a plain string (it's not an AST_String!)"},_equals:function(e){return this.value==e.value},_validate:function(){if(null!=this.quote){if("string"!=typeof this.quote)throw new Error("quote must be string");if(!/^["']$/.test(this.quote))throw new Error("invalid quote: "+this.quote)}if("string"!=typeof this.value)throw new Error("value must be string")}},AST_Statement),AST_EmptyStatement=DEFNODE("EmptyStatement",null,{$documentation:"The empty statement (empty block or simply a semicolon)",_equals:return_true},AST_Statement);function is_statement(e){return e instanceof AST_Statement&&!(e instanceof AST_ClassExpression)&&!(e instanceof AST_LambdaExpression)}function validate_expression(e,t,n,o,i){if(n=n?"contain":"be",!(e instanceof AST_Node))throw new Error(t+" must "+n+" AST_Node");if(e instanceof AST_DefaultValue)throw new Error(t+" cannot "+n+" AST_DefaultValue");if(e instanceof AST_Destructured)throw new Error(t+" cannot "+n+" AST_Destructured");if(e instanceof AST_Hole&&!i)throw new Error(t+" cannot "+n+" AST_Hole");if(e instanceof AST_Spread&&!o)throw new Error(t+" cannot "+n+" AST_Spread");if(is_statement(e))throw new Error(t+" cannot "+n+" AST_Statement");if(e instanceof AST_SymbolDeclaration)throw new Error(t+" cannot "+n+" AST_SymbolDeclaration")}function must_be_expression(e,t){validate_expression(e[t],t)}var AST_SimpleStatement=DEFNODE("SimpleStatement","body",{$documentation:"A statement consisting of an expression, i.e. a = 1 + 2",$propdoc:{body:"[AST_Node] an expression node (should not be instanceof AST_Statement)"},_equals:function(e){return this.body.equals(e.body)},walk:function(e){var t=this;e.visit(t,function(){t.body.walk(e)})},_validate:function(){must_be_expression(this,"body")}},AST_Statement),AST_BlockScope=DEFNODE("BlockScope","_var_names enclosed functions make_def parent_scope variables",{$documentation:"Base class for all statements introducing a lexical scope",$propdoc:{enclosed:"[SymbolDef*/S] a list of all symbol definitions that are accessed from this scope or any inner scopes",functions:"[Dictionary/S] like `variables`, but only lists function declarations",parent_scope:"[AST_Scope?/S] link to the parent scope",variables:"[Dictionary/S] a map of name ---\x3e SymbolDef for all variables/functions defined in this scope"},clone:function(e){e=this._clone(e);return this.enclosed&&(e.enclosed=this.enclosed.slice()),this.functions&&(e.functions=this.functions.clone()),this.variables&&(e.variables=this.variables.clone()),e},pinned:function(){return this.resolve().pinned()},resolve:function(){return this.parent_scope.resolve()},_validate:function(){if("BlockScope"==this.TYPE)throw new Error("should not instantiate AST_BlockScope");if(null!=this.parent_scope){if(!(this.parent_scope instanceof AST_BlockScope))throw new Error("parent_scope must be AST_BlockScope");if(!(this.resolve()instanceof AST_Scope))throw new Error("must be contained within AST_Scope")}}},AST_Statement);function walk_body(e,t){e.body.forEach(function(e){e.walk(t)})}var AST_Block=DEFNODE("Block","body",{$documentation:"A body of statements (usually braced)",$propdoc:{body:"[AST_Statement*] an array of statements"},_equals:function(e){return all_equals(this.body,e.body)},walk:function(e){var t=this;e.visit(t,function(){walk_body(t,e)})},_validate:function(){if("Block"==this.TYPE)throw new Error("should not instantiate AST_Block");this.body.forEach(function(e){if(!is_statement(e))throw new Error("body must contain AST_Statement")})}},AST_BlockScope),AST_BlockStatement=DEFNODE("BlockStatement",null,{$documentation:"A block statement"},AST_Block),AST_StatementWithBody=DEFNODE("StatementWithBody","body",{$documentation:"Base class for all statements that contain one nested body: `For`, `ForIn`, `Do`, `While`, `With`",$propdoc:{body:"[AST_Statement] the body; this should always be present, even if it's an AST_EmptyStatement"},_validate:function(){if("StatementWithBody"==this.TYPE)throw new Error("should not instantiate AST_StatementWithBody");if(!is_statement(this.body))throw new Error("body must be AST_Statement")}},AST_BlockScope),AST_LabeledStatement=DEFNODE("LabeledStatement","label",{$documentation:"Statement with a label",$propdoc:{label:"[AST_Label] a label definition"},_equals:function(e){return this.label.equals(e.label)&&this.body.equals(e.body)},walk:function(e){var t=this;e.visit(t,function(){t.label.walk(e),t.body.walk(e)})},clone:function(e){var t,n,o=this._clone(e);return e&&(t=o.label,n=this.label,o.walk(new TreeWalker(function(e){return e instanceof AST_LoopControl?e.label&&e.label.thedef===n?((e.label.thedef=t).references.push(e),!0):void 0:e instanceof AST_Scope||void 0}))),o},_validate:function(){if(!(this.label instanceof AST_Label))throw new Error("label must be AST_Label")}},AST_StatementWithBody),AST_IterationStatement=DEFNODE("IterationStatement",null,{$documentation:"Internal class.  All loops inherit from it.",_validate:function(){if("IterationStatement"==this.TYPE)throw new Error("should not instantiate AST_IterationStatement")}},AST_StatementWithBody),AST_DWLoop=DEFNODE("DWLoop","condition",{$documentation:"Base class for do/while statements",$propdoc:{condition:"[AST_Node] the loop condition.  Should not be instanceof AST_Statement"},_equals:function(e){return this.body.equals(e.body)&&this.condition.equals(e.condition)},_validate:function(){if("DWLoop"==this.TYPE)throw new Error("should not instantiate AST_DWLoop");must_be_expression(this,"condition")}},AST_IterationStatement),AST_Do=DEFNODE("Do",null,{$documentation:"A `do` statement",walk:function(e){var t=this;e.visit(t,function(){t.body.walk(e),t.condition.walk(e)})}},AST_DWLoop),AST_While=DEFNODE("While",null,{$documentation:"A `while` statement",walk:function(e){var t=this;e.visit(t,function(){t.condition.walk(e),t.body.walk(e)})}},AST_DWLoop),AST_For=DEFNODE("For","init condition step",{$documentation:"A `for` statement",$propdoc:{init:"[AST_Node?] the `for` initialization code, or null if empty",condition:"[AST_Node?] the `for` termination clause, or null if empty",step:"[AST_Node?] the `for` update clause, or null if empty"},_equals:function(e){return prop_equals(this.init,e.init)&&prop_equals(this.condition,e.condition)&&prop_equals(this.step,e.step)&&this.body.equals(e.body)},walk:function(e){var t=this;e.visit(t,function(){t.init&&t.init.walk(e),t.condition&&t.condition.walk(e),t.step&&t.step.walk(e),t.body.walk(e)})},_validate:function(){if(null!=this.init){if(!(this.init instanceof AST_Node))throw new Error("init must be AST_Node");if(is_statement(this.init)&&!(this.init instanceof AST_Definitions))throw new Error("init cannot be AST_Statement")}null!=this.condition&&must_be_expression(this,"condition"),null!=this.step&&must_be_expression(this,"step")}},AST_IterationStatement),AST_ForEnumeration=DEFNODE("ForEnumeration","init object",{$documentation:"Base class for enumeration loops, i.e. `for ... in`, `for ... of` & `for await ... of`",$propdoc:{init:"[AST_Node] the assignment target during iteration",object:"[AST_Node] the object to iterate over"},_equals:function(e){return this.init.equals(e.init)&&this.object.equals(e.object)&&this.body.equals(e.body)},walk:function(e){var t=this;e.visit(t,function(){t.init.walk(e),t.object.walk(e),t.body.walk(e)})},_validate:function(){if("ForEnumeration"==this.TYPE)throw new Error("should not instantiate AST_ForEnumeration");if(this.init instanceof AST_Definitions){if(1!=this.init.definitions.length)throw new Error("init must have single declaration")}else validate_destructured(this.init,function(e){if(!(e instanceof AST_PropAccess||e instanceof AST_SymbolRef))throw new Error("init must be assignable: "+e.TYPE)});must_be_expression(this,"object")}},AST_IterationStatement),AST_ForIn=DEFNODE("ForIn",null,{$documentation:"A `for ... in` statement"},AST_ForEnumeration),AST_ForOf=DEFNODE("ForOf",null,{$documentation:"A `for ... of` statement"},AST_ForEnumeration),AST_ForAwaitOf=DEFNODE("ForAwaitOf",null,{$documentation:"A `for await ... of` statement"},AST_ForOf),AST_With=DEFNODE("With","expression",{$documentation:"A `with` statement",$propdoc:{expression:"[AST_Node] the `with` expression"},_equals:function(e){return this.expression.equals(e.expression)&&this.body.equals(e.body)},walk:function(e){var t=this;e.visit(t,function(){t.expression.walk(e),t.body.walk(e)})},_validate:function(){must_be_expression(this,"expression")}},AST_StatementWithBody),AST_Scope=DEFNODE("Scope","fn_defs may_call_this uses_eval uses_with",{$documentation:"Base class for all statements introducing a lambda scope",$propdoc:{uses_eval:"[boolean/S] tells whether this scope contains a direct call to the global `eval`",uses_with:"[boolean/S] tells whether this scope uses the `with` statement"},pinned:function(){return this.uses_eval||this.uses_with},resolve:return_this,_validate:function(){if("Scope"==this.TYPE)throw new Error("should not instantiate AST_Scope")}},AST_Block),AST_Toplevel=DEFNODE("Toplevel","globals",{$documentation:"The toplevel scope",$propdoc:{globals:"[Dictionary/S] a map of name ---\x3e SymbolDef for all undeclared names"},wrap:function(e){var t=this.body;return parse(["(function(exports){'$ORIG';})(typeof ",e,"=='undefined'?(",e,"={}):",e,");"].join(""),{filename:"wrap="+JSON.stringify(e)}).transform(new TreeTransformer(function(e){if(e instanceof AST_Directive&&"$ORIG"==e.value)return List.splice(t)}))},enclose:function(e){var t=(e="string"!=typeof e?"":e).indexOf(":"),n=(t<0&&(t=e.length),this.body);return parse(["(function(",e.slice(0,t),'){"$ORIG"})(',e.slice(t+1),")"].join(""),{filename:"enclose="+JSON.stringify(e)}).transform(new TreeTransformer(function(e){if(e instanceof AST_Directive&&"$ORIG"==e.value)return List.splice(n)}))}},AST_Scope),AST_ClassInitBlock=DEFNODE("ClassInitBlock",null,{$documentation:"Value for `class` static initialization blocks"},AST_Scope),AST_Lambda=DEFNODE("Lambda","argnames length_read rest safe_ids uses_arguments",{$documentation:"Base class for functions",$propdoc:{argnames:"[(AST_DefaultValue|AST_Destructured|AST_SymbolFunarg)*] array of function arguments and/or destructured literals",length_read:"[boolean/S] whether length property of this function is accessed",rest:"[(AST_Destructured|AST_SymbolFunarg)?] rest parameter, or null if absent",uses_arguments:"[boolean|number/S] whether this function accesses the arguments array"},each_argname:function(t){var n=new TreeWalker(function(e){return e instanceof AST_DefaultValue?(e.name.walk(n),!0):e instanceof AST_DestructuredKeyVal?(e.value.walk(n),!0):void(e instanceof AST_SymbolFunarg&&t(e))});this.argnames.forEach(function(e){e.walk(n)}),this.rest&&this.rest.walk(n)},_equals:function(e){return prop_equals(this.rest,e.rest)&&prop_equals(this.name,e.name)&&prop_equals(this.value,e.value)&&all_equals(this.argnames,e.argnames)&&all_equals(this.body,e.body)},walk:function(t){var e=this;t.visit(e,function(){e.name&&e.name.walk(t),e.argnames.forEach(function(e){e.walk(t)}),e.rest&&e.rest.walk(t),walk_body(e,t)})},_validate:function(){if("Lambda"==this.TYPE)throw new Error("should not instantiate AST_Lambda");this.argnames.forEach(function(e){validate_destructured(e,function(e){if(!(e instanceof AST_SymbolFunarg))throw new Error("argnames must be AST_SymbolFunarg[]")},!0)}),null!=this.rest&&validate_destructured(this.rest,function(e){if(!(e instanceof AST_SymbolFunarg))throw new Error("rest must be AST_SymbolFunarg")})}},AST_Scope),AST_Accessor=DEFNODE("Accessor",null,{$documentation:"A getter/setter function",_validate:function(){if(null!=this.name)throw new Error("name must be null")}},AST_Lambda),AST_LambdaExpression=DEFNODE("LambdaExpression","inlined",{$documentation:"Base class for function expressions",$propdoc:{inlined:"[boolean/S] whether this function has been inlined"},_validate:function(){if("LambdaExpression"==this.TYPE)throw new Error("should not instantiate AST_LambdaExpression")}},AST_Lambda);function is_arrow(e){return e instanceof AST_Arrow||e instanceof AST_AsyncArrow}function is_async(e){return e instanceof AST_AsyncArrow||e instanceof AST_AsyncDefun||e instanceof AST_AsyncFunction||e instanceof AST_AsyncGeneratorDefun||e instanceof AST_AsyncGeneratorFunction}function is_generator(e){return e instanceof AST_AsyncGeneratorDefun||e instanceof AST_AsyncGeneratorFunction||e instanceof AST_GeneratorDefun||e instanceof AST_GeneratorFunction}function walk_lambda(e,t){is_arrow(e)&&e.value?e.value.walk(t):walk_body(e,t)}var AST_Arrow=DEFNODE("Arrow","value",{$documentation:"An arrow function expression",$propdoc:{value:"[AST_Node?] simple return expression, or null if using function body."},walk:function(t){var e=this;t.visit(e,function(){e.argnames.forEach(function(e){e.walk(t)}),e.rest&&e.rest.walk(t),e.value?e.value.walk(t):walk_body(e,t)})},_validate:function(){if(null!=this.name)throw new Error("name must be null");if(this.uses_arguments)throw new Error("uses_arguments must be false");if(null!=this.value&&(must_be_expression(this,"value"),this.body.length))throw new Error("body must be empty if value exists")}},AST_LambdaExpression),AST_AsyncArrow=DEFNODE("AsyncArrow","value",{$documentation:"An asynchronous arrow function expression",$propdoc:{value:"[AST_Node?] simple return expression, or null if using function body."},walk:function(t){var e=this;t.visit(e,function(){e.argnames.forEach(function(e){e.walk(t)}),e.rest&&e.rest.walk(t),e.value?e.value.walk(t):walk_body(e,t)})},_validate:function(){if(null!=this.name)throw new Error("name must be null");if(this.uses_arguments)throw new Error("uses_arguments must be false");if(null!=this.value&&(must_be_expression(this,"value"),this.body.length))throw new Error("body must be empty if value exists")}},AST_LambdaExpression),AST_AsyncFunction=DEFNODE("AsyncFunction","name",{$documentation:"An asynchronous function expression",$propdoc:{name:"[AST_SymbolLambda?] the name of this function, or null if not specified"},_validate:function(){if(null!=this.name&&!(this.name instanceof AST_SymbolLambda))throw new Error("name must be AST_SymbolLambda")}},AST_LambdaExpression),AST_AsyncGeneratorFunction=DEFNODE("AsyncGeneratorFunction","name",{$documentation:"An asynchronous generator function expression",$propdoc:{name:"[AST_SymbolLambda?] the name of this function, or null if not specified"},_validate:function(){if(null!=this.name&&!(this.name instanceof AST_SymbolLambda))throw new Error("name must be AST_SymbolLambda")}},AST_LambdaExpression),AST_Function=DEFNODE("Function","name",{$documentation:"A function expression",$propdoc:{name:"[AST_SymbolLambda?] the name of this function, or null if not specified"},_validate:function(){if(null!=this.name&&!(this.name instanceof AST_SymbolLambda))throw new Error("name must be AST_SymbolLambda")}},AST_LambdaExpression),AST_GeneratorFunction=DEFNODE("GeneratorFunction","name",{$documentation:"A generator function expression",$propdoc:{name:"[AST_SymbolLambda?] the name of this function, or null if not specified"},_validate:function(){if(null!=this.name&&!(this.name instanceof AST_SymbolLambda))throw new Error("name must be AST_SymbolLambda")}},AST_LambdaExpression),AST_LambdaDefinition=DEFNODE("LambdaDefinition","inlined name",{$documentation:"Base class for function definitions",$propdoc:{inlined:"[boolean/S] whether this function has been inlined",name:"[AST_SymbolDefun] the name of this function"},_validate:function(){if("LambdaDefinition"==this.TYPE)throw new Error("should not instantiate AST_LambdaDefinition");if(!(this.name instanceof AST_SymbolDefun))throw new Error("name must be AST_SymbolDefun")}},AST_Lambda),AST_AsyncDefun=DEFNODE("AsyncDefun",null,{$documentation:"An asynchronous function definition"},AST_LambdaDefinition),AST_AsyncGeneratorDefun=DEFNODE("AsyncGeneratorDefun",null,{$documentation:"An asynchronous generator function definition"},AST_LambdaDefinition),AST_Defun=DEFNODE("Defun",null,{$documentation:"A function definition"},AST_LambdaDefinition),AST_GeneratorDefun=DEFNODE("GeneratorDefun",null,{$documentation:"A generator function definition"},AST_LambdaDefinition),AST_Class=DEFNODE("Class","extends name properties",{$documentation:"Base class for class literals",$propdoc:{extends:"[AST_Node?] the super class, or null if not specified",properties:"[AST_ClassProperty*] array of class properties"},_equals:function(e){return prop_equals(this.name,e.name)&&prop_equals(this.extends,e.extends)&&all_equals(this.properties,e.properties)},resolve:function(e){return e?this:this.parent_scope.resolve()},walk:function(t){var e=this;t.visit(e,function(){e.name&&e.name.walk(t),e.extends&&e.extends.walk(t),e.properties.forEach(function(e){e.walk(t)})})},_validate:function(){if("Class"==this.TYPE)throw new Error("should not instantiate AST_Class");null!=this.extends&&must_be_expression(this,"extends"),this.properties.forEach(function(e){if(!(e instanceof AST_ClassProperty))throw new Error("properties must contain AST_ClassProperty")})}},AST_BlockScope),AST_DefClass=DEFNODE("DefClass",null,{$documentation:"A class definition",$propdoc:{name:"[AST_SymbolDefClass] the name of this class"},_validate:function(){if(!(this.name instanceof AST_SymbolDefClass))throw new Error("name must be AST_SymbolDefClass")}},AST_Class),AST_ClassExpression=DEFNODE("ClassExpression",null,{$documentation:"A class expression",$propdoc:{name:"[AST_SymbolClass?] the name of this class, or null if not specified"},_validate:function(){if(null!=this.name&&!(this.name instanceof AST_SymbolClass))throw new Error("name must be AST_SymbolClass")}},AST_Class),AST_ClassProperty=DEFNODE("ClassProperty","key private static value",{$documentation:"Base class for `class` properties",$propdoc:{key:"[string|AST_Node?] property name (AST_Node for computed property, null for initialization block)",private:"[boolean] whether this is a private property",static:"[boolean] whether this is a static property",value:"[AST_Node?] property value (AST_Accessor for getters/setters, AST_LambdaExpression for methods, null if not specified for fields)"},_equals:function(e){return!this.private==!e.private&&!this.static==!e.static&&prop_equals(this.key,e.key)&&prop_equals(this.value,e.value)},walk:function(e){var t=this;e.visit(t,function(){t.key instanceof AST_Node&&t.key.walk(e),t.value&&t.value.walk(e)})},_validate:function(){if("ClassProperty"==this.TYPE)throw new Error("should not instantiate AST_ClassProperty");if(this instanceof AST_ClassInit){if(null!=this.key)throw new Error("key must be null")}else if("string"!=typeof this.key){if(!(this.key instanceof AST_Node))throw new Error("key must be string or AST_Node");if(this.private)throw new Error("computed key cannot be private");must_be_expression(this,"key")}else if(this.private&&!/^#/.test(this.key))throw new Error("private key must prefix with #");if(null!=this.value&&!(this.value instanceof AST_Node))throw new Error("value must be AST_Node")}}),AST_ClassField=DEFNODE("ClassField",null,{$documentation:"A `class` field",_validate:function(){null!=this.value&&must_be_expression(this,"value")}},AST_ClassProperty),AST_ClassGetter=DEFNODE("ClassGetter",null,{$documentation:"A `class` getter",_validate:function(){if(!(this.value instanceof AST_Accessor))throw new Error("value must be AST_Accessor")}},AST_ClassProperty),AST_ClassSetter=DEFNODE("ClassSetter",null,{$documentation:"A `class` setter",_validate:function(){if(!(this.value instanceof AST_Accessor))throw new Error("value must be AST_Accessor")}},AST_ClassProperty),AST_ClassMethod=DEFNODE("ClassMethod",null,{$documentation:"A `class` method",_validate:function(){if(!(this.value instanceof AST_LambdaExpression))throw new Error("value must be AST_LambdaExpression");if(is_arrow(this.value))throw new Error("value cannot be AST_Arrow or AST_AsyncArrow");if(null!=this.value.name)throw new Error("name of class method's lambda must be null")}},AST_ClassProperty),AST_ClassInit=DEFNODE("ClassInit",null,{$documentation:"A `class` static initialization block",_validate:function(){if(!this.static)throw new Error("static must be true");if(!(this.value instanceof AST_ClassInitBlock))throw new Error("value must be AST_ClassInitBlock")},initialize:function(){this.static=!0}},AST_ClassProperty),AST_Jump=DEFNODE("Jump",null,{$documentation:"Base class for “jumps” (for now that's `return`, `throw`, `break` and `continue`)",_validate:function(){if("Jump"==this.TYPE)throw new Error("should not instantiate AST_Jump")}},AST_Statement),AST_Exit=DEFNODE("Exit","value",{$documentation:"Base class for “exits” (`return` and `throw`)",$propdoc:{value:"[AST_Node?] the value returned or thrown by this statement; could be null for AST_Return"},_equals:function(e){return prop_equals(this.value,e.value)},walk:function(e){var t=this;e.visit(t,function(){t.value&&t.value.walk(e)})},_validate:function(){if("Exit"==this.TYPE)throw new Error("should not instantiate AST_Exit")}},AST_Jump),AST_Return=DEFNODE("Return",null,{$documentation:"A `return` statement",_validate:function(){null!=this.value&&must_be_expression(this,"value")}},AST_Exit),AST_Throw=DEFNODE("Throw",null,{$documentation:"A `throw` statement",_validate:function(){must_be_expression(this,"value")}},AST_Exit),AST_LoopControl=DEFNODE("LoopControl","label",{$documentation:"Base class for loop control statements (`break` and `continue`)",$propdoc:{label:"[AST_LabelRef?] the label, or null if none"},_equals:function(e){return prop_equals(this.label,e.label)},walk:function(e){var t=this;e.visit(t,function(){t.label&&t.label.walk(e)})},_validate:function(){if("LoopControl"==this.TYPE)throw new Error("should not instantiate AST_LoopControl");if(null!=this.label&&!(this.label instanceof AST_LabelRef))throw new Error("label must be AST_LabelRef")}},AST_Jump),AST_Break=DEFNODE("Break",null,{$documentation:"A `break` statement"},AST_LoopControl),AST_Continue=DEFNODE("Continue",null,{$documentation:"A `continue` statement"},AST_LoopControl),AST_If=DEFNODE("If","condition alternative",{$documentation:"A `if` statement",$propdoc:{condition:"[AST_Node] the `if` condition",alternative:"[AST_Statement?] the `else` part, or null if not present"},_equals:function(e){return this.body.equals(e.body)&&this.condition.equals(e.condition)&&prop_equals(this.alternative,e.alternative)},walk:function(e){var t=this;e.visit(t,function(){t.condition.walk(e),t.body.walk(e),t.alternative&&t.alternative.walk(e)})},_validate:function(){if(must_be_expression(this,"condition"),null!=this.alternative&&!is_statement(this.alternative))throw new Error("alternative must be AST_Statement")}},AST_StatementWithBody),AST_Switch=DEFNODE("Switch","expression",{$documentation:"A `switch` statement",$propdoc:{expression:"[AST_Node] the `switch` “discriminant”"},_equals:function(e){return this.expression.equals(e.expression)&&all_equals(this.body,e.body)},walk:function(e){var t=this;e.visit(t,function(){t.expression.walk(e),walk_body(t,e)})},_validate:function(){must_be_expression(this,"expression"),this.body.forEach(function(e){if(!(e instanceof AST_SwitchBranch))throw new Error("body must be AST_SwitchBranch[]")})}},AST_Block),AST_SwitchBranch=DEFNODE("SwitchBranch",null,{$documentation:"Base class for `switch` branches",_validate:function(){if("SwitchBranch"==this.TYPE)throw new Error("should not instantiate AST_SwitchBranch")}},AST_Block),AST_Default=DEFNODE("Default",null,{$documentation:"A `default` switch branch"},AST_SwitchBranch),AST_Case=DEFNODE("Case","expression",{$documentation:"A `case` switch branch",$propdoc:{expression:"[AST_Node] the `case` expression"},_equals:function(e){return this.expression.equals(e.expression)&&all_equals(this.body,e.body)},walk:function(e){var t=this;e.visit(t,function(){t.expression.walk(e),walk_body(t,e)})},_validate:function(){must_be_expression(this,"expression")}},AST_SwitchBranch),AST_Try=DEFNODE("Try","bcatch bfinally",{$documentation:"A `try` statement",$propdoc:{bcatch:"[AST_Catch?] the catch block, or null if not present",bfinally:"[AST_Finally?] the finally block, or null if not present"},_equals:function(e){return all_equals(this.body,e.body)&&prop_equals(this.bcatch,e.bcatch)&&prop_equals(this.bfinally,e.bfinally)},walk:function(e){var t=this;e.visit(t,function(){walk_body(t,e),t.bcatch&&t.bcatch.walk(e),t.bfinally&&t.bfinally.walk(e)})},_validate:function(){if(null!=this.bcatch&&!(this.bcatch instanceof AST_Catch))throw new Error("bcatch must be AST_Catch");if(null!=this.bfinally&&!(this.bfinally instanceof AST_Finally))throw new Error("bfinally must be AST_Finally")}},AST_Block),AST_Catch=DEFNODE("Catch","argname",{$documentation:"A `catch` node; only makes sense as part of a `try` statement",$propdoc:{argname:"[(AST_Destructured|AST_SymbolCatch)?] symbol for the exception, or null if not present"},_equals:function(e){return prop_equals(this.argname,e.argname)&&all_equals(this.body,e.body)},walk:function(e){var t=this;e.visit(t,function(){t.argname&&t.argname.walk(e),walk_body(t,e)})},_validate:function(){null!=this.argname&&validate_destructured(this.argname,function(e){if(!(e instanceof AST_SymbolCatch))throw new Error("argname must be AST_SymbolCatch")})}},AST_Block),AST_Finally=DEFNODE("Finally",null,{$documentation:"A `finally` node; only makes sense as part of a `try` statement"},AST_Block),AST_Definitions=DEFNODE("Definitions","definitions",{$documentation:"Base class for `var` nodes (variable declarations/initializations)",$propdoc:{definitions:"[AST_VarDef*] array of variable definitions"},_equals:function(e){return all_equals(this.definitions,e.definitions)},walk:function(t){var e=this;t.visit(e,function(){e.definitions.forEach(function(e){e.walk(t)})})},_validate:function(){if("Definitions"==this.TYPE)throw new Error("should not instantiate AST_Definitions");if(this.definitions.length<1)throw new Error("must have at least one definition")}},AST_Statement),AST_Const=DEFNODE("Const",null,{$documentation:"A `const` statement",_validate:function(){this.definitions.forEach(function(e){if(!(e instanceof AST_VarDef))throw new Error("definitions must be AST_VarDef[]");validate_destructured(e.name,function(e){if(!(e instanceof AST_SymbolConst))throw new Error("name must be AST_SymbolConst")})})}},AST_Definitions),AST_Let=DEFNODE("Let",null,{$documentation:"A `let` statement",_validate:function(){this.definitions.forEach(function(e){if(!(e instanceof AST_VarDef))throw new Error("definitions must be AST_VarDef[]");validate_destructured(e.name,function(e){if(!(e instanceof AST_SymbolLet))throw new Error("name must be AST_SymbolLet")})})}},AST_Definitions),AST_Var=DEFNODE("Var",null,{$documentation:"A `var` statement",_validate:function(){this.definitions.forEach(function(e){if(!(e instanceof AST_VarDef))throw new Error("definitions must be AST_VarDef[]");validate_destructured(e.name,function(e){if(!(e instanceof AST_SymbolVar))throw new Error("name must be AST_SymbolVar")})})}},AST_Definitions),AST_VarDef=DEFNODE("VarDef","name value",{$documentation:"A variable declaration; only appears in a AST_Definitions node",$propdoc:{name:"[AST_Destructured|AST_SymbolVar] name of the variable",value:"[AST_Node?] initializer, or null of there's no initializer"},_equals:function(e){return this.name.equals(e.name)&&prop_equals(this.value,e.value)},walk:function(e){var t=this;e.visit(t,function(){t.name.walk(e),t.value&&t.value.walk(e)})},_validate:function(){null!=this.value&&must_be_expression(this,"value")}}),AST_ExportDeclaration=DEFNODE("ExportDeclaration","body",{$documentation:"An `export` statement",$propdoc:{body:"[AST_DefClass|AST_Definitions|AST_LambdaDefinition] the statement to export"},_equals:function(e){return this.body.equals(e.body)},walk:function(e){var t=this;e.visit(t,function(){t.body.walk(e)})},_validate:function(){if(!(this.body instanceof AST_DefClass||this.body instanceof AST_Definitions||this.body instanceof AST_LambdaDefinition))throw new Error("body must be AST_DefClass, AST_Definitions or AST_LambdaDefinition")}},AST_Statement),AST_ExportDefault=DEFNODE("ExportDefault","body",{$documentation:"An `export default` statement",$propdoc:{body:"[AST_Node] the default export"},_equals:function(e){return this.body.equals(e.body)},walk:function(e){var t=this;e.visit(t,function(){t.body.walk(e)})},_validate:function(){this.body instanceof AST_DefClass||this.body instanceof AST_LambdaDefinition||must_be_expression(this,"body")}},AST_Statement),AST_ExportForeign=DEFNODE("ExportForeign","aliases keys path",{$documentation:"An `export ... from '...'` statement",$propdoc:{aliases:"[AST_String*] array of aliases to export",keys:"[AST_String*] array of keys to import",path:"[AST_String] the path to import module"},_equals:function(e){return this.path.equals(e.path)&&all_equals(this.aliases,e.aliases)&&all_equals(this.keys,e.keys)},_validate:function(){if(this.aliases.length!=this.keys.length)throw new Error("aliases:key length mismatch: "+this.aliases.length+" != "+this.keys.length);if(this.aliases.forEach(function(e){if(!(e instanceof AST_String))throw new Error("aliases must contain AST_String")}),this.keys.forEach(function(e){if(!(e instanceof AST_String))throw new Error("keys must contain AST_String")}),!(this.path instanceof AST_String))throw new Error("path must be AST_String")}},AST_Statement),AST_ExportReferences=DEFNODE("ExportReferences","properties",{$documentation:"An `export { ... }` statement",$propdoc:{properties:"[AST_SymbolExport*] array of aliases to export"},_equals:function(e){return all_equals(this.properties,e.properties)},walk:function(t){var e=this;t.visit(e,function(){e.properties.forEach(function(e){e.walk(t)})})},_validate:function(){this.properties.forEach(function(e){if(!(e instanceof AST_SymbolExport))throw new Error("properties must contain AST_SymbolExport")})}},AST_Statement),AST_Import=DEFNODE("Import","all default path properties",{$documentation:"An `import` statement",$propdoc:{all:"[AST_SymbolImport?] the imported namespace, or null if not specified",default:"[AST_SymbolImport?] the alias for default `export`, or null if not specified",path:"[AST_String] the path to import module",properties:"[(AST_SymbolImport*)?] array of aliases, or null if not specified"},_equals:function(e){return this.path.equals(e.path)&&prop_equals(this.all,e.all)&&prop_equals(this.default,e.default)&&!this.properties==!e.properties&&(!this.properties||all_equals(this.properties,e.properties))},walk:function(t){var e=this;t.visit(e,function(){e.all&&e.all.walk(t),e.default&&e.default.walk(t),e.properties&&e.properties.forEach(function(e){e.walk(t)})})},_validate:function(){if(null!=this.all){if(!(this.all instanceof AST_SymbolImport))throw new Error("all must be AST_SymbolImport");if(null!=this.properties)throw new Error("cannot import both * and {} in the same statement")}if(null!=this.default){if(!(this.default instanceof AST_SymbolImport))throw new Error("default must be AST_SymbolImport");if(""!==this.default.key.value)throw new Error("invalid default key: "+this.default.key.value)}if(!(this.path instanceof AST_String))throw new Error("path must be AST_String");null!=this.properties&&this.properties.forEach(function(e){if(!(e instanceof AST_SymbolImport))throw new Error("properties must contain AST_SymbolImport")})}},AST_Statement),AST_DefaultValue=DEFNODE("DefaultValue","name value",{$documentation:"A default value declaration",$propdoc:{name:"[AST_Destructured|AST_SymbolDeclaration] name of the variable",value:"[AST_Node] value to assign if variable is `undefined`"},_equals:function(e){return this.name.equals(e.name)&&this.value.equals(e.value)},walk:function(e){var t=this;e.visit(t,function(){t.name.walk(e),t.value.walk(e)})},_validate:function(){must_be_expression(this,"value")}});function must_be_expressions(e,t,n,o){e[t].forEach(function(e){validate_expression(e,t,!0,n,o)})}var AST_Call=DEFNODE("Call","args expression optional pure terminal",{$documentation:"A function call expression",$propdoc:{args:"[AST_Node*] array of arguments",expression:"[AST_Node] expression to invoke as function",optional:"[boolean] whether the expression is optional chaining",pure:"[boolean/S] marker for side-effect-free call expression",terminal:"[boolean] whether the chain has ended"},_equals:function(e){return!this.optional==!e.optional&&this.expression.equals(e.expression)&&all_equals(this.args,e.args)},walk:function(t){var e=this;t.visit(e,function(){e.expression.walk(t),e.args.forEach(function(e){e.walk(t)})})},_validate:function(){must_be_expression(this,"expression"),must_be_expressions(this,"args",!0)}}),AST_New=DEFNODE("New",null,{$documentation:"An object instantiation.  Derives from a function call since it has exactly the same properties",_validate:function(){if(this.optional)throw new Error("optional must be false");if(this.terminal)throw new Error("terminal must be false")}},AST_Call),AST_Sequence=DEFNODE("Sequence","expressions",{$documentation:"A sequence expression (comma-separated expressions)",$propdoc:{expressions:"[AST_Node*] array of expressions (at least two)"},_equals:function(e){return all_equals(this.expressions,e.expressions)},walk:function(t){var e=this;t.visit(e,function(){e.expressions.forEach(function(e){e.walk(t)})})},_validate:function(){if(this.expressions.length<2)throw new Error("expressions must contain multiple elements");must_be_expressions(this,"expressions")}});function root_expr(e){for(;e instanceof AST_PropAccess;)e=e.expression;return e}var AST_PropAccess=DEFNODE("PropAccess","expression optional property terminal",{$documentation:'Base class for property access expressions, i.e. `a.foo` or `a["foo"]`',$propdoc:{expression:"[AST_Node] the “container” expression",optional:"[boolean] whether the expression is optional chaining",property:"[AST_Node|string] the property to access.  For AST_Dot this is always a plain string, while for AST_Sub it's an arbitrary AST_Node",terminal:"[boolean] whether the chain has ended"},_equals:function(e){return!this.optional==!e.optional&&prop_equals(this.property,e.property)&&this.expression.equals(e.expression)},get_property:function(){var e=this.property;return e instanceof AST_Constant?e.value:e instanceof AST_UnaryPrefix&&"void"==e.operator&&e.expression instanceof AST_Constant?void 0:e},_validate:function(){if("PropAccess"==this.TYPE)throw new Error("should not instantiate AST_PropAccess");must_be_expression(this,"expression")}}),AST_Dot=DEFNODE("Dot","quoted",{$documentation:"A dotted property access expression",$propdoc:{quoted:"[boolean] whether property is transformed from a quoted string"},walk:function(e){var t=this;e.visit(t,function(){t.expression.walk(e)})},_validate:function(){if("string"!=typeof this.property)throw new Error("property must be string")}},AST_PropAccess),AST_Sub=DEFNODE("Sub",null,{$documentation:'Index-style property access, i.e. `a["foo"]`',walk:function(e){var t=this;e.visit(t,function(){t.expression.walk(e),t.property.walk(e)})},_validate:function(){must_be_expression(this,"property")}},AST_PropAccess),AST_Spread=DEFNODE("Spread","expression",{$documentation:"Spread expression in array/object literals or function calls",$propdoc:{expression:"[AST_Node] expression to be expanded"},_equals:function(e){return this.expression.equals(e.expression)},walk:function(e){var t=this;e.visit(t,function(){t.expression.walk(e)})},_validate:function(){must_be_expression(this,"expression")}}),AST_Unary=DEFNODE("Unary","operator expression",{$documentation:"Base class for unary expressions",$propdoc:{operator:"[string] the operator",expression:"[AST_Node] expression that this unary operator applies to"},_equals:function(e){return this.operator==e.operator&&this.expression.equals(e.expression)},walk:function(e){var t=this;e.visit(t,function(){t.expression.walk(e)})},_validate:function(){if("Unary"==this.TYPE)throw new Error("should not instantiate AST_Unary");if("string"!=typeof this.operator)throw new Error("operator must be string");must_be_expression(this,"expression")}}),AST_UnaryPrefix=DEFNODE("UnaryPrefix",null,{$documentation:"Unary prefix expression, i.e. `typeof i` or `++i`"},AST_Unary),AST_UnaryPostfix=DEFNODE("UnaryPostfix",null,{$documentation:"Unary postfix expression, i.e. `i++`"},AST_Unary),AST_Binary=DEFNODE("Binary","operator left right",{$documentation:"Binary expression, i.e. `a + b`",$propdoc:{left:"[AST_Node] left-hand side expression",operator:"[string] the operator",right:"[AST_Node] right-hand side expression"},_equals:function(e){return this.operator==e.operator&&this.left.equals(e.left)&&this.right.equals(e.right)},walk:function(e){var t=this;e.visit(t,function(){t.left.walk(e),t.right.walk(e)})},_validate:function(){if(this instanceof AST_Assign||must_be_expression(this,"left"),"string"!=typeof this.operator)throw new Error("operator must be string");must_be_expression(this,"right")}}),AST_Conditional=DEFNODE("Conditional","condition consequent alternative",{$documentation:"Conditional expression using the ternary operator, i.e. `a ? b : c`",$propdoc:{condition:"[AST_Node]",consequent:"[AST_Node]",alternative:"[AST_Node]"},_equals:function(e){return this.condition.equals(e.condition)&&this.consequent.equals(e.consequent)&&this.alternative.equals(e.alternative)},walk:function(e){var t=this;e.visit(t,function(){t.condition.walk(e),t.consequent.walk(e),t.alternative.walk(e)})},_validate:function(){must_be_expression(this,"condition"),must_be_expression(this,"consequent"),must_be_expression(this,"alternative")}}),AST_Assign=DEFNODE("Assign",null,{$documentation:"An assignment expression — `a = b + 5`",_validate:function(){if(this.operator.indexOf("=")<0)throw new Error('operator must contain "="');if(this.left instanceof AST_Destructured){if("="!=this.operator)throw new Error("invalid destructuring operator: "+this.operator);validate_destructured(this.left,function(e){if(!(e instanceof AST_PropAccess||e instanceof AST_SymbolRef))throw new Error("left must be assignable: "+e.TYPE)})}else if(!(this.left instanceof AST_Infinity||this.left instanceof AST_NaN||this.left instanceof AST_PropAccess&&!this.left.optional||this.left instanceof AST_SymbolRef||this.left instanceof AST_Undefined))throw new Error("left must be assignable")}},AST_Binary),AST_Await=DEFNODE("Await","expression",{$documentation:"An await expression",$propdoc:{expression:"[AST_Node] expression with Promise to resolve on"},_equals:function(e){return this.expression.equals(e.expression)},walk:function(e){var t=this;e.visit(t,function(){t.expression.walk(e)})},_validate:function(){must_be_expression(this,"expression")}}),AST_Yield=DEFNODE("Yield","expression nested",{$documentation:"A yield expression",$propdoc:{expression:"[AST_Node?] return value for iterator, or null if undefined",nested:"[boolean] whether to iterate over expression as generator"},_equals:function(e){return!this.nested==!e.nested&&prop_equals(this.expression,e.expression)},walk:function(e){var t=this;e.visit(t,function(){t.expression&&t.expression.walk(e)})},_validate:function(){if(null!=this.expression)must_be_expression(this,"expression");else if(this.nested)throw new Error("yield* must contain expression")}}),AST_Array=DEFNODE("Array","elements",{$documentation:"An array literal",$propdoc:{elements:"[AST_Node*] array of elements"},_equals:function(e){return all_equals(this.elements,e.elements)},walk:function(t){var e=this;t.visit(e,function(){e.elements.forEach(function(e){e.walk(t)})})},_validate:function(){must_be_expressions(this,"elements",!0,!0)}}),AST_Destructured=DEFNODE("Destructured","rest",{$documentation:"Base class for destructured literal",$propdoc:{rest:"[(AST_Destructured|AST_SymbolDeclaration|AST_SymbolRef)?] rest parameter, or null if absent"},_validate:function(){if("Destructured"==this.TYPE)throw new Error("should not instantiate AST_Destructured")}});function validate_destructured(e,t,n){if(e instanceof AST_DefaultValue&&n)return validate_destructured(e.name,t);if(e instanceof AST_Destructured){if(null!=e.rest&&validate_destructured(e.rest,t),e instanceof AST_DestructuredArray)return e.elements.forEach(function(e){e instanceof AST_Hole||validate_destructured(e,t,!0)});if(e instanceof AST_DestructuredObject)return e.properties.forEach(function(e){validate_destructured(e.value,t,!0)})}t(e)}var AST_DestructuredArray=DEFNODE("DestructuredArray","elements",{$documentation:"A destructured array literal",$propdoc:{elements:"[(AST_DefaultValue|AST_Destructured|AST_SymbolDeclaration|AST_SymbolRef)*] array of elements"},_equals:function(e){return prop_equals(this.rest,e.rest)&&all_equals(this.elements,e.elements)},walk:function(t){var e=this;t.visit(e,function(){e.elements.forEach(function(e){e.walk(t)}),e.rest&&e.rest.walk(t)})}},AST_Destructured),AST_DestructuredKeyVal=DEFNODE("DestructuredKeyVal","key value",{$documentation:"A key: value destructured property",$propdoc:{key:"[string|AST_Node] property name.  For computed property this is an AST_Node.",value:"[AST_DefaultValue|AST_Destructured|AST_SymbolDeclaration|AST_SymbolRef] property value"},_equals:function(e){return prop_equals(this.key,e.key)&&this.value.equals(e.value)},walk:function(e){var t=this;e.visit(t,function(){t.key instanceof AST_Node&&t.key.walk(e),t.value.walk(e)})},_validate:function(){if("string"!=typeof this.key){if(!(this.key instanceof AST_Node))throw new Error("key must be string or AST_Node");must_be_expression(this,"key")}if(!(this.value instanceof AST_Node))throw new Error("value must be AST_Node")}}),AST_DestructuredObject=DEFNODE("DestructuredObject","properties",{$documentation:"A destructured object literal",$propdoc:{properties:"[AST_DestructuredKeyVal*] array of properties"},_equals:function(e){return prop_equals(this.rest,e.rest)&&all_equals(this.properties,e.properties)},walk:function(t){var e=this;t.visit(e,function(){e.properties.forEach(function(e){e.walk(t)}),e.rest&&e.rest.walk(t)})},_validate:function(){this.properties.forEach(function(e){if(!(e instanceof AST_DestructuredKeyVal))throw new Error("properties must be AST_DestructuredKeyVal[]")})}},AST_Destructured),AST_Object=DEFNODE("Object","properties",{$documentation:"An object literal",$propdoc:{properties:"[(AST_ObjectProperty|AST_Spread)*] array of properties"},_equals:function(e){return all_equals(this.properties,e.properties)},walk:function(t){var e=this;t.visit(e,function(){e.properties.forEach(function(e){e.walk(t)})})},_validate:function(){this.properties.forEach(function(e){if(!(e instanceof AST_ObjectProperty||e instanceof AST_Spread))throw new Error("properties must contain AST_ObjectProperty and/or AST_Spread only")})}}),AST_ObjectProperty=DEFNODE("ObjectProperty","key value",{$documentation:"Base class for literal object properties",$propdoc:{key:"[string|AST_Node] property name.  For computed property this is an AST_Node.",value:"[AST_Node] property value.  For getters and setters this is an AST_Accessor."},_equals:function(e){return prop_equals(this.key,e.key)&&this.value.equals(e.value)},walk:function(e){var t=this;e.visit(t,function(){t.key instanceof AST_Node&&t.key.walk(e),t.value.walk(e)})},_validate:function(){if("ObjectProperty"==this.TYPE)throw new Error("should not instantiate AST_ObjectProperty");if("string"!=typeof this.key){if(!(this.key instanceof AST_Node))throw new Error("key must be string or AST_Node");must_be_expression(this,"key")}if(!(this.value instanceof AST_Node))throw new Error("value must be AST_Node")}}),AST_ObjectKeyVal=DEFNODE("ObjectKeyVal",null,{$documentation:"A key: value object property",_validate:function(){must_be_expression(this,"value")}},AST_ObjectProperty),AST_ObjectMethod=DEFNODE("ObjectMethod",null,{$documentation:"A key(){} object property",_validate:function(){if(!(this.value instanceof AST_LambdaExpression))throw new Error("value must be AST_LambdaExpression");if(is_arrow(this.value))throw new Error("value cannot be AST_Arrow or AST_AsyncArrow");if(null!=this.value.name)throw new Error("name of object method's lambda must be null")}},AST_ObjectKeyVal),AST_ObjectSetter=DEFNODE("ObjectSetter",null,{$documentation:"An object setter property",_validate:function(){if(!(this.value instanceof AST_Accessor))throw new Error("value must be AST_Accessor")}},AST_ObjectProperty),AST_ObjectGetter=DEFNODE("ObjectGetter",null,{$documentation:"An object getter property",_validate:function(){if(!(this.value instanceof AST_Accessor))throw new Error("value must be AST_Accessor")}},AST_ObjectProperty),AST_Symbol=DEFNODE("Symbol","scope name thedef",{$documentation:"Base class for all symbols",$propdoc:{name:"[string] name of this symbol",scope:"[AST_Scope/S] the current scope (not necessarily the definition scope)",thedef:"[SymbolDef/S] the definition of this symbol"},_equals:function(e){return this.thedef?this.thedef===e.thedef:this.name==e.name},_validate:function(){if("Symbol"==this.TYPE)throw new Error("should not instantiate AST_Symbol");if("string"!=typeof this.name)throw new Error("name must be string")}}),AST_SymbolDeclaration=DEFNODE("SymbolDeclaration","init",{$documentation:"A declaration symbol (symbol in var, function name or argument, symbol in catch)"},AST_Symbol),AST_SymbolConst=DEFNODE("SymbolConst",null,{$documentation:"Symbol defining a constant"},AST_SymbolDeclaration),AST_SymbolImport=DEFNODE("SymbolImport","key",{$documentation:"Symbol defined by an `import` statement",$propdoc:{key:"[AST_String] the original `export` name"},_equals:function(e){return this.name==e.name&&this.key.equals(e.key)},_validate:function(){if(!(this.key instanceof AST_String))throw new Error("key must be AST_String")}},AST_SymbolConst),AST_SymbolLet=DEFNODE("SymbolLet",null,{$documentation:"Symbol defining a lexical-scoped variable"},AST_SymbolDeclaration),AST_SymbolVar=DEFNODE("SymbolVar",null,{$documentation:"Symbol defining a variable"},AST_SymbolDeclaration),AST_SymbolFunarg=DEFNODE("SymbolFunarg","unused",{$documentation:"Symbol naming a function argument"},AST_SymbolVar),AST_SymbolDefun=DEFNODE("SymbolDefun",null,{$documentation:"Symbol defining a function"},AST_SymbolDeclaration),AST_SymbolLambda=DEFNODE("SymbolLambda",null,{$documentation:"Symbol naming a function expression"},AST_SymbolDeclaration),AST_SymbolDefClass=DEFNODE("SymbolDefClass",null,{$documentation:"Symbol defining a class"},AST_SymbolConst),AST_SymbolClass=DEFNODE("SymbolClass",null,{$documentation:"Symbol naming a class expression"},AST_SymbolConst),AST_SymbolCatch=DEFNODE("SymbolCatch",null,{$documentation:"Symbol naming the exception in catch"},AST_SymbolDeclaration),AST_Label=DEFNODE("Label","references",{$documentation:"Symbol naming a label (declaration)",$propdoc:{references:"[AST_LoopControl*] a list of nodes referring to this label"},initialize:function(){this.references=[],this.thedef=this}},AST_Symbol),AST_SymbolRef=DEFNODE("SymbolRef","fixed in_arg redef",{$documentation:"Reference to some symbol (not definition/declaration)"},AST_Symbol),AST_SymbolExport=DEFNODE("SymbolExport","alias",{$documentation:"Reference in an `export` statement",$propdoc:{alias:"[AST_String] the `export` alias"},_equals:function(e){return this.name==e.name&&this.alias.equals(e.alias)},_validate:function(){if(!(this.alias instanceof AST_String))throw new Error("alias must be AST_String")}},AST_SymbolRef),AST_LabelRef=DEFNODE("LabelRef",null,{$documentation:"Reference to a label symbol"},AST_Symbol),AST_ObjectIdentity=DEFNODE("ObjectIdentity",null,{$documentation:"Base class for `super` & `this`",_equals:return_true,_validate:function(){if("ObjectIdentity"==this.TYPE)throw new Error("should not instantiate AST_ObjectIdentity")}},AST_Symbol),AST_Super=DEFNODE("Super",null,{$documentation:"The `super` symbol",_validate:function(){if("super"!==this.name)throw new Error('name must be "super"')}},AST_ObjectIdentity),AST_This=DEFNODE("This",null,{$documentation:"The `this` symbol",_validate:function(){if("This"==this.TYPE&&"this"!==this.name)throw new Error('name must be "this"')}},AST_ObjectIdentity),AST_NewTarget=DEFNODE("NewTarget",null,{$documentation:"The `new.target` symbol",initialize:function(){this.name="new.target"},_validate:function(){if("new.target"!==this.name)throw new Error('name must be "new.target": '+this.name)}},AST_This),AST_Template=DEFNODE("Template","expressions strings tag",{$documentation:"A template literal, i.e. tag`str1${expr1}...strN${exprN}strN+1`",$propdoc:{expressions:"[AST_Node*] the placeholder expressions",strings:"[string*] the raw text segments",tag:"[AST_Node?] tag function, or null if absent"},_equals:function(e){return prop_equals(this.tag,e.tag)&&list_equals(this.strings,e.strings)&&all_equals(this.expressions,e.expressions)},walk:function(t){var e=this;t.visit(e,function(){e.tag&&e.tag.walk(t),e.expressions.forEach(function(e){e.walk(t)})})},_validate:function(){if(this.expressions.length+1!=this.strings.length)throw new Error("malformed template with "+this.expressions.length+" placeholder(s) but "+this.strings.length+" text segment(s)");must_be_expressions(this,"expressions"),this.strings.forEach(function(e){if("string"!=typeof e)throw new Error("strings must contain string")}),null!=this.tag&&must_be_expression(this,"tag")}}),AST_Constant=DEFNODE("Constant",null,{$documentation:"Base class for all constants",_equals:function(e){return this.value===e.value},_validate:function(){if("Constant"==this.TYPE)throw new Error("should not instantiate AST_Constant")}}),AST_String=DEFNODE("String","quote value",{$documentation:"A string literal",$propdoc:{quote:"[string?] the original quote character",value:"[string] the contents of this string"},_validate:function(){if(null!=this.quote){if("string"!=typeof this.quote)throw new Error("quote must be string");if(!/^["']$/.test(this.quote))throw new Error("invalid quote: "+this.quote)}if("string"!=typeof this.value)throw new Error("value must be string")}},AST_Constant),AST_Number=DEFNODE("Number","value",{$documentation:"A number literal",$propdoc:{value:"[number] the numeric value"},_validate:function(){if("number"!=typeof this.value)throw new Error("value must be number");if(!isFinite(this.value))throw new Error("value must be finite");if(this.value<0)throw new Error("value cannot be negative")}},AST_Constant),AST_BigInt=DEFNODE("BigInt","value",{$documentation:"A BigInt literal",$propdoc:{value:"[string] the numeric representation"},_validate:function(){if("string"!=typeof this.value)throw new Error("value must be string");if("-"==this.value[0])throw new Error("value cannot be negative")}},AST_Constant),AST_RegExp=DEFNODE("RegExp","value",{$documentation:"A regexp literal",$propdoc:{value:"[RegExp] the actual regexp"},_equals:function(e){return""+this.value==""+e.value},_validate:function(){if(!(this.value instanceof RegExp))throw new Error("value must be RegExp")}},AST_Constant),AST_Atom=DEFNODE("Atom",null,{$documentation:"Base class for atoms",_equals:return_true,_validate:function(){if("Atom"==this.TYPE)throw new Error("should not instantiate AST_Atom")}},AST_Constant),AST_Null=DEFNODE("Null",null,{$documentation:"The `null` atom",value:null},AST_Atom),AST_NaN=DEFNODE("NaN",null,{$documentation:"The impossible value",value:NaN},AST_Atom),AST_Undefined=DEFNODE("Undefined",null,{$documentation:"The `undefined` value",value:void 0},AST_Atom),AST_Hole=DEFNODE("Hole",null,{$documentation:"A hole in an array",value:void 0},AST_Atom),AST_Infinity=DEFNODE("Infinity",null,{$documentation:"The `Infinity` value",value:1/0},AST_Atom),AST_Boolean=DEFNODE("Boolean",null,{$documentation:"Base class for booleans",_validate:function(){if("Boolean"==this.TYPE)throw new Error("should not instantiate AST_Boolean")}},AST_Atom),AST_False=DEFNODE("False",null,{$documentation:"The `false` atom",value:!1},AST_Boolean),AST_True=DEFNODE("True",null,{$documentation:"The `true` atom",value:!0},AST_Boolean);function TreeWalker(e){this.callback=e,this.directives=Object.create(null),this.stack=[]}TreeWalker.prototype={visit:function(e,t){this.push(e),!this.callback(e,t||noop)&&t&&t(),this.pop()},parent:function(e){return this.stack[this.stack.length-2-(e||0)]},push:function(e){var t;e instanceof AST_Class?(this.directives=Object.create(this.directives),t="use strict"):e instanceof AST_Directive?t=e.value:e instanceof AST_Lambda&&(this.directives=Object.create(this.directives)),t&&!this.directives[t]&&(this.directives[t]=e),this.stack.push(e)},pop:function(){var e=this.stack.pop();(e instanceof AST_Class||e instanceof AST_Lambda)&&(this.directives=Object.getPrototypeOf(this.directives))},self:function(){return this.stack[this.stack.length-1]},find_parent:function(e){for(var t=this.stack,n=t.length-1;0<=--n;){var o=t[n];if(o instanceof e)return o}},has_directive:function(e){var t=this.directives[e];if(t)return t;var n=this.stack[this.stack.length-1];if(n instanceof AST_Scope)for(var o=0;o<n.body.length;++o){var i=n.body[o];if(!(i instanceof AST_Directive))break;if(i.value==e)return i}},loopcontrol_target:function(e){var t,n=this.stack;if(e.label){for(var o=n.length;0<=--o;)if((t=n[o])instanceof AST_LabeledStatement&&t.label.name==e.label.name)return t.body}else for(o=n.length;0<=--o;)if((t=n[o])instanceof AST_IterationStatement||e instanceof AST_Break&&t instanceof AST_Switch)return t},in_boolean_context:function(){for(var e,t=!0,n=0,o=this.self();e=this.parent(n++);o=e){if(e instanceof AST_Binary)switch(e.operator){case"&&":case"||":e.left===o&&(t=!1);continue;default:return!1}if(!(e instanceof AST_Conditional)){if(e instanceof AST_DWLoop)return e.condition===o;if(e instanceof AST_For)return e.condition===o;if(e instanceof AST_If)return e.condition===o;if(e instanceof AST_Return){if(e.in_bool)return!0;for(;e=this.parent(n++);)if(e instanceof AST_Lambda){if(e.name)return!1;if("Call"!=(e=this.parent(n++)).TYPE)return!1;break}}if(e instanceof AST_Sequence){if(e.tail_node()===o)continue;return!t||"d"}return e instanceof AST_SimpleStatement?!t||"d":e instanceof AST_UnaryPrefix&&"!"==e.operator}if(e.condition===o)return!0}}};


// parse
"use strict";var RESERVED_WORDS=["abstract async await boolean byte char double enum export final float goto implements import int interface let long native package private protected public short static super synchronized this throws transient volatile yield",KEYWORDS_ATOM="false null true",KEYWORDS="break case catch class const continue debugger default delete do else extends finally for function if in instanceof new return switch throw try typeof var void while with"].join(" "),KEYWORDS_BEFORE_EXPRESSION="return new delete throw else case",KEYWORDS=makePredicate(KEYWORDS),RESERVED_WORDS=makePredicate(RESERVED_WORDS),KEYWORDS_BEFORE_EXPRESSION=makePredicate(KEYWORDS_BEFORE_EXPRESSION),KEYWORDS_ATOM=makePredicate(KEYWORDS_ATOM),RE_BIN_NUMBER=/^0b([01]+)$/i,RE_HEX_NUMBER=/^0x([0-9a-f]+)$/i,RE_OCT_NUMBER=/^0o?([0-7]+)$/i,OPERATORS=makePredicate(["in","instanceof","typeof","new","void","delete","++","--","+","-","!","~","&","|","^","*","/","%","**",">>","<<",">>>","<",">","<=",">=","==","===","!=","!==","?","=","+=","-=","/=","*=","%=","**=",">>=","<<=",">>>=","&=","|=","^=","&&","||","??","&&=","||=","??="]),NEWLINE_CHARS="\n\r\u2028\u2029",OPERATOR_CHARS="+-*&%=<>!?|~^",PUNC_OPENERS="[{(",PUNC_SEPARATORS=",;:",PUNC_CLOSERS=")}]",PUNC_AFTER_EXPRESSION=PUNC_SEPARATORS+PUNC_CLOSERS,PUNC_BEFORE_EXPRESSION=PUNC_OPENERS+PUNC_SEPARATORS,PUNC_CHARS=PUNC_BEFORE_EXPRESSION+"`"+PUNC_CLOSERS,WHITESPACE_CHARS=NEWLINE_CHARS+"  \t\f\v​             　\ufeff",NON_IDENTIFIER_CHARS=makePredicate(characters("./'\"#"+OPERATOR_CHARS+PUNC_CHARS+WHITESPACE_CHARS));function is_surrogate_pair_head(e){return 55296<=e&&e<=56319}function is_surrogate_pair_tail(e){return 56320<=e&&e<=57343}function is_digit(e){return 48<=e&&e<=57}function is_identifier_char(e){return!NON_IDENTIFIER_CHARS[e]}function is_identifier_string(e){return/^[a-z_$][a-z0-9_$]*$/i.test(e)}function decode_escape_sequence(e){switch(e[0]){case"b":return"\b";case"f":return"\f";case"n":return"\n";case"r":return"\r";case"t":return"\t";case"u":if("{"==e[1]&&"}"==e.slice(-1))n=e.slice(2,-1);else{if(5!=e.length)return;n=e.slice(1)}return(n=parseInt(n,16))<0||isNaN(n)?void 0:n<65536?String.fromCharCode(n):1114111<n?void 0:String.fromCharCode(55232+(n>>10))+String.fromCharCode(56320+(1023&n));case"v":return"\v";case"x":var n;return 3!=e.length?void 0:(n=parseInt(e.slice(1),16))<0||isNaN(n)?void 0:String.fromCharCode(n);case"\r":case"\n":return"";default:return"0"==e?"\0":"0"<=e[0]&&e[0]<="9"?void 0:e}}function parse_js_number(e){var n;return(n=RE_BIN_NUMBER.exec(e))?parseInt(n[1],2):(n=RE_HEX_NUMBER.exec(e))?parseInt(n[1],16):(n=RE_OCT_NUMBER.exec(e))?parseInt(n[1],8):(n=parseFloat(e))==e?n:void 0}function JS_Parse_Error(e,n,t,r,a){this.message=e,this.filename=n,this.line=t,this.col=r,this.pos=a;try{throw new SyntaxError(e,n,t,r)}catch(e){configure_error_stack(this,e)}}function js_error(e,n,t,r,a){throw new JS_Parse_Error(e,n,t,r,a)}function is_token(e,n,t){return e.type==n&&(null==t||e.value==t)}NEWLINE_CHARS=makePredicate(characters(NEWLINE_CHARS)),OPERATOR_CHARS=makePredicate(characters(OPERATOR_CHARS)),PUNC_AFTER_EXPRESSION=makePredicate(characters(PUNC_AFTER_EXPRESSION)),PUNC_BEFORE_EXPRESSION=makePredicate(characters(PUNC_BEFORE_EXPRESSION)),PUNC_CHARS=makePredicate(characters(PUNC_CHARS)),WHITESPACE_CHARS=makePredicate(characters(WHITESPACE_CHARS)),JS_Parse_Error.prototype=Object.create(SyntaxError.prototype),JS_Parse_Error.prototype.constructor=JS_Parse_Error;var EX_EOF={};function tokenizer(r,a,o,s){var i={text:r,filename:a,pos:0,tokpos:0,line:1,tokline:0,col:0,tokcol:0,newline_before:!1,regex_allowed:!1,comments_before:[],directives:Object.create(null),read_template:e("Unterminated template literal",function(e){for(var n="";;){var t=r();switch(t){case"\\":t+=r();break;case"`":return void e.push(n);case"$":if("{"==c())return l(),e.push(n),i.regex_allowed=!0}n+=t}function r(){var e=l(!0,!0);return"\r"==e?"\n":e}})},u=!1;function c(){return i.text.charAt(i.pos)}function l(e,n){var t=i.text.charAt(i.pos++);if(e&&!t)throw EX_EOF;return NEWLINE_CHARS[t]?(i.col=0,i.line++,n||(i.newline_before=!0),"\r"==t&&"\n"==c()&&(i.pos++,t="\n")):i.col++,t}function _(e){for(;0<e--;)l()}function f(e){return i.text.substr(i.pos,e.length)==e}function p(){i.tokline=i.line,i.tokcol=i.col,i.tokpos=i.pos}function d(e,n,t){i.regex_allowed="operator"==e&&!UNARY_POSTFIX[n]||"keyword"==e&&KEYWORDS_BEFORE_EXPRESSION[n]||"punc"==e&&PUNC_BEFORE_EXPRESSION[n],"punc"==e&&"."==n?u=!0:t||(u=!1);n={type:e,value:n,line:i.tokline,col:i.tokcol,pos:i.tokpos,endline:i.line,endcol:i.col,endpos:i.pos,nlb:i.newline_before,file:a};return/^(?:num|string|regexp)$/i.test(e)&&(n.raw=r.substring(n.pos,n.endpos)),t||(n.comments_before=i.comments_before,n.comments_after=i.comments_before=[]),i.newline_before=!1,new AST_Token(n)}function S(e){js_error(e,a,i.tokline,i.tokcol,i.tokpos)}function A(e){return/^0[0-7_]+$/.test(e)}function m(e){var t=!1,r=!1,a=!1,o="."==e,n=function(e){for(var n,t="";(n=c())&&e(n,t);)t+=l();return t}(function(e,n){switch(e){case"x":case"X":return!a&&(a=!0);case"e":case"E":return a||!t&&(t=r=!0);case"+":case"-":return r;case r=!1,".":return!(o||t||a||A(n))&&(o=!0)}return/[_0-9a-dfo]/i.test(e)}),e=(A(n=e?e+n:n)?E.has_directive("use strict")&&S("Legacy octal literals are not allowed in strict mode"):n=n.replace(a?/([1-9a-f]|.0)_(?=[0-9a-f])/gi:/([1-9]|.0)_(?=[0-9])/gi,"$1"),parse_js_number(n));return isNaN(e)&&S("Invalid syntax: "+n),o||t||"n"!=c()?d("num",e):(l(),d("bigint",n.toLowerCase()))}function v(e){var n,t=l(!0,e);if("0"<=t&&t<="7")return n=t,"0"<=(a=c())&&a<="7"&&(n+=l(!0))[0]<="3"&&"0"<=(a=c())&&a<="7"&&(n+=l(!0)),"0"===n?"\0":(0<n.length&&E.has_directive("use strict")&&S("Legacy octal escape sequences are not allowed in strict mode"),String.fromCharCode(parseInt(n,8)));if("u"==t){var r=l(!0,e);if(t+=r,"{"!=r)t+=l(!0,e)+l(!0,e)+l(!0,e);else for(;t+=r=l(!0,e),"}"!=r;);}else"x"==t&&(t+=l(!0,e)+l(!0,e));var a=decode_escape_sequence(t);return"string"!=typeof a&&S("Invalid escape sequence: \\"+t),a}var T=e("Unterminated string constant",function(e){for(var n=l(),t="";;){var r=l(!0,!0);if("\\"==r)r=v(!0);else if(NEWLINE_CHARS[r])S("Unterminated string constant");else if(r==n)break;t+=r}var a=d("string",t);return a.quote=e,a});function k(e){var n,t=i.regex_allowed,r=function(){for(var e=i.text,n=i.pos;n<i.text.length;++n)if(NEWLINE_CHARS[e[n]])return n;return-1}();return-1==r?(n=i.text.substr(i.pos),i.pos=i.text.length):(n=i.text.substring(i.pos,r),i.pos=r),i.col=i.tokcol+(i.pos-i.tokpos),i.comments_before.push(d(e,n,!0)),i.regex_allowed=t,E}var w=e("Unterminated multiline comment",function(){var e=i.regex_allowed,n=function(e,n){if(e=i.text.indexOf(e,i.pos),n&&-1==e)throw EX_EOF;return e}("*/",!0),n=i.text.substring(i.pos,n).replace(/\r\n|\r|\u2028|\u2029/g,"\n");return _(n.length+2),i.comments_before.push(d("comment2",n,!0)),i.regex_allowed=e,E});function y(){for(var e,n,t=!1,r=!1,a="#"==c()?l():"";e=c();)if(t)"u"!=e&&S("Expecting UnicodeEscapeSequence -- uXXXX"),is_identifier_char(e=v())||S("Unicode char: "+e.charCodeAt(0)+" is not valid in identifier"),a+=e,t=!1;else if("\\"==e)r=t=!0,l();else{if(!is_identifier_char(e))break;a+=l()}return KEYWORDS[a]&&r&&(n=a.charCodeAt(0).toString(16).toUpperCase(),a="\\u"+"0000".substr(n.length)+n+a.slice(1)),a}var b=e("Unterminated regular expression",function(e){for(var n,t=!1,r=!1;n=l(!0);)if(NEWLINE_CHARS[n])S("Unexpected line terminator");else if(t)e+="\\"+n,t=!1;else if("["==n)r=!0,e+=n;else if("]"==n&&r)r=!1,e+=n;else{if("/"==n&&!r)break;"\\"==n?t=!0:e+=n}var a=y();try{var o=new RegExp(e,a);return o.raw_source=e,d("regexp",o)}catch(e){S(e.message)}});function h(e){return d("operator",function e(n){var t;return c()&&(t=n+c(),OPERATORS[t])?(l(),e(t)):n}(e||l()))}function e(n,t){return function(e){try{return t(e)}catch(e){if(e!==EX_EOF)throw e;S(n)}}}function E(e){if(null!=e)return b(e);for(s&&0==i.pos&&f("#!")&&(p(),_(2),k("comment5"));;){for(;WHITESPACE_CHARS[c()];)l();if(p(),o){if(f("\x3c!--")){_(4),k("comment3");continue}if(f("--\x3e")&&i.newline_before){_(3),k("comment4");continue}}var n=c();if(!n)return d("eof");var t=n.charCodeAt(0);switch(t){case 34:case 39:return T(n);case 46:return l(),f("..")?d("operator","."+l()+l()):is_digit(c().charCodeAt(0))?m("."):d("punc",".");case 47:var r=function(){switch(l(),c()){case"/":return l(),k("comment1");case"*":return l(),w()}return i.regex_allowed?b(""):h("/")}();if(r===E)continue;return r}if(is_digit(t))return m();if(PUNC_CHARS[n])return d("punc",l());if(f("=>"))return d("punc",l()+l());if(OPERATOR_CHARS[n])return h();if(35!=t&&92!=t&&NON_IDENTIFIER_CHARS[n])break;return t=void 0,t=y(),u?d("name",t):KEYWORDS_ATOM[t]?d("atom",t):KEYWORDS[t]?OPERATORS[t]?d("operator",t):d("keyword",t):d("name",t)}S("Unexpected character '"+n+"'")}return E.context=function(e){return i=e?e:i},E.add_directive=function(e){i.directives[e]=!0},E.push_directives_stack=function(){i.directives=Object.create(i.directives)},E.pop_directives_stack=function(){i.directives=Object.getPrototypeOf(i.directives)},E.has_directive=function(e){return!!i.directives[e]},E}var UNARY_PREFIX=makePredicate("typeof void delete -- ++ ! ~ - +"),UNARY_POSTFIX=makePredicate("-- ++"),ASSIGNMENT=makePredicate("= += -= /= *= %= **= >>= <<= >>>= &= |= ^= &&= ||= ??="),PRECEDENCE=function(e,n){for(var t=0;t<e.length;)for(var r=e[t++],a=0;a<r.length;a++)n[r[a]]=t;return n}([["??"],["||"],["&&"],["|"],["^"],["&"],["==","===","!=","!=="],["<",">","<=",">=","in","instanceof"],[">>","<<",">>>"],["+","-"],["*","/","%"],["**"]],{}),ATOMIC_START_TOKEN=makePredicate("atom bigint num regexp string");function parse(e,g){g=defaults(g,{bare_returns:!1,expression:!1,filename:null,html5_comments:!0,module:!1,shebang:!0,strict:!1,toplevel:null},!0);var R={input:"string"==typeof e?tokenizer(e,g.filename,g.html5_comments,g.shebang):e,in_async:!1,in_directives:!0,in_funarg:-1,in_function:0,in_generator:!1,in_loop:0,labels:[],peeked:null,prev:null,token:null};function C(e,n){return is_token(R.token,e,n)}function O(){return R.peeked||(R.peeked=R.input())}function N(){return R.prev=R.token,R.peeked?(R.token=R.peeked,R.peeked=null):R.token=R.input(),R.in_directives=R.in_directives&&("string"==R.token.type||C("punc",";")),R.token}function x(){return R.prev}function P(e,n,t,r){var a=R.input.context();js_error(e,a.filename,null!=n?n:a.tokline,null!=t?t:a.tokcol,null!=r?r:a.tokpos)}function D(e,n){P(n,e.line,e.col)}function r(e,n){return e+(void 0===n?"":" «"+n+"»")}function I(e){D(e=null==e?R.token:e,"Unexpected token: "+r(e.type,e.value))}function F(e,n){if(C(e,n))return N();D(R.token,"Unexpected token: "+r(R.token.type,R.token.value)+", expected: "+r(e,n))}function U(e){F("punc",e)}function H(e){return e.nlb||!all(e.comments_before,function(e){return!e.nlb})}function Z(){return!g.strict&&(C("eof")||C("punc","}")||H(R.token))}function W(e){C("punc",";")?N():e||Z()||U(";")}function X(){U("(");var e=J();return U(")"),e}function n(r){return function(){var e=R.token,n=r.apply(null,arguments),t=x();return n.start=e,n.end=t,n}}function j(){(C("operator","/")||C("operator","/="))&&(R.peeked=null,R.token=R.input(R.token.value.substr(1)))}R.token=N();var Y=n(function(e){switch(j(),R.token.type){case"string":var n=R.in_directives,t=J();return n&&(t instanceof AST_String?(w=t.start.raw.slice(1,-1),R.input.add_directive(w),t.value=w):R.in_directives=n=!1),W(),n?new AST_Directive(t):new AST_SimpleStatement({body:t});case"num":case"bigint":case"regexp":case"operator":case"atom":return K();case"name":switch(R.token.value){case"async":if(is_token(O(),"keyword","function"))return N(),N(),C("operator","*")?(N(),V(AST_AsyncGeneratorDefun)):V(AST_AsyncDefun);break;case"await":if(R.in_async)return K();break;case"export":if(e||""===g.module||I(),N(),C("operator","*"))return s=o=R.token,N(),C("name","as")&&(N(),te()||F("name"),s=R.token,N()),F("name","from"),new AST_ExportForeign({aliases:[B(s)],keys:[B(o)],path:re()});if(C("punc","{")){N();for(var r=[],a=[];te();){var o=R.token;N(),a.push(o),C("name","as")?(N(),te()||F("name"),r.push(R.token),N()):r.push(o),C("punc","}")||U(",")}return(U("}"),C("name","from"))?(N(),new AST_ExportForeign({aliases:r.map(B),keys:a.map(B),path:re()})):(W(),new AST_ExportReferences({properties:a.map(function(e,n){is_token(e,"name")||D(e,"Name expected");e=le(AST_SymbolExport,e);return e.alias=B(r[n]),e})}))}return C("keyword","default")?(N(),s=R.token,(c=function(){if(C("name","async")){if(is_token(O(),"keyword","function"))return N(),N(),C("operator","*")?(N(),M(AST_AsyncGeneratorDefun,V(AST_AsyncGeneratorFunction))):M(AST_AsyncDefun,V(AST_AsyncFunction))}else if(C("keyword"))switch(R.token.value){case"class":return N(),M(AST_DefClass,ne(AST_ClassExpression));case"function":return(N(),C("operator","*"))?(N(),M(AST_GeneratorDefun,V(AST_GeneratorFunction))):M(AST_Defun,V(AST_Function))}}())?(c.start=s,c.end=x()):(j(),c=J(),W()),new AST_ExportDefault({body:c})):new AST_ExportDeclaration({body:ae()});case"import":var s=O();if("punc"==s.type&&/^[(.]$/.test(s.value))break;e||""===g.module||I(),N();var i,u,c=null,l=G(AST_SymbolImport,!0),_=null;if(l?(l.key=new AST_String({start:l.start,value:"",end:l.end}),(i=C("punc",","))&&N()):i=!C("string"),i)if(C("operator","*")){var f=R.token;N(),F("name","as"),(c=G(AST_SymbolImport)).key=B(f)}else{for(U("{"),_=[];te();)is_token(O(),"name","as")?(f=R.token,N(),N(),(u=G(AST_SymbolImport)).key=B(f)):(u=G(AST_SymbolImport)).key=new AST_String({start:u.start,value:u.name,end:u.end}),_.push(u),C("punc","}")||U(",");U("}")}return(c||l||_)&&F("name","from"),new AST_Import({all:c,default:l,path:re(),properties:_});case"let":if(se())return N(),p=ue(),W(),p;break;case"yield":if(R.in_generator)return K()}return(is_token(O(),"punc",":")?function(){var n=G(AST_Label);all(R.labels,function(e){return e.name!=n.name})||P("Label "+n.name+" defined twice");U(":"),R.labels.push(n);var e=Y();R.labels.pop(),e instanceof AST_IterationStatement||n.references.forEach(function(e){e instanceof AST_Continue&&D(e.label.start,"Continue label `"+n.name+"` must refer to IterationStatement")});return new AST_LabeledStatement({body:e,label:n})}:K)();case"punc":switch(R.token.value){case"{":return new AST_BlockStatement({start:R.token,body:L(),end:x()});case"[":case"(":case"`":return K();case";":return R.in_directives=!1,N(),new AST_EmptyStatement;default:I()}case"keyword":switch(R.token.value){case"break":return N(),ee(AST_Break);case"class":return N(),ne(AST_DefClass);case"const":N();var p=ie();return W(),p;case"continue":return N(),ee(AST_Continue);case"debugger":return N(),W(),new AST_Debugger;case"do":N();var t=Q(Y),d=(F("keyword","while"),X());return W(!0),new AST_Do({body:t,condition:d});case"while":return N(),new AST_While({condition:X(),body:Q(Y)});case"for":N();var d=C("name","await")&&N(),S=(U("("),null);if(!d&&C("punc",";")||(S=(C("keyword","const")?(N(),ie):C("name","let")&&se()?(N(),ue):C("keyword","var")?(N(),ce):J)(!0),d?(F("name","of"),T=AST_ForAwaitOf):C("operator","in")?(N(),T=AST_ForIn):C("name","of")&&(N(),T=AST_ForOf),!T))return A=S,U(";"),m=C("punc",";")?null:J(),U(";"),v=C("punc",")")?null:J(),U(")"),new AST_For({init:A,condition:m,step:v,body:Q(Y)});S instanceof AST_Definitions?(1<S.definitions.length&&D(S.start,"Only one variable declaration allowed in for..in/of loop"),T!==AST_ForIn&&S.definitions[0].value&&D(S.definitions[0].value.start,"No initializers allowed in for..of loop")):$(S)||(S=z(S))instanceof AST_Destructured||D(S.start,"Invalid left-hand side in for..in/of loop");var A=T,m=S,v=(j(),J());return U(")"),new A({init:m,object:v,body:Q(Y)});case"function":return(N(),C("operator","*"))?(N(),V(AST_GeneratorDefun)):V(AST_Defun);case"if":N();var T=X(),S=Y(),k=null;return C("keyword","else")&&(N(),k=Y()),new AST_If({condition:T,body:S,alternative:k});case"return":0!=R.in_function||g.bare_returns||P("'return' outside of function"),N();var w=null;return C("punc",";")?N():Z()||(w=J(),W()),new AST_Return({value:w});case"switch":return N(),new AST_Switch({expression:X(),body:Q(oe)});case"throw":N(),H(R.token)&&P("Illegal newline after 'throw'");w=J();return W(),new AST_Throw({value:w});case"try":N();var y,b,k=L(),h=null,E=null;return C("keyword","catch")&&(b=R.token,N(),y=null,C("punc","(")&&(N(),y=q(AST_SymbolCatch),U(")")),h=new AST_Catch({start:b,argname:y,body:L(),end:x()})),C("keyword","finally")&&(b=R.token,N(),E=new AST_Finally({start:b,body:L(),end:x()})),h||E||P("Missing catch/finally blocks"),new AST_Try({body:k,bcatch:h,bfinally:E});case"var":N();p=ce();return W(),p;case"with":return R.input.has_directive("use strict")&&P("Strict mode may not include a with statement"),N(),new AST_With({expression:X(),body:Y()})}}I()});function K(){var e=J();return W(),new AST_SimpleStatement({body:e})}function ee(e){var n,t=null,e=(null!=(t=Z()?t:G(AST_LabelRef,!0))?((n=find_if(function(e){return e.name==t.name},R.labels))||D(t.start,"Undefined label "+t.name),t.thedef=n):0==R.in_loop&&P(e.TYPE+" not inside a loop or switch"),W(),new e({label:t}));return n&&n.references.push(e),e}function A(e,n){if(C("name",e)){e=O();if(e&&!is_token(e,"operator","=")&&!("punc"==e.type&&/^[(;}]$/.test(e.value)||n&&H(e)))return N()}}function ne(e){for(var n,t=R.in_async,r=R.in_generator,a=(R.input.push_directives_stack(),R.input.add_directive("use strict"),n=e===AST_DefClass?G(AST_SymbolDefClass):G(AST_SymbolClass,!0),null),o=(C("keyword","extends")&&(N(),j(),a=m(!0)),U("{"),[]);!C("punc","}");)if(C("punc",";"))N();else{var s=R.token,i=!!A("static"),u=A("async",!0);if(C("operator","*")){N();var c=C("name")&&/^#/.test(R.token.value),l=d(),_=R.token,f=V(u?AST_AsyncGeneratorFunction:AST_GeneratorFunction);f.start=_,f.end=x(),o.push(new AST_ClassMethod({start:s,static:i,private:c,key:l,value:f,end:x()}))}else if(i&&C("punc","{"))o.push(new AST_ClassInit({start:s,value:new AST_ClassInitBlock({start:s,body:L(),end:x()}),end:x()}));else{c=C("name")&&/^#/.test(R.token.value),l=d();if(C("punc","(")){_=R.token,f=V(u?AST_AsyncFunction:AST_Function);f.start=_,f.end=x(),o.push(new AST_ClassMethod({start:s,static:i,private:c,key:l,value:f,end:x()}))}else{u&&I(u);u=null;if(C("operator","="))N(),R.in_async=!1,R.in_generator=!1,u=S(),R.in_generator=r,R.in_async=t;else if(!C("punc",";")&&!C("punc","}")){var p=null;switch(l){case"get":p=AST_ClassGetter;break;case"set":p=AST_ClassSetter}if(p){o.push(new p({start:s,static:i,private:C("name")&&/^#/.test(R.token.value),key:d(),value:T(),end:x()}));continue}}W(),o.push(new AST_ClassField({start:s,static:i,private:c,key:l,value:u,end:x()}))}}}return N(),R.input.pop_directives_stack(),R.in_generator=r,R.in_async=t,new e({extends:a,name:n,properties:o})}function _(e){var n;return e instanceof AST_Array?(n=null,e.elements[e.elements.length-1]instanceof AST_Spread&&(n=_(e.elements.pop().expression)),new AST_DestructuredArray({start:e.start,elements:e.elements.map(_),rest:n,end:e.end})):e instanceof AST_Assign?new AST_DefaultValue({start:e.start,name:_(e.left),value:e.right,end:e.end}):e instanceof AST_DefaultValue?(e.name=_(e.name),e):e instanceof AST_DestructuredArray?(e.elements=e.elements.map(_),e.rest&&(e.rest=_(e.rest)),e):e instanceof AST_DestructuredObject?(e.properties.forEach(function(e){e.value=_(e.value)}),e.rest&&(e.rest=_(e.rest)),e):e instanceof AST_Hole?e:e instanceof AST_Object?(n=null,e.properties[e.properties.length-1]instanceof AST_Spread&&(n=_(e.properties.pop().expression)),new AST_DestructuredObject({start:e.start,properties:e.properties.map(function(e){return e instanceof AST_ObjectKeyVal||D(e.start,"Invalid destructuring assignment"),new AST_DestructuredKeyVal({start:e.start,key:e.key,value:_(e.value),end:e.end})}),rest:n,end:e.end})):e instanceof AST_SymbolFunarg?e:e instanceof AST_SymbolRef?new AST_SymbolFunarg(e):e instanceof AST_Yield?new AST_SymbolFunarg({start:e.start,name:"yield",end:e.end}):void D(e.start,"Invalid arrow parameter")}function l(e,n,t){var r,a,o=R.in_async,s=R.in_generator,i=(R.in_async=t,R.in_generator=!1,R.in_funarg),u=(R.in_funarg=R.in_function,e.map(_)),e=(e=e.rest||null)&&_(e),i=(R.in_funarg=i,U("=>"),R.in_loop),c=R.labels,l=(++R.in_function,R.input.push_directives_stack(),R.in_loop=0,R.labels=[],a=C("punc","{")?(R.in_directives=!0,r=L(),null):(r=[],j(),S()),R.input.has_directive("use strict")),i=(R.input.pop_directives_stack(),--R.in_function,R.in_loop=i,R.labels=c,R.in_generator=s,R.in_async=o,new(t?AST_AsyncArrow:AST_Arrow)({start:n,argnames:u,rest:e,body:r,value:a,end:x()}));return l&&i.each_argname(w),i}var V=function(e){var n,t=R.in_async,r=R.in_generator,a=(/Defun$/.test(e.TYPE)?(n=G(AST_SymbolDefun),R.in_async=/^Async/.test(e.TYPE),R.in_generator=/Generator/.test(e.TYPE)):(R.in_async=/^Async/.test(e.TYPE),R.in_generator=/Generator/.test(e.TYPE),n=G(AST_SymbolLambda,!0)),!n||e===AST_Accessor||n instanceof AST_SymbolDeclaration||I(x()),U("("),R.in_funarg),o=(R.in_funarg=R.in_function,f(")",!g.strict,!1,function(){return c(AST_SymbolFunarg)})),a=(R.in_funarg=a,R.in_loop),s=R.labels,i=(++R.in_function,R.in_directives=!0,R.input.push_directives_stack(),R.in_loop=0,R.labels=[],L()),u=R.input.has_directive("use strict"),a=(R.input.pop_directives_stack(),--R.in_function,R.in_loop=a,R.labels=s,R.in_generator=r,R.in_async=t,new e({name:n,argnames:o,rest:o.rest||null,body:i}));return u&&(n&&w(n),a.each_argname(w)),a};function te(){return C("name")||C("string")||is_identifier_string(R.token.value)}function B(e){return new AST_String({start:e,quote:e.quote,value:e.value,end:e})}function re(){var e=R.token;return F("string"),W(),B(e)}function M(e,n){return n.name&&((n=new e(n)).name=new(e===AST_DefClass?AST_SymbolDefClass:AST_SymbolDefun)(n.name)),n}var ae=n(function(){if(C("name"))switch(R.token.value){case"async":return(N(),F("keyword","function"),C("operator","*"))?(N(),V(AST_AsyncGeneratorDefun)):V(AST_AsyncDefun);case"let":N();var e=ue();return W(),e}else if(C("keyword"))switch(R.token.value){case"class":return N(),ne(AST_DefClass);case"const":N();e=ie();return W(),e;case"function":return(N(),C("operator","*"))?(N(),V(AST_GeneratorDefun)):V(AST_Defun);case"var":N();e=ce();return W(),e}I()});function L(){U("{");for(var e=[];!C("punc","}");)C("eof")&&U("}"),e.push(Y());return N(),e}function oe(){U("{");for(var e,n,t,r,a=[];!C("punc","}");)C("eof")&&U("}"),C("keyword","case")?(e&&(e.end=x()),n=[],e=new AST_Case({start:(r=R.token,N(),r),expression:J(),body:n}),a.push(e),U(":")):C("keyword","default")?(e&&(e.end=x()),t&&P("More than one default clause in switch statement"),n=[],e=new AST_Default({start:(r=R.token,N(),U(":"),r),body:n}),a.push(e),t=e):(n||I(),n.push(Y()));return e&&(e.end=x()),N(),a}function a(e,n){for(var t=[];;){var r=R.token,a=q(e),o=null;if(C("operator","=")?(N(),o=S(n)):!n&&(e===AST_SymbolConst||a instanceof AST_Destructured)&&P("Missing initializer in declaration"),t.push(new AST_VarDef({start:r,name:a,value:o,end:x()})),!C("punc",","))break;N()}return t}function se(){var e=O();return is_token(e,"name")||is_token(e,"punc","[")||is_token(e,"punc","{")}var ie=function(e){return new AST_Const({start:x(),definitions:a(AST_SymbolConst,e),end:x()})},ue=function(e){return new AST_Let({start:x(),definitions:a(AST_SymbolLet,e),end:x()})},ce=function(e){return new AST_Var({start:x(),definitions:a(AST_SymbolVar,e),end:x()})};var m=function(e){if(C("operator","new"))return n=e,i=R.token,F("operator","new"),(u=C("punc",".")&&is_token(O(),"name","target")?(N(),N(),new AST_NewTarget):(u=m(!1),c=C("punc","(")?(N(),f(")",!g.strict)):[],new AST_New({expression:u,args:c}))).start=i,u.end=x(),p(u,n);var n,t,r,a=R.token;if(C("punc")){switch(a.value){case"`":return p(y(null),e);case"(":return(N(),C("punc",")"))?(N(),l([],a)):(t=J(!1,!0),r=a.comments_before.length,[].unshift.apply(t.start.comments_before,a.comments_before),a.comments_before.length=0,a.comments_before=t.start.comments_before,0==(a.comments_before_length=r)&&0<a.comments_before.length&&((r=a.comments_before[0]).nlb||(r.nlb=a.nlb,a.nlb=!1)),a.comments_after=t.start.comments_after,t.start=a,U(")"),(r=x()).comments_before=t.end.comments_before,r.comments_after.forEach(function(e){t.end.comments_after.push(e),e.nlb&&(R.token.nlb=!0)}),r.comments_after.length=0,r.comments_after=t.end.comments_after,t.end=r,C("punc","=>")?l(t instanceof AST_Sequence?t.expressions:[t],a):p(t,e));case"[":return p(v(),e);case"{":return p(k(),e)}I()}if(C("keyword"))switch(a.value){case"class":N();var o=ne(AST_ClassExpression);return o.start=a,o.end=x(),p(o,e);case"function":return N(),(s=C("operator","*")?(N(),V(AST_GeneratorFunction)):V(AST_Function)).start=a,s.end=x(),p(s,e)}if(C("name")){var s,i,u,c=le(AST_SymbolRef,a);if(N(),"async"==c.name){if(C("keyword","function"))return N(),(s=C("operator","*")?(N(),V(AST_AsyncGeneratorFunction)):V(AST_AsyncFunction)).start=a,s.end=x(),p(s,e);if(C("name")&&is_token(O(),"punc","=>"))return a=R.token,c=le(AST_SymbolRef,a),N(),l([c],a,!0);if(C("punc","("))return i=p(c,e),C("punc","=>")?((u=i.args)[u.length-1]instanceof AST_Spread&&(u.rest=u.pop().expression),l(u,a,!0)):i}return C("punc","=>")?l([c],a):p(c,e)}if(ATOMIC_START_TOKEN[R.token.type])return p(function(){var e,n=R.token,t=n.value;switch(n.type){case"num":isFinite(t)?e=new AST_Number({value:t}):(e=new AST_Infinity,t<0&&(e=new AST_UnaryPrefix({operator:"-",expression:e})));break;case"bigint":e=new AST_BigInt({value:t});break;case"string":e=new AST_String({value:t,quote:n.quote});break;case"regexp":e=new AST_RegExp({value:t});break;case"atom":switch(t){case"false":e=new AST_False;break;case"true":e=new AST_True;break;case"null":e=new AST_Null;break;default:I()}break;default:I()}return N(),e.start=e.end=n,e}(),e);I()};function f(e,n,t,r){r=r||S;for(var a=!0,o=[];!C("punc",e)&&(a?a=!1:U(","),!n||!C("punc",e));)if(t&&C("punc",","))o.push(new AST_Hole({start:R.token,end:R.token}));else if(C("operator","...")){if(r!==S){N(),o.rest=r(),o.rest instanceof AST_DefaultValue&&D(o.rest.start,"Invalid rest parameter");break}o.push(new AST_Spread({start:R.token,expression:(N(),r()),end:x()}))}else o.push(r());return U(e),o}var v=n(function(){return U("["),new AST_Array({elements:f("]",!g.strict,!0)})}),T=n(function(){return V(AST_Accessor)}),k=n(function(){U("{");for(var e=!0,n=[];!C("punc","}")&&(e?e=!1:U(","),g.strict||!C("punc","}"));){var t=R.token;if(C("operator","*")){N();var r=d(),a=R.token,o=V(AST_GeneratorFunction);o.start=a,o.end=x(),n.push(new AST_ObjectMethod({start:t,key:r,value:o,end:x()}))}else if(C("operator","..."))N(),n.push(new AST_Spread({start:t,expression:S(),end:x()}));else if(is_token(O(),"operator","=")){a=G(AST_SymbolRef);N(),n.push(new AST_ObjectKeyVal({start:t,key:t.value,value:new AST_Assign({start:t,left:a,operator:"=",right:S(),end:x()}),end:x()}))}else if(is_token(O(),"punc",",")||is_token(O(),"punc","}"))n.push(new AST_ObjectKeyVal({start:t,key:t.value,value:G(AST_SymbolRef),end:x()}));else{r=d();if(C("punc","(")){var s=R.token;(i=V(AST_Function)).start=s,i.end=x(),n.push(new AST_ObjectMethod({start:t,key:r,value:i,end:x()}))}else if(C("punc",":"))N(),n.push(new AST_ObjectKeyVal({start:t,key:r,value:S(),end:x()}));else{if("name"==t.type)switch(r){case"async":var i,u=C("operator","*")&&N(),s=(r=d(),R.token);(i=V(u?AST_AsyncGeneratorFunction:AST_AsyncFunction)).start=s,i.end=x(),n.push(new AST_ObjectMethod({start:t,key:r,value:i,end:x()}));continue;case"get":n.push(new AST_ObjectGetter({start:t,key:d(),value:T(),end:x()}));continue;case"set":n.push(new AST_ObjectSetter({start:t,key:d(),value:T(),end:x()}));continue}I()}}}return N(),new AST_Object({properties:n})});function d(){var e=R.token;switch(e.type){case"operator":KEYWORDS[e.value]||I();case"num":case"string":case"name":case"keyword":case"atom":return N(),""+e.value;case"punc":U("[");var n=S();return U("]"),n;default:I()}}function le(e,n){var t=n.value;switch(t){case"await":R.in_async&&I(n);break;case"super":e=AST_Super;break;case"this":e=AST_This;break;case"yield":R.in_generator&&I(n)}return new e({name:""+t,start:n,end:n})}function w(e){"arguments"!=e.name&&"eval"!=e.name&&"let"!=e.name||D(e.start,"Unexpected "+e.name+" in strict mode")}function G(e,n){return C("name")?(e=le(e,R.token),R.input.has_directive("use strict")&&e instanceof AST_SymbolDeclaration&&w(e),N(),e):(n||P("Name expected"),null)}function q(e){var n,t=R.token;if(C("punc","["))return N(),n=f("]",!g.strict,!0,function(){return c(e)}),new AST_DestructuredArray({start:t,elements:n,rest:n.rest||null,end:x()});if(C("punc","{")){N();for(var r=!0,a=[],o=null;!C("punc","}")&&(r?r=!1:U(","),g.strict||!C("punc","}"));){var s=R.token;if(C("punc","[")||is_token(O(),"punc",":")){var i=d();U(":"),a.push(new AST_DestructuredKeyVal({start:s,key:i,value:c(e),end:x()}))}else{if(C("operator","...")){N(),o=q(e);break}i=G(e);C("operator","=")&&(N(),i=new AST_DefaultValue({start:i.start,name:i,value:S(),end:x()})),a.push(new AST_DestructuredKeyVal({start:s,key:s.value,value:i,end:x()}))}}return U("}"),new AST_DestructuredObject({start:t,properties:a,rest:o,end:x()})}return G(e)}function c(e){var n=R.token,e=q(e);return C("operator","=")?(N(),new AST_DefaultValue({start:n,name:e,value:S(),end:x()})):e}function y(e){for(var n=e?e.start:R.token,t=R.input.context().read_template,r=[],a=[];t(r);)N(),a.push(J()),C("punc","}")||I();return N(),new AST_Template({start:n,expressions:a,strings:r,tag:e,end:x()})}function p(e,n){for(var t=e.start,r=null;;)if(C("operator","?")&&is_token(O(),"punc",".")&&(N(),N(),r=e),C("punc","[")){N();var a=J();U("]"),e=new AST_Sub({start:t,optional:r===e,expression:e,property:a,end:x()})}else if(n&&C("punc","("))N(),e=new AST_Call({start:t,optional:r===e,expression:e,args:f(")",!g.strict),end:x()});else if(r===e||C("punc","."))r!==e&&N(),e=new AST_Dot({start:t,optional:r===e,expression:e,property:(a=void 0,a=R.token.value,F("name"),a),end:x()});else{if(!C("punc","`"))break;r&&P("Invalid template on optional chain"),e=y(e)}if(r&&(e.terminal=!0),e instanceof AST_Call&&!e.pure)for(var o=(t=e.start).comments_before,s=HOP(t,"comments_before_length")?t.comments_before_length:o.length;0<=--s;)if(/[@#]__PURE__/.test(o[s].value)){e.pure=!0;break}return e}function o(e){var n,t,r=R.token;if(R.in_async&&C("name","await"))return R.in_funarg===R.in_function&&P("Invalid use of await in function argument"),R.input.context().regex_allowed=!0,N(),new AST_Await({start:r,expression:o(e),end:x()});if(R.in_generator&&C("name","yield"))return R.in_funarg===R.in_function&&P("Invalid use of yield in function argument"),R.input.context().regex_allowed=!0,N(),t=null,n=!1,C("operator","*")?(N(),t=S(e),n=!0):(C("punc")?PUNC_AFTER_EXPRESSION[R.token.value]:Z())||(t=S(e)),new AST_Yield({start:r,expression:t,nested:n,end:x()});if(C("operator")&&UNARY_PREFIX[r.value])return N(),j(),(t=s(AST_UnaryPrefix,r,o(e))).start=r,t.end=x(),t;for(var a=m(!0);C("operator")&&UNARY_POSTFIX[R.token.value]&&!H(R.token);)(a=s(AST_UnaryPostfix,R.token,a)).start=r,a.end=R.token,N();return a}function s(e,n,t){var r=n.value;switch(r){case"++":case"--":$(t)||D(n,"Invalid use of "+r+" operator");break;case"delete":t instanceof AST_SymbolRef&&R.input.has_directive("use strict")&&D(t.start,"Calling delete on expression not allowed in strict mode")}return new e({operator:r,expression:t})}var i=function(e,n,t){var r=C("operator")?R.token.value:null,a=null!=(r="in"==r&&t?null:r)?PRECEDENCE[r]:null;return null!=a&&n<a?(N(),a=i(o(t),"**"==r?a-1:a,t),i(new AST_Binary({start:e.start,left:e,operator:r,right:a,end:a.end}),n,t)):e};var u=function(e){var n,t=R.token,r=i(o(r=e),0,r);return C("operator","?")?(N(),n=S(),U(":"),new AST_Conditional({start:t,condition:r,consequent:n,alternative:S(e),end:x()})):r};function $(e){return e instanceof AST_PropAccess&&!e.optional||e instanceof AST_SymbolRef}function z(e){var n;if(e instanceof AST_Array)return t=null,(!(e.elements[e.elements.length-1]instanceof AST_Spread)||(t=z(e.elements.pop().expression))instanceof AST_Destructured||$(t))&&(n=e.elements.map(z),all(n,function(e){return e instanceof AST_DefaultValue||e instanceof AST_Destructured||e instanceof AST_Hole||$(e)}))?new AST_DestructuredArray({start:e.start,elements:n,rest:t,end:e.end}):e;if(e instanceof AST_Assign)return(n=z(e.left))instanceof AST_Destructured||$(n)?new AST_DefaultValue({start:e.start,name:n,value:e.right,end:e.end}):e;if(!(e instanceof AST_Object))return e;var t=null;if(e.properties[e.properties.length-1]instanceof AST_Spread&&!((t=z(e.properties.pop().expression))instanceof AST_Destructured||$(t)))return e;for(var r=[],a=0;a<e.properties.length;a++){var o=e.properties[a];if(!(o instanceof AST_ObjectKeyVal))return e;var s=z(o.value);if(!(s instanceof AST_DefaultValue||s instanceof AST_Destructured||$(s)))return e;r.push(new AST_DestructuredKeyVal({start:o.start,key:o.key,value:s,end:o.end}))}return new AST_DestructuredObject({start:e.start,properties:r,rest:t,end:e.end})}function S(e){var n=R.token,t=u(e),r=R.token.value;if(C("operator")&&ASSIGNMENT[r]){if($(t)||"="==r&&(t=z(t))instanceof AST_Destructured)return N(),new AST_Assign({start:n,left:t,operator:r,right:S(e),end:x()});P("Invalid assignment")}return t}function J(e,n){for(var t=R.token,r=[];;){if(n&&C("operator","...")){N(),r.rest=q(AST_SymbolFunarg);break}if(r.push(S(e)),!C("punc",","))break;if(N(),n&&C("punc",")")&&is_token(O(),"punc","=>"))break}return 1!=r.length||r.rest?new AST_Sequence({start:t,expressions:r,end:x()}):r[0]}function Q(e){++R.in_loop;e=e();return--R.in_loop,e}if(g.expression)return j(),e=J(),F("eof"),e;var e=R.token,b=[];for(g.module&&(R.in_async=!0,R.input.add_directive("use strict")),R.input.push_directives_stack();!C("eof");)b.push(Y(!0));R.input.pop_directives_stack();var h=x()||e,t=g.toplevel;return t?(t.body=t.body.concat(b),t.end=h):t=new AST_Toplevel({start:e,body:b,end:h}),t}


// trans
"use strict";function TreeTransformer(n,r){TreeWalker.call(this),this.before=n,this.after=r}TreeTransformer.prototype=new TreeWalker,function(n){function o(n,r){return List(n,function(n){return n.transform(r,!0)})}function r(n,r){n.argnames=o(n.argnames,r),n.rest&&(n.rest=n.rest.transform(r)),n.value?n.value=n.value.transform(r):n.body=o(n.body,r)}n(AST_Node,noop),n(AST_LabeledStatement,function(n,r){n.label=n.label.transform(r),n.body=n.body.transform(r)}),n(AST_SimpleStatement,function(n,r){n.body=n.body.transform(r)}),n(AST_Block,function(n,r){n.body=o(n.body,r)}),n(AST_Do,function(n,r){n.body=n.body.transform(r),n.condition=n.condition.transform(r)}),n(AST_While,function(n,r){n.condition=n.condition.transform(r),n.body=n.body.transform(r)}),n(AST_For,function(n,r){n.init&&(n.init=n.init.transform(r)),n.condition&&(n.condition=n.condition.transform(r)),n.step&&(n.step=n.step.transform(r)),n.body=n.body.transform(r)}),n(AST_ForEnumeration,function(n,r){n.init=n.init.transform(r),n.object=n.object.transform(r),n.body=n.body.transform(r)}),n(AST_With,function(n,r){n.expression=n.expression.transform(r),n.body=n.body.transform(r)}),n(AST_Exit,function(n,r){n.value&&(n.value=n.value.transform(r))}),n(AST_LoopControl,function(n,r){n.label&&(n.label=n.label.transform(r))}),n(AST_If,function(n,r){n.condition=n.condition.transform(r),n.body=n.body.transform(r),n.alternative&&(n.alternative=n.alternative.transform(r))}),n(AST_Switch,function(n,r){n.expression=n.expression.transform(r),n.body=o(n.body,r)}),n(AST_Case,function(n,r){n.expression=n.expression.transform(r),n.body=o(n.body,r)}),n(AST_Try,function(n,r){n.body=o(n.body,r),n.bcatch&&(n.bcatch=n.bcatch.transform(r)),n.bfinally&&(n.bfinally=n.bfinally.transform(r))}),n(AST_Catch,function(n,r){n.argname&&(n.argname=n.argname.transform(r)),n.body=o(n.body,r)}),n(AST_Definitions,function(n,r){n.definitions=o(n.definitions,r)}),n(AST_VarDef,function(n,r){n.name=n.name.transform(r),n.value&&(n.value=n.value.transform(r))}),n(AST_DefaultValue,function(n,r){n.name=n.name.transform(r),n.value=n.value.transform(r)}),n(AST_Lambda,function(n,r){n.name&&(n.name=n.name.transform(r)),n.argnames=o(n.argnames,r),n.rest&&(n.rest=n.rest.transform(r)),n.body=o(n.body,r)}),n(AST_Arrow,r),n(AST_AsyncArrow,r),n(AST_Class,function(n,r){n.name&&(n.name=n.name.transform(r)),n.extends&&(n.extends=n.extends.transform(r)),n.properties=o(n.properties,r)}),n(AST_ClassProperty,function(n,r){n.key instanceof AST_Node&&(n.key=n.key.transform(r)),n.value&&(n.value=n.value.transform(r))}),n(AST_Call,function(n,r){n.expression=n.expression.transform(r),n.args=o(n.args,r)}),n(AST_Sequence,function(n,r){n.expressions=o(n.expressions,r)}),n(AST_Await,function(n,r){n.expression=n.expression.transform(r)}),n(AST_Yield,function(n,r){n.expression&&(n.expression=n.expression.transform(r))}),n(AST_Dot,function(n,r){n.expression=n.expression.transform(r)}),n(AST_Sub,function(n,r){n.expression=n.expression.transform(r),n.property=n.property.transform(r)}),n(AST_Spread,function(n,r){n.expression=n.expression.transform(r)}),n(AST_Unary,function(n,r){n.expression=n.expression.transform(r)}),n(AST_Binary,function(n,r){n.left=n.left.transform(r),n.right=n.right.transform(r)}),n(AST_Conditional,function(n,r){n.condition=n.condition.transform(r),n.consequent=n.consequent.transform(r),n.alternative=n.alternative.transform(r)}),n(AST_Array,function(n,r){n.elements=o(n.elements,r)}),n(AST_DestructuredArray,function(n,r){n.elements=o(n.elements,r),n.rest&&(n.rest=n.rest.transform(r))}),n(AST_DestructuredKeyVal,function(n,r){n.key instanceof AST_Node&&(n.key=n.key.transform(r)),n.value=n.value.transform(r)}),n(AST_DestructuredObject,function(n,r){n.properties=o(n.properties,r),n.rest&&(n.rest=n.rest.transform(r))}),n(AST_Object,function(n,r){n.properties=o(n.properties,r)}),n(AST_ObjectProperty,function(n,r){n.key instanceof AST_Node&&(n.key=n.key.transform(r)),n.value=n.value.transform(r)}),n(AST_ExportDeclaration,function(n,r){n.body=n.body.transform(r)}),n(AST_ExportDefault,function(n,r){n.body=n.body.transform(r)}),n(AST_ExportReferences,function(n,r){n.properties=o(n.properties,r)}),n(AST_Import,function(n,r){n.all&&(n.all=n.all.transform(r)),n.default&&(n.default=n.default.transform(r)),n.properties&&(n.properties=o(n.properties,r))}),n(AST_Template,function(n,r){n.tag&&(n.tag=n.tag.transform(r)),n.expressions=o(n.expressions,r)})}(function(n,e){n.DEFMETHOD("transform",function(n,r){var o;return n.push(this),void 0===(o=n.before?n.before(this,e,r):o)&&(e(o=this,n),n.after)&&void 0!==(r=n.after(o,r))&&(o=r),n.pop(),o})});


// scope
"use strict";function SymbolDef(e,n,a,t){this._bits=0,this.defun=void 0,this.eliminated=0,this.id=e,this.init=t,this.mangled_name=null,this.name=a.name,this.orig=[a],this.references=[],this.replaced=0,this.safe_ids=void 0,this.scope=n}function is_funarg(e){return e.orig[0]instanceof AST_SymbolFunarg||e.orig[1]instanceof AST_SymbolFunarg}SymbolDef.prototype={forEach:function(e){this.orig.forEach(e),this.references.forEach(e)},mangle:function(e){var n,a;this.mangled_name||((n=this.global&&e.cache&&e.cache.props)&&n.has(this.name)?this.mangled_name=n.get(this.name):this.unmangleable(e)||(a=this.redefined(),this.mangled_name=a?a.mangled_name||a.name:next_mangled_name(this,e),n&&n.set(this.name,this.mangled_name)))},redefined:function(){var n,e=this,a=e.defun;return(a=a&&(a.variables.get(n=e.name)||a instanceof AST_Toplevel&&a.globals.get(n)||e.orig[0]instanceof AST_SymbolConst&&find_if(function(e){return e.name==n},a.enclosed)))&&a!==e?a.redefined()||a:void 0},unmangleable:function(e){if(this.exported)return!0;if(this.undeclared)return!0;if(!e.eval&&this.scope.pinned())return!0;if(e.keep_fargs&&is_funarg(this))return!0;if(e.keep_fnames){var n=this.orig[0];if(n instanceof AST_SymbolClass)return!0;if(n instanceof AST_SymbolDefClass)return!0;if(n instanceof AST_SymbolDefun)return!0;if(n instanceof AST_SymbolLambda)return!0}return!(e.toplevel||!this.global)}},DEF_BITPROPS(SymbolDef,["const_redefs","cross_loop","direct_access","exported","global","undeclared"]);var unary_side_effects=makePredicate("delete ++ --");function is_lhs(e,n){return n instanceof AST_Assign?n.left===e&&e:n instanceof AST_DefaultValue?n.name===e&&e:n instanceof AST_Destructured||n instanceof AST_DestructuredKeyVal?e:n instanceof AST_ForEnumeration?n.init===e&&e:n instanceof AST_Unary?unary_side_effects[n.operator]&&n.expression:void 0}function init_block_vars(e,n,a){e.enclosed=a?a.enclosed.slice():[],e.functions=a?a.functions.clone():new Dictionary,e.variables=a?a.variables.clone():new Dictionary,n&&(e.make_def=n.make_def,e.parent_scope=n)}function init_scope_vars(e,n,a){init_block_vars(e,n,a),e.uses_eval=!1,e.uses_with=!1}function names_in_use(e,n){var a,t=e.names_in_use;return t||(e.cname=-1,e.cname_holes=[],e.names_in_use=t=new Dictionary,a=n.cache&&n.cache.props,e.enclosed.forEach(function(e){e.unmangleable(n)&&t.set(e.name,!0),e.global&&a&&a.has(e.name)&&t.set(a.get(e.name),!0)})),t}function next_mangled_name(e,a){var n,t=e.scope,i=names_in_use(t,a),o=t.cname_holes,r=new Dictionary,s=[t];e.forEach(function(e){var n=e.scope;do{if(member(n,s))break;names_in_use(n,a).each(function(e,n){r.set(n,e)}),s.push(n)}while(n=n.parent_scope)});for(var c=0;c<o.length;c++)if(n=base54(o[c]),!r.has(n))return o.splice(c,1),i.set(n,!0),n;for(;;)if(n=base54(++t.cname),!(i.has(n)||RESERVED_WORDS[n]||a.reserved.has[n])){if(!r.has(n))break;o.push(t.cname)}return i.set(n,!0),n}function _default_mangler_options(e){return e=defaults(e,{eval:!1,ie:!1,keep_fargs:!1,keep_fnames:!1,reserved:[],toplevel:!1,v8:!1,webkit:!1}),Array.isArray(e.reserved)||(e.reserved=[]),push_uniq(e.reserved,"arguments"),e.reserved.has=makePredicate(e.reserved),e}AST_Toplevel.DEFMETHOD("figure_out_scope",function(l){l=defaults(l,{cache:null,ie:!1});var _=this,r=null,s=!1,a=0,c=_.parent_scope=null,u=new TreeWalker(function(t,e){var n,a;if(t instanceof AST_DefClass)return n=s,s=u.parent()instanceof AST_ExportDeclaration,t.name.walk(u),s=n,o(function(){t.extends&&t.extends.walk(u),t.properties.forEach(function(e){e.walk(u)})}),!0;if(t instanceof AST_Definitions)return n=s,s=u.parent()instanceof AST_ExportDeclaration,e(),s=n,!0;if(t instanceof AST_LambdaDefinition)return n=s,s=u.parent()instanceof AST_ExportDeclaration,t.name.walk(u),s=n,o(function(){t.argnames.forEach(function(e){e.walk(u)}),t.rest&&t.rest.walk(u),walk_body(t,u)}),!0;if(t instanceof AST_Switch)return t.expression.walk(u),o(function(){walk_body(t,u)}),!0;if(t instanceof AST_SwitchBranch)return t.init_vars(c),e(),!0;if(t instanceof AST_Try)return o(function(){walk_body(t,u)}),t.bcatch&&t.bcatch.walk(u),t.bfinally&&t.bfinally.walk(u),!0;if(t instanceof AST_With){for(var i=c;!(i=i.resolve()).uses_with&&(i.uses_with=!0,i=i.parent_scope););return o(e),!0}if(t instanceof AST_BlockScope)return o(e),!0;function o(e){t.init_vars(c);var n=r,a=c;t instanceof AST_Scope&&(r=t),c=t,e(),c=a,r=n}t instanceof AST_Symbol&&(t.scope=c),t instanceof AST_Label&&((t.thedef=t).references=[]),t instanceof AST_SymbolCatch?c.def_variable(t).defun=r:t instanceof AST_SymbolConst?((a=c.def_variable(t)).defun=r,s&&(a.exported=!0)):t instanceof AST_SymbolDefun?(a=r.def_function(t,u.parent()),s&&(a.exported=!0)):t instanceof AST_SymbolFunarg?r.def_variable(t):t instanceof AST_SymbolLambda?(a=r.def_function(t,"arguments"==t.name?void 0:r),l.ie&&"arguments"!=t.name&&(a.defun=r.parent_scope.resolve())):t instanceof AST_SymbolLet?(a=c.def_variable(t),s&&(a.exported=!0)):t instanceof AST_SymbolVar&&(a=r.def_variable(t,t instanceof AST_SymbolImport?void 0:null),s)&&(a.exported=!0)}),d=(_.make_def=function(e,n){return new SymbolDef(++a,this,e,n)},_.walk(u),_.globals=new Dictionary,[]),u=new TreeWalker(function(e){if(e instanceof AST_Catch)return e.argname instanceof AST_Destructured?(d.push(e),e.argname.walk(u),d.pop(),walk_body(e,u),!0):void 0;if(e instanceof AST_Lambda)return d.push(e),e.name&&e.name.walk(u),e.argnames.forEach(function(e){e.walk(u)}),e.rest&&e.rest.walk(u),d.pop(),walk_lambda(e,u),!0;if(e instanceof AST_LoopControl)return e.label&&e.label.thedef.references.push(e),!0;if(e instanceof AST_SymbolDeclaration){var n,a=e.definition();if(a.preinit=a.references.length,e instanceof AST_SymbolCatch){if(n=a.redefined())for(var t=e.scope;t&&push_uniq(t.enclosed,n)&&t!==n.scope;t=t.parent_scope);}else e instanceof AST_SymbolConst?(n=a.redefined())&&(n.const_redefs=!0):a.scope!==e.scope&&(e instanceof AST_SymbolDefun||e instanceof AST_SymbolFunarg||e instanceof AST_SymbolVar)&&(e.mark_enclosed(l),n=e.scope.find_variable(e.name),e.thedef!==n)&&((e.thedef=n).orig.push(e),e.mark_enclosed(l));return"arguments"!=e.name||(i=e instanceof AST_SymbolVar&&u.parent())instanceof AST_VarDef&&!i.value||(r=e.scope.resolve().find_variable("arguments"))&&m(r)&&(r.scope.uses_arguments=3),!0}if(e instanceof AST_SymbolRef){for(var i,o=e.name,r=e.scope.find_variable(o),s=d.length;0<s&&r&&!((s=d.lastIndexOf(r.scope,s-1))<0);){var c=r.orig[0];if(c instanceof AST_SymbolCatch||c instanceof AST_SymbolFunarg||c instanceof AST_SymbolLambda){e.in_arg=!0;break}r=r.scope.parent_scope.find_variable(o)}if(r?"arguments"==o&&m(r)&&(is_lhs(e,i=u.parent())?r.scope.uses_arguments=3:r.scope.uses_arguments<2&&!(i instanceof AST_PropAccess&&i.expression===e)?r.scope.uses_arguments=2:r.scope.uses_arguments||(r.scope.uses_arguments=!0)):r=_.def_global(e),"eval"==o)if("Call"==(i=u.parent()).TYPE&&i.expression===e)for(t=e.scope;!(t=t.resolve()).uses_eval&&(t.uses_eval=!0,t=t.parent_scope););else r.undeclared&&(_.uses_eval=!0);if(r.init instanceof AST_LambdaDefinition&&r.scope!==r.init.name.scope){var f=e.scope;do{if(f===r.init.name.scope)break}while(f=f.parent_scope);f||(r.init=void 0)}return e.thedef=r,e.reference(l),!0}});function m(e){return e.orig[0]instanceof AST_SymbolFunarg&&!(e.orig[1]instanceof AST_SymbolFunarg||e.orig[2]instanceof AST_SymbolFunarg)&&!is_arrow(e.scope)}function t(e,n){var a,t,i=e.name,o=e.thedef;if(all(o.orig,function(e){return!(e instanceof AST_SymbolConst||e instanceof AST_SymbolLet)}))return(a=n.find_variable(i))?(t=a.redefined())&&(a=t):a=_.globals.get(i),a?a.orig.push(e):a=n.def_variable(e),a.undeclared&&_.variables.set(i,a),"arguments"==i&&m(o)&&e instanceof AST_SymbolLambda||(o.defun=a.scope,o.forEach(function(e){e.redef=o,e.thedef=a,e.reference(l)})),1}_.walk(u),l.ie&&_.walk(new TreeWalker(function(e){var n,a;return e instanceof AST_SymbolCatch?(n=(a=e.thedef).defun,t(e,n="arguments"!=a.name&&n.name instanceof AST_SymbolLambda&&n.name.name==a.name?n.parent_scope.resolve():n),!0):e instanceof AST_SymbolLambda?(a=e.thedef,t(e,e.scope.parent_scope.resolve())?void 0!==e.thedef.init?e.thedef.init=!1:a.init&&(e.thedef.init=a.init):a.defun=void 0,!0):void 0}))}),AST_Toplevel.DEFMETHOD("def_global",function(e){var n=this.globals,a=e.name;return n.has(a)?n.get(a):((e=this.make_def(e)).undeclared=!0,e.global=!0,n.set(a,e),e)}),AST_BlockScope.DEFMETHOD("init_vars",function(e,n){init_block_vars(this,e,n)}),AST_Scope.DEFMETHOD("init_vars",function(e,n){init_scope_vars(this,e,n)}),AST_Arrow.DEFMETHOD("init_vars",function(e,n){return init_scope_vars(this,e,n),this}),AST_AsyncArrow.DEFMETHOD("init_vars",function(e,n){init_scope_vars(this,e,n)}),AST_Lambda.DEFMETHOD("init_vars",function(e,n){return init_scope_vars(this,e,n),this.uses_arguments=!1,this.def_variable(new AST_SymbolFunarg({name:"arguments",scope:this,start:this.start,end:this.end})),this}),AST_Symbol.DEFMETHOD("mark_enclosed",function(e){for(var n=this.definition(),a=this.scope;a&&push_uniq(a.enclosed,n)&&(e?(e.keep_fargs&&a instanceof AST_Lambda&&a.each_argname(function(e){push_uniq(n.scope.enclosed,e.definition())}),e.keep_fnames&&a.functions.each(function(e){push_uniq(n.scope.enclosed,e)})):a._var_names=void 0,a!==n.scope);a=a.parent_scope);}),AST_Symbol.DEFMETHOD("reference",function(e){this.definition().references.push(this),this.mark_enclosed(e)}),AST_BlockScope.DEFMETHOD("find_variable",function(e){return this.variables.get(e)||this.parent_scope&&this.parent_scope.find_variable(e)}),AST_BlockScope.DEFMETHOD("def_function",function(e,n){var a=this.def_variable(e,n);return(!a.init||a.init instanceof AST_LambdaDefinition)&&(a.init=n),this.functions.set(e.name,a),a}),AST_BlockScope.DEFMETHOD("def_variable",function(e,n){var a=this.variables.get(e.name);return a?(a.orig.push(e),a.init instanceof AST_LambdaExpression&&(a.init=n)):(a=this.make_def(e,n),this.variables.set(e.name,a),a.global=!this.parent_scope),e.thedef=a}),AST_Symbol.DEFMETHOD("unmangleable",function(e){var n=this.definition();return!n||n.unmangleable(e)}),AST_Label.DEFMETHOD("unmangleable",return_false),AST_Symbol.DEFMETHOD("definition",function(){return this.thedef}),AST_Toplevel.DEFMETHOD("mangle_names",function(o){(o=_default_mangler_options(o)).cache&&o.cache.props&&(n=names_in_use(this,o),o.cache.props.each(function(e){n.set(e,!0)}));var n,r=-1,s=[],c=new TreeWalker(function(a,e){var n,t,i;if(a instanceof AST_BlockScope)return a instanceof AST_LabeledStatement&&(n=r),o.webkit&&a instanceof AST_IterationStatement&&a.init instanceof AST_Let&&a.init.definitions.forEach(function(e){e.name.match_symbol(function(e){var n,a,t;e instanceof AST_SymbolLet&&(n=e.definition(),a=e.scope.parent_scope,t=a.def_variable(e),e.thedef=n,a.to_mangle.push(t),n.redefined=function(){return t})})},!0),t=a.to_mangle=[],a.variables.each(function(e,n){e.unmangleable(o)?names_in_use(a,o).set(n,!0):function(n){var e=n.orig[0],a=n.redefined();if(!a){if(!(e instanceof AST_SymbolConst))return;var t=n.scope.resolve();if(n.scope===t)return;if(n.scope.parent_scope.find_variable(e.name))return;a=t.def_variable(e),t.to_mangle.push(a)}s.push(n),n.references.forEach(i),(e instanceof AST_SymbolCatch||e instanceof AST_SymbolConst)&&(i(e),n.redefined=function(){return a});return 1;function i(e){e.thedef=a,e.reference(o),e.thedef=n}}(e)||t.push(e)}),e(),o.cache&&a instanceof AST_Toplevel&&a.globals.each(f),a instanceof AST_Defun&&c.has_directive("use asm")&&((e=new AST_SymbolRef(a.name)).scope=a,e.reference(o)),(t=36<t.length?(e=t.map(function(e,n){return n}).sort(function(e,n){return t[n].references.length-t[e].references.length||e-n})).slice(0,36).sort(function(e,n){return e-n}).map(function(e){return t[e]}).concat(e.slice(36).sort(function(e,n){return e-n}).map(function(e){return t[e]})):t).forEach(f),!(a instanceof AST_LabeledStatement)||o.v8&&function(e){var n,a=0;for(;n=e.parent(a++);){if(n instanceof AST_Block)return n instanceof AST_Toplevel&&!o.toplevel;if(n instanceof AST_LabeledStatement)return 1}}(c)||(r=n),!0;if(a instanceof AST_Label){for(;i=base54(++r),RESERVED_WORDS[i];);return a.mangled_name=i,!0}});function f(e){o.reserved.has[e.name]||e.mangle(o)}this.walk(c),s.forEach(f)}),AST_Toplevel.DEFMETHOD("find_colliding_names",function(a){var t=a.cache&&a.cache.props,n=Object.create(RESERVED_WORDS);return a.reserved.forEach(i),this.globals.each(o),this.walk(new TreeWalker(function(e){e instanceof AST_BlockScope&&e.variables.each(o)})),n;function i(e){n[e]=!0}function o(e){var n=e.name;if(e.global&&t&&t.has(n))n=t.get(n);else if(!e.unmangleable(a))return;i(n)}}),AST_Toplevel.DEFMETHOD("expand_names",function(t){base54.reset(),base54.sort(),t=_default_mangler_options(t);var i=this.find_colliding_names(t),o=0;function n(n){var e,a;n.global&&t.cache||n.unmangleable(t)||t.reserved.has[n.name]||(e=n.redefined(),a=e?e.rename||e.name:function(){for(var e;e=base54(o++),i[e];);return e}(),n.rename=a,n.forEach(function(e){e.definition()===n&&(e.name=a)}))}this.globals.each(n),this.walk(new TreeWalker(function(e){e instanceof AST_BlockScope&&e.variables.each(n)}))}),AST_Node.DEFMETHOD("tail_node",return_this),AST_Sequence.DEFMETHOD("tail_node",function(){return this.expressions[this.expressions.length-1]}),AST_Toplevel.DEFMETHOD("compute_char_frequency",function(e){e=_default_mangler_options(e),base54.reset();var n=AST_Symbol.prototype.add_source_map;try{AST_Symbol.prototype.add_source_map=function(){this.unmangleable(e)||base54.consider(this.name,-1)},e.properties&&(AST_Dot.prototype.add_source_map=function(){base54.consider(this.property,-1)},AST_Sub.prototype.add_source_map=function(){!function e(n){n instanceof AST_String?base54.consider(n.value,-1):n instanceof AST_Conditional?(e(n.consequent),e(n.alternative)):n instanceof AST_Sequence&&e(n.tail_node())}(this.property)}),base54.consider(this.print_to_string(),1)}finally{AST_Symbol.prototype.add_source_map=n,delete AST_Dot.prototype.add_source_map,delete AST_Sub.prototype.add_source_map}base54.sort()});var base54=function(){var i=Object.create(null);function e(e){for(var n=[],a=0;a<e.length;a++){var t=e[a];n.push(t),i[t]=-.01*a}return n}var a,t,n=e("0123456789"),o=e("abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ$_");function r(){a=null,t=Object.create(i)}function s(e,n){return t[n]-t[e]}function c(e){var n=o[e%54];for(e=Math.floor(e/54);0<=--e;e>>=6)n+=a[63&e];return n}return c.consider=function(e,n){for(var a=e.length;0<=--a;)t[e[a]]+=n},c.sort=function(){a=o.sort(s).concat(n).sort(s)},(c.reset=r)(),c}();


// output
"use strict";function is_some_comments(n){return"comment2"==n.type&&/@preserve|@license|@cc_on/i.test(n.value)}function OutputStream(c){c=defaults(c,{annotations:!1,ascii_only:!1,beautify:!1,braces:!1,comments:!1,extendscript:!1,galio:!1,ie:!1,indent_level:4,indent_start:0,inline_script:!0,keep_quoted_props:!1,max_line_len:!1,preamble:null,preserve_line:!1,quote_keys:!1,quote_style:0,semicolons:!0,shebang:!0,source_map:null,v8:!1,webkit:!1,width:80,wrap_iife:!1},!0);var t,p=return_false;function n(n){if("number"==typeof n)return new Array(n+1).join(" ");if(!n)return"";if(/^\s*$/.test(n))return n;throw new Error("unsupported indentation: "+JSON.stringify(""+n))}c.comments&&("string"==typeof(t=c.comments)&&/^\/.*\/[a-zA-Z]*$/.test(c.comments)&&(B=c.comments.lastIndexOf("/"),t=new RegExp(c.comments.substr(1,B-1),c.comments.substr(B+1))),p=t instanceof RegExp?function(n){return"comment5"!=n.type&&t.test(n.value)}:"function"==typeof t?function(n){return"comment5"!=n.type&&t(this,n)}:"some"===t?is_some_comments:return_true);var r,o,s,a,u,f,e,_=0,l=1,i=n(c.indent_start),S=n(c.indent_level),R=S.length+1>>1,h=0,A=!0,T=c.source_map&&[],m=!1,d=!1,v="";function y(){u=a=!1,e=[];var n=f;return f=r="",n}y();var g=c.ascii_only?function(n,e){return(n=e?n.replace(/[\ud800-\udbff][\udc00-\udfff]/g,function(n){return"\\u{"+(n.charCodeAt(0)-55232<<10|n.charCodeAt(1)-56320).toString(16)+"}"}):n).replace(/[\u0000-\u001f\u007f-\uffff]/g,function(n){var t=n.charCodeAt(0).toString(16);if(t.length<=2&&!e){for(;t.length<2;)t="0"+t;return"\\x"+t}for(;t.length<4;)t="0"+t;return"\\u"+t})}:function(n){for(var t="",e=0,i=0;e<n.length;e++){var r=n.charCodeAt(e);if(is_surrogate_pair_head(r)){if(is_surrogate_pair_tail(n.charCodeAt(e+1))){e++;continue}}else if(!is_surrogate_pair_tail(r))continue;t+=n.slice(i,e)+"\\u"+r.toString(16),i=e+1}return 0==i?n:t+n.slice(i)};function b(n){return"'"+n.replace(/\x27/g,"\\'")+"'"}function w(n){return'"'+n.replace(/\x22/g,'\\"')+'"'}var $=[null,b,w,function(n,t){return("'"==t?b:w)(n)}][c.quote_style]||function(n,t,e,i){return(i<e?b:w)(n)};function x(e,n){var i=0,r=0;return e=e.replace(/[\\\b\f\n\r\v\t\x22\x27\u2028\u2029\0\ufeff]/g,function(n,t){switch(n){case'"':return++i,'"';case"'":return++r,"'";case"\\":return"\\\\";case"\n":return"\\n";case"\r":return"\\r";case"\t":return"\\t";case"\b":return"\\b";case"\f":return"\\f";case"\v":return c.ie?"\\x0B":"\\v";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";case"\ufeff":return"\\ufeff";case"\0":return/[0-9]/.test(e.charAt(t+1))?"\\x00":"\\0"}return n}),$(g(e),n,i,r)}var j=T?function(t,e){T.forEach(function(n){n.line+=t,n.col+=e})}:noop,E=T?function(){T.forEach(function(n){c.source_map.add(n.token.file,n.line,n.col,n.token.line,n.token.col,n.name||"name"!=n.token.type?n.name:n.token.value)}),T=[]}:noop;function C(n){v+=f.slice(0,h);var t=(f=f.slice(h)).length;for(j(n,t-_),l+=n,_=t;n--;)v+="\n"}var D=c.max_line_len?function(n){A?_>c.max_line_len&&AST_Node.warn("Output exceeds {max_line_len} characters",c):(_>c.max_line_len&&(C(1),A=!0),(A||n)&&E())}:noop,V=makePredicate("; }"),I=makePredicate("( [ + * / - , . `"),L=makePredicate("in instanceof");function k(n,t,e){return is_identifier_char(n)&&(is_identifier_char(t)||"\\"==t)||"/"==t&&t==n||("+"==t||"-"==t)&&t==r||"--"==r&&">"==t||"!"==r&&"--"==e||"/"==n&&("in"==e||"instanceof"==e)}var O=c.beautify||c.comments||c.max_line_len||c.preserve_line||c.shebang||!c.semicolons||c.source_map||c.width?function(n){var t=n.charAt(0),e=(m&&t&&(m=!1,"\n"!=t)&&(O("\n"),F()),d&&t&&(d=!1,/[\s;})]/.test(t)||P()),r.slice(-1)),i=(u&&(u=!1,";"==e||V[t]||((i=I[t]||L[n])||c.semicolons?(f+=";",_++,A||(D(),A&&!i&&";"==f&&(f="",_=0)),h==f.length-1&&h++):(D(),f+="\n",l++,_=0,/^\s+$/.test(n)&&(u=!0)),c.beautify)||(a=!1)),a&&(k(e,t,n)&&(f+=" ",_++),"<"==e&&"!"==n||(a=!1)),s&&(T.push({token:s,name:o,line:l,col:_}),s=!1,A)&&E(),f+=n,n.split(/\r?\n/)),t=i.length-1;l+=t,_+=i[0].length,0<t&&(D(),_=i[t].length),r=n}:function(n){var t=n.charAt(0),e=r.slice(-1);u&&(u=!1,":"==e&&"}"==t||(!t||";}".indexOf(t)<0)&&";"!=e)&&(f+=";",a=!1),a&&(k(e,t,n)&&(f+=" "),"<"==e&&"!"==n||(a=!1)),f+=n,r=n},P=c.beautify?function(){O(" ")}:function(){a=!0},F=c.beautify?function(n){m&&O("\n"),O(n?i.slice(0,-R):i)}:noop,U=c.beautify?function(n){var t=i;i+=S,n(),i=t}:function(n){n()},q=c.max_line_len||c.preserve_line?function(){D(),h=f.length,A=!1}:noop,G=c.beautify?function(){O("\n"),h=f.length}:q,B=c.beautify?function(){O(";")}:function(){u=!0};var H=T?function(n,t){s=n,o=t}:noop;function N(n,t){m||(!n.nlb||!t&&/(^|\n) *$/.test(f)?t&&(d=!0):m=!0)}function M(n){var t=n.value.replace(/[@#]__PURE__/g," ");return(!/^\s*$/.test(t)||/^\s*$/.test(n.value))&&(/comment[134]/.test(n.type)?(O("//"+t),m=!0):"comment2"==n.type&&O("/*"+t+"*/"),1)}return{get:function(){return A||D(!0),v+f},reset:y,indent:F,should_break:c.beautify&&c.width?function(){return _>=c.width}:return_false,has_parens:function(){return"("==r.slice(-1)},newline:G,print:O,space:P,comma:function(){q(),O(","),q(),P()},colon:function(){O(":"),P()},last:function(){return r},semicolon:B,force_semicolon:function(){u&&O(";"),O(";")},to_utf8:g,print_name:function(n){O(g(n.toString(),!0))},print_string:c.inline_script?function(n,t){n=x(n,t).replace(/<\x2f(script)([>\/\t\n\f\r ])/gi,"<\\/$1$2"),O(n.replace(/\x3c!--/g,"\\x3c!--").replace(/--\x3e/g,"--\\x3e"))}:function(n,t){O(x(n,t))},with_indent:U,with_block:function(n,t){O("{"),G(),U(n),H(t),F(),O("}")},with_parens:function(n){O("("),q(),n(),q(),O(")")},with_square:function(n){O("["),q(),n(),q(),O("]")},add_mapping:H,option:function(n){return c[n]},prepend_comments:c.comments||c.shebang?function(n){var e,i=this;n instanceof AST_Exit?e=n.value:n instanceof AST_Yield&&(e=n.expression);var r,t,o=(o=a(n))||[],s=(e&&((r=new TreeWalker(function(n){if(e=n,!((t=r.parent())instanceof AST_Binary?t.left===e:"Call"==t.TYPE?t.expression===e:t instanceof AST_Conditional?t.condition===e:t instanceof AST_Dot?t.expression===e:t instanceof AST_Exit||(t instanceof AST_Sequence?t.expressions[0]===e:t instanceof AST_Sub?t.expression===e:t instanceof AST_UnaryPostfix||t instanceof AST_Yield)))return!0;var t,e=a(n);e&&(o=o.concat(e))})).push(n),e.walk(r)),1==l&&0==_&&(0<o.length&&c.shebang&&"comment5"==o[0].type&&(O("#!"+o.shift().value+"\n"),F()),t=c.preamble)&&O(t.replace(/\r\n?|\u2028|\u2029|(^|\S)\s*$/g,"$1\n")),o=o.filter(p,n),!1);function a(n){var t=n.start;if(!t){if(!e)return;n.start=t=new AST_Token}n=t.comments_before;if(!n){if(!e)return;t.comments_before=n=[]}if(n._dumped!==i)return n._dumped=i,n}o.forEach(function(n,t){N(n,t),M(n)&&(s=!0)}),s&&N(n.start,!0)}:noop,append_comments:c.comments?function(n,e){var t=n.end;t&&(t=t[e?"comments_before":"comments_after"])&&t._dumped!==this&&(n instanceof AST_Statement||all(t,function(n){return!/comment[134]/.test(n.type)}))&&(t._dumped=this,t.filter(p,n).forEach(function(n,t){N(n,t||!e),M(n)}))}:noop,push_node:function(n){e.push(n)},pop_node:c.preserve_line?function(){var n=e.pop();n.start&&n.start.line>l&&C(n.start.line-l)}:function(){e.pop()},parent:function(n){return e[e.length-2-(n||0)]}}}!function(){function n(n,t){n.DEFMETHOD("_codegen",t)}var s=!1,t=(AST_Node.DEFMETHOD("print",function(n,t){var e=this;function i(){n.prepend_comments(e),e.add_source_map(n),e._codegen(n),n.append_comments(e)}n.push_node(e),t||e.needs_parens(n)?n.with_parens(i):i(),n.pop_node()}),OutputStream({inline_script:!1,shebang:!1,width:!1}));function e(n,t){n.DEFMETHOD("needs_parens",t)}function i(n){var t=n.parent();return!n.has_parens()&&first_in_statement(n,!1,!0)?this.name||!(t instanceof AST_ExportDefault):!!(n.option("webkit")&&t instanceof AST_PropAccess&&t.expression===this)||!!(n.option("wrap_iife")&&t instanceof AST_Call&&t.expression===this)||void 0}function r(n){return!n.has_parens()&&first_in_statement(n,!0)}function o(n){n=n.parent();return n instanceof AST_Binary?"**"==n.operator&&n.left===this:n instanceof AST_Call?n.expression===this:n instanceof AST_Class||(n instanceof AST_PropAccess?n.expression===this:n instanceof AST_Template?n.tag===this:void 0)}function a(n,t){return!!n.terminal&&(t instanceof AST_Call||t instanceof AST_PropAccess)&&t.expression===n}function c(n,t){t=t.parent();return t instanceof AST_Await||(t instanceof AST_Binary?!(t instanceof AST_Assign):t instanceof AST_Call?t.expression===n:t instanceof AST_Class||(t instanceof AST_Conditional?t.condition===n:t instanceof AST_PropAccess?t.expression===n:t instanceof AST_Template?t.tag===n:t instanceof AST_Unary||void 0))}function p(n,e,i,t){var r=n.length-1,o=t,t=s;n.forEach(function(n,t){o&&(n instanceof AST_Directive?"use asm"==n.value&&(s=!0):n instanceof AST_EmptyStatement||(n instanceof AST_SimpleStatement&&n.body instanceof AST_String&&i.force_semicolon(),o=!1)),n instanceof AST_EmptyStatement||(i.indent(),n.print(i),t==r&&e)||(i.newline(),e&&i.newline())}),s=t}function u(n,t){t.print("{"),t.with_indent(function(){t.append_comments(n,!0)}),t.print("}")}function f(n,t,e){0<n.body.length?t.with_block(function(){p(n.body,!1,t,e)},n.end):u(n,t)}function _(e,i){return function(n){var t=this;n.print(e),n.space(),n.with_parens(function(){t.init.print(n),n.space(),n.print(i),n.space(),t.object.print(n)}),P(t.body,n)}}function l(n,t){var e=n.value;"*"==e||is_identifier_string(e)?t.print_name(e):t.print_string(e,n.quote)}function S(n,e){e.with_parens(function(){n.argnames.forEach(function(n,t){t&&e.comma(),n.print(e)}),n.rest&&(n.argnames.length&&e.comma(),e.print("..."),n.rest.print(e))})}function h(n,t){var e=1==n.argnames.length&&!n.rest&&n.argnames[0];e instanceof AST_SymbolFunarg&&"yield"!=e.name?e.print(t):S(n,t),t.space(),t.print("=>"),t.space(),n.value?n.value.print(t):f(n,t,!0)}function A(n,t){n.name&&(t.space(),n.name.print(t)),S(n,t),t.space(),f(n,t,!0)}function T(n){n.print("async"),n.space(),n.print("function"),A(this,n)}function m(n){n.print("async"),n.space(),n.print("function*"),A(this,n)}function d(n){n.print("function*"),A(this,n)}function v(n,t){var e=n.value;is_async(e)&&(t.print("async"),t.space()),is_generator(e)&&t.print("*"),D(n,t),A(n.value,t)}function y(e,i){return function(n){n.print(e);var t=this[i];t&&(n.space(),t.print(n)),n.semicolon()}}function g(n,t){t.newline(),n.body.forEach(function(n){t.indent(),n.print(t),t.newline()})}function b(t){return function(e){e.print(t),e.space(),this.definitions.forEach(function(n,t){t&&e.comma(),n.print(e)});var n=e.parent();n instanceof AST_IterationStatement&&n.init===this||e.semicolon()}}function w(n,t,e){var i=!1;e&&n.walk(new TreeWalker(function(n){return!!i||(n instanceof AST_Binary&&"in"==n.operator?i=!0:n instanceof AST_Scope&&(!is_arrow(n)||!n.value)||void 0)})),n.print(t,i)}function x(n,t){if(t.option("annotations")&&n.pure){var e,i=0,r=n;do{if(e=r,(r=t.parent(i++))instanceof AST_Call&&r.expression===e)return}while(r instanceof AST_PropAccess&&r.expression===e);t.print("/*@__PURE__*/")}}function E(n,e){e.with_parens(function(){n.args.forEach(function(n,t){t&&e.comma(),n.print(e)}),e.add_mapping(n.end)})}function C(n,e,i){var t=n.properties;0<t.length?e.with_block(function(){t.forEach(function(n,t){t&&(i||e.print(","),e.newline()),e.indent(),n.print(e)}),e.newline()},n.end):u(n,e)}function D(n,t){var e=n.key;if(e instanceof AST_Node)return t.with_square(function(){e.print(t)});var i=n.start&&n.start.quote;if(t.option("quote_keys")||i&&t.option("keep_quoted_props"))t.print_string(e,i);else if(""+ +e==e&&0<=e)t.print(q(e));else if(n.private)t.print_name(e);else{if(RESERVED_WORDS[e]?!t.option("ie"):is_identifier_string(e))return t.print_name(e),e;t.print_string(e,i)}}function k(t){return function(n){this.static&&(n.print("static"),n.space()),n.print(t),n.space(),D(this,n),A(this.value,n)}}function O(n){var t=n.definition();return t&&t.mangled_name||n.name}function P(n,t){t.option("braces")&&!(n instanceof AST_Const||n instanceof AST_Let)?B(n,t):n instanceof AST_EmptyStatement?t.force_semicolon():(t.space(),n.print(t))}function F(n,t){return 0<n.args.length||t.option("beautify")}function q(n){for(var t,e,i=n.toString(10).replace(/^0\./,".").replace("e+","e"),r=[i],o=(Math.floor(n)===n&&r.push(n<0?"-0x"+(-n).toString(16).toLowerCase():"0x"+n.toString(16).toLowerCase()),(n=/^\.0+/.exec(i))?(t=n[0].length,e=i.slice(t),r.push(e+"e-"+(e.length+t-1))):(n=/[^0]0+$/.exec(i))?(t=n[0].length-1,r.push(i.slice(0,-t)+"e"+t)):(n=/^(\d)\.(\d+)e(-?\d+)$/.exec(i))&&r.push(n[1]+n[2]+"e"+(n[3]-n[2].length)),r),s=o[0],a=s.length,c=1;c<o.length;++c)o[c].length<a&&(a=(s=o[c]).length);return s}function B(n,t){t.space(),n instanceof AST_EmptyStatement?u(n,t):n instanceof AST_BlockStatement?n.print(t):t.with_block(function(){t.indent(),n.print(t),t.newline()},n.end)}function N(n,t){n.forEach(function(n){n.DEFMETHOD("add_source_map",t)})}AST_Node.DEFMETHOD("print_to_string",function(n){return n?(n=OutputStream(n),this.print(n),n.get()):(this.print(t),t.reset())}),e(AST_Node,return_false),e(AST_AsyncFunction,i),e(AST_AsyncGeneratorFunction,i),e(AST_ClassExpression,i),e(AST_Function,i),e(AST_GeneratorFunction,i),e(AST_Object,r),e(AST_Await,o),e(AST_Unary,o),e(AST_Sequence,function(n){n=n.parent();return n instanceof AST_Array||is_arrow(n)&&n.value===this||n instanceof AST_Await||n instanceof AST_Binary||n instanceof AST_Call||n instanceof AST_Class||n instanceof AST_ClassProperty||n instanceof AST_Conditional||n instanceof AST_DefaultValue||n instanceof AST_DestructuredKeyVal||n instanceof AST_ExportDefault||n instanceof AST_ForOf||n instanceof AST_ObjectProperty||n instanceof AST_PropAccess&&n.expression===this||n instanceof AST_Spread||n instanceof AST_Template&&n.tag===this||n instanceof AST_Unary||n instanceof AST_VarDef||n instanceof AST_Yield}),e(AST_Binary,function(n){var t,e,i,r,n=n.parent();return n instanceof AST_Await||(n instanceof AST_Binary?(t=n.operator,e=PRECEDENCE[t],i=this.operator,(r=PRECEDENCE[i])<e||"??"==t&&("&&"==i||"||"==i)||e==r&&this===n["**"==t?"left":"right"]):n instanceof AST_Call?n.expression===this:n instanceof AST_Class||(n instanceof AST_PropAccess?n.expression===this:n instanceof AST_Template?n.tag===this:n instanceof AST_Unary||void 0))}),e(AST_PropAccess,function(n){n=n.parent();return n instanceof AST_New&&n.expression===this&&"Call"==root_expr(this).TYPE||a(this,n)}),e(AST_Call,function(n){var t=n.parent();if(t instanceof AST_New)return t.expression===this;if(n.option("webkit")&&this.expression instanceof AST_Function&&t instanceof AST_PropAccess&&t.expression===this){n=n.parent(1);if(n instanceof AST_Assign&&n.left===t)return!0}return a(this,t)}),e(AST_New,function(n){return!F(this,n)&&((n=n.parent())instanceof AST_Call?n.expression===this:n instanceof AST_PropAccess||(n instanceof AST_Template?n.tag===this:void 0))}),e(AST_Number,function(n){return!!n.option("galio")&&(n=n.parent())instanceof AST_PropAccess&&n.expression===this&&/^0/.test(q(this.value))}),e(AST_Arrow,function(n){return c(this,n)}),e(AST_Assign,function(n){return!!c(this,n)||(n.option("v8")?this.left instanceof AST_Destructured:this.left instanceof AST_DestructuredObject?r(n):void 0)}),e(AST_AsyncArrow,function(n){return c(this,n)}),e(AST_Conditional,function(n){return c(this,n)||n.option("extendscript")&&n.parent()instanceof AST_Conditional}),e(AST_Yield,function(n){return c(this,n)}),n(AST_Directive,function(n){var t=this.quote,e=this.value;switch(n.option("quote_style")){case 0:case 2:-1==e.indexOf('"')&&(t='"');break;case 1:-1==e.indexOf("'")&&(t="'")}n.print(t+e+t),n.semicolon()}),n(AST_Debugger,function(n){n.print("debugger"),n.semicolon()}),n(AST_Toplevel,function(n){p(this.body,!0,n,!0),n.print("")}),n(AST_LabeledStatement,function(n){this.label.print(n),n.colon();var t=this.body;t instanceof AST_EmptyStatement?n.force_semicolon():t.print(n)}),n(AST_SimpleStatement,function(n){this.body.print(n),n.semicolon()}),n(AST_BlockStatement,function(n){f(this,n)}),n(AST_EmptyStatement,function(n){n.semicolon()}),n(AST_Do,function(n){var t=this;n.print("do"),B(t.body,n),n.space(),n.print("while"),n.space(),n.with_parens(function(){t.condition.print(n)}),n.semicolon()}),n(AST_While,function(n){var t=this;n.print("while"),n.space(),n.with_parens(function(){t.condition.print(n)}),P(t.body,n)}),n(AST_For,function(n){var t=this;n.print("for"),n.space(),n.with_parens(function(){t.init?(t.init instanceof AST_Definitions?t.init.print(n):w(t.init,n,!0),n.print(";"),n.space()):n.print(";"),t.condition?(t.condition.print(n),n.print(";"),n.space()):n.print(";"),t.step&&t.step.print(n)}),P(t.body,n)}),n(AST_ForAwaitOf,_("for await","of")),n(AST_ForIn,_("for","in")),n(AST_ForOf,_("for","of")),n(AST_With,function(n){var t=this;n.print("with"),n.space(),n.with_parens(function(){t.expression.print(n)}),P(t.body,n)}),n(AST_ExportDeclaration,function(n){n.print("export"),n.space(),this.body.print(n)}),n(AST_ExportDefault,function(n){n.print("export"),n.space(),n.print("default"),n.space();var t=this.body;t.print(n),t instanceof AST_ClassExpression&&!t.name||t instanceof AST_DefClass||t instanceof AST_LambdaDefinition||t instanceof AST_LambdaExpression&&!t.name&&!is_arrow(t)||n.semicolon()}),n(AST_ExportForeign,function(e){var i=this,t=(e.print("export"),e.space(),i.keys.length);function r(n){var t=i.aliases[n],n=i.keys[n];l(n,e),t.value!=n.value&&(e.space(),e.print("as"),e.space(),l(t,e))}0==t?u(i,e):"*"==i.keys[0].value?r(0):e.with_block(function(){e.indent(),r(0);for(var n=1;n<t;n++)e.print(","),e.newline(),e.indent(),r(n);e.newline()},i.end),e.space(),e.print("from"),e.space(),i.path.print(e),e.semicolon()}),n(AST_ExportReferences,function(n){n.print("export"),n.space(),C(this,n),n.semicolon()}),n(AST_Import,function(n){var t=this;n.print("import"),n.space(),t.default&&t.default.print(n),t.all&&(t.default&&n.comma(),t.all.print(n)),t.properties&&(t.default&&n.comma(),C(t,n)),(t.all||t.default||t.properties)&&(n.space(),n.print("from"),n.space()),t.path.print(n),n.semicolon()}),n(AST_Arrow,function(n){h(this,n)}),n(AST_AsyncArrow,function(n){n.print("async"),n.space(),h(this,n)}),n(AST_Lambda,function(n){n.print("function"),A(this,n)}),n(AST_AsyncDefun,T),n(AST_AsyncFunction,T),n(AST_AsyncGeneratorDefun,m),n(AST_AsyncGeneratorFunction,m),n(AST_GeneratorDefun,d),n(AST_GeneratorFunction,d),n(AST_Class,function(n){var t=this;n.print("class"),t.name&&(n.space(),t.name.print(n)),t.extends&&(n.space(),n.print("extends"),n.space(),t.extends.print(n)),n.space(),C(t,n,!0)}),n(AST_ClassField,function(n){var t=this;if(t.static&&(n.print("static"),n.space()),D(t,n),t.value)n.space(),n.print("="),n.space(),t.value.print(n);else switch(t.key){case"get":case"set":case"static":return void n.force_semicolon()}n.semicolon()}),n(AST_ClassGetter,k("get")),n(AST_ClassSetter,k("set")),n(AST_ClassMethod,function(n){this.static&&(n.print("static"),n.space()),v(this,n)}),n(AST_ClassInit,function(n){n.print("static"),n.space(),f(this.value,n)}),n(AST_Return,y("return","value")),n(AST_Throw,y("throw","value")),n(AST_Break,y("break","label")),n(AST_Continue,y("continue","label")),n(AST_If,function(n){var t=this;n.print("if"),n.space(),n.with_parens(function(){t.condition.print(n)}),t.alternative?(function(n,t){var e=n.body;if(t.option("braces")&&!(e instanceof AST_Const||e instanceof AST_Let)||t.option("ie")&&e instanceof AST_Do)return B(e,t);if(!e)return t.force_semicolon();for(;;)if(e instanceof AST_If){if(!e.alternative)return B(n.body,t);e=e.alternative}else{if(!(e instanceof AST_StatementWithBody))break;e=e.body}P(n.body,t)}(t,n),n.space(),n.print("else"),t.alternative instanceof AST_If?(n.space(),t.alternative.print(n)):P(t.alternative,n)):P(t.body,n)}),n(AST_Switch,function(e){var n=this,i=(e.print("switch"),e.space(),e.with_parens(function(){n.expression.print(e)}),e.space(),n.body.length-1);i<0?u(n,e):e.with_block(function(){n.body.forEach(function(n,t){e.indent(!0),n.print(e),t<i&&0<n.body.length&&e.newline()})},n.end)}),n(AST_Default,function(n){n.print("default:"),g(this,n)}),n(AST_Case,function(n){n.print("case"),n.space(),this.expression.print(n),n.print(":"),g(this,n)}),n(AST_Try,function(n){var t=this;n.print("try"),n.space(),f(t,n),t.bcatch&&(n.space(),t.bcatch.print(n)),t.bfinally&&(n.space(),t.bfinally.print(n))}),n(AST_Catch,function(n){var t=this;n.print("catch"),t.argname&&(n.space(),n.with_parens(function(){t.argname.print(n)})),n.space(),f(t,n)}),n(AST_Finally,function(n){n.print("finally"),n.space(),f(this,n)}),n(AST_Const,b("const")),n(AST_Let,b("let")),n(AST_Var,b("var")),n(AST_VarDef,function(n){var t;this.name.print(n),this.value&&(n.space(),n.print("="),n.space(),t=(t=n.parent(1))instanceof AST_For||t instanceof AST_ForEnumeration,w(this.value,n,t))}),n(AST_DefaultValue,function(n){this.name.print(n),n.space(),n.print("="),n.space(),this.value.print(n)}),n(AST_Call,function(n){x(this,n),this.expression.print(n),this.optional&&n.print("?."),E(this,n)}),n(AST_New,function(n){x(this,n),n.print("new"),n.space(),this.expression.print(n),F(this,n)&&E(this,n)}),n(AST_Sequence,function(e){this.expressions.forEach(function(n,t){0<t&&(e.comma(),e.should_break())&&(e.newline(),e.indent()),n.print(e)})}),n(AST_Dot,function(n){var t=this,e=t.expression,i=(e.print(n),t.property);n.option("ie")&&RESERVED_WORDS[i]||t.quoted&&n.option("keep_quoted_props")?(t.optional&&n.print("?."),n.with_square(function(){n.add_mapping(t.end),n.print_string(i)})):(e instanceof AST_Number&&!/[ex.)]/i.test(n.last())&&n.print("."),n.print(t.optional?"?.":"."),n.add_mapping(t.end),n.print_name(i))}),n(AST_Sub,function(n){var t=this;t.expression.print(n),t.optional&&n.print("?."),n.with_square(function(){t.property.print(n)})}),n(AST_Spread,function(n){n.print("..."),this.expression.print(n)}),n(AST_UnaryPrefix,function(n){var t=this.operator,e=this.expression;n.print(t),(/^[a-z]/i.test(t)||/[+-]$/.test(t)&&e instanceof AST_UnaryPrefix&&/^[+-]/.test(e.operator))&&n.space(),e.print(n)}),n(AST_UnaryPostfix,function(n){this.expression.print(n),n.add_mapping(this.end),n.print(this.operator)}),n(AST_Binary,function(n){this.left.print(n),n.space(),n.print(this.operator),n.space(),this.right.print(n)}),n(AST_Conditional,function(n){this.condition.print(n),n.space(),n.print("?"),n.space(),this.consequent.print(n),n.space(),n.colon(),this.alternative.print(n)}),n(AST_Await,function(n){n.print("await"),n.space(),this.expression.print(n)}),n(AST_Yield,function(n){n.print(this.nested?"yield*":"yield"),this.expression&&(n.space(),this.expression.print(n))}),n(AST_Array,function(e){var n=this.elements,i=n.length;e.with_square(0<i?function(){e.space(),n.forEach(function(n,t){t&&e.comma(),n.print(e),t===i-1&&n instanceof AST_Hole&&e.comma()}),e.space()}:noop)}),n(AST_DestructuredArray,function(e){var n=this.elements,t=n.length,i=this.rest;e.with_square(t||i?function(){e.space(),n.forEach(function(n,t){t&&e.comma(),n.print(e)}),i?(t&&e.comma(),e.print("..."),i.print(e)):n[t-1]instanceof AST_Hole&&e.comma(),e.space()}:noop)}),n(AST_DestructuredKeyVal,function(n){var t=D(this,n),e=this.value;if(t)if(e instanceof AST_DefaultValue){if(e.name instanceof AST_Symbol&&t==O(e.name))return n.space(),n.print("="),n.space(),void e.value.print(n)}else if(e instanceof AST_Symbol&&t==O(e))return;n.colon(),e.print(n)}),n(AST_DestructuredObject,function(e){var n=this.properties,t=n.length,i=this.rest;t||i?e.with_block(function(){n.forEach(function(n,t){t&&(e.print(","),e.newline()),e.indent(),n.print(e)}),i&&(t&&(e.print(","),e.newline()),e.indent(),e.print("..."),i.print(e)),e.newline()},this.end):u(this,e)}),n(AST_Object,function(n){C(this,n)}),n(AST_ObjectKeyVal,function(n){D(this,n),n.colon(),this.value.print(n)}),n(AST_ObjectMethod,function(n){v(this,n)}),n(AST_ObjectGetter,k("get")),n(AST_ObjectSetter,k("set")),n(AST_Symbol,function(n){n.print_name(O(this))}),n(AST_SymbolExport,function(n){var t=O(this),e=(n.print_name(t),this.alias);e.value!=t&&(n.space(),n.print("as"),n.space(),l(e,n))}),n(AST_SymbolImport,function(n){var t=O(this),e=this.key;e.value&&e.value!=t&&(l(e,n),n.space(),n.print("as"),n.space()),n.print_name(t)}),n(AST_Hole,noop),n(AST_Template,function(n){var t=this;t.tag&&t.tag.print(n),n.print("`");for(var e=0;e<t.expressions.length;e++)n.print(t.strings[e]),n.print("${"),t.expressions[e].print(n),n.print("}");n.print(t.strings[e]),n.print("`")}),n(AST_BigInt,function(n){n.print(this.value+"n")}),n(AST_Constant,function(n){n.print(""+this.value)}),n(AST_String,function(n){n.print_string(this.value,this.quote)}),n(AST_Number,function(n){var t=this.start;s&&t&&null!=t.raw?n.print(t.raw):n.print(q(this.value))}),n(AST_RegExp,function(n){var t=this.value,e=t.toString(),i=e.lastIndexOf("/");t.raw_source?e="/"+t.raw_source+e.slice(i):1==i?e="/(?:)"+e.slice(i):e.indexOf("/",1)<i&&(e="/"+e.slice(1,i).replace(/\\\\|[^/]?\//g,function(n){return"\\"==n[0]?n:n.slice(0,-1)+"\\/"})+e.slice(i)),n.print(n.to_utf8(e).replace(/\\(?:\0(?![0-9])|[^\0])/g,function(n){switch(n[1]){case"\n":return"\\n";case"\r":return"\\r";case"\t":return"\t";case"\b":return"\b";case"\f":return"\f";case"\0":return"\0";case"\v":return"\v";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:return n}}).replace(/[\n\r\u2028\u2029]/g,function(n){switch(n){case"\n":return"\\n";case"\r":return"\\r";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029"}}))}),N([AST_Node,AST_LabeledStatement],noop),N([AST_Array,AST_Await,AST_BlockStatement,AST_Catch,AST_Constant,AST_Debugger,AST_Definitions,AST_Destructured,AST_Directive,AST_Finally,AST_Jump,AST_Lambda,AST_New,AST_Object,AST_Spread,AST_StatementWithBody,AST_Symbol,AST_Switch,AST_SwitchBranch,AST_Try,AST_UnaryPrefix,AST_Yield],function(n){n.add_mapping(this.start)}),N([AST_ClassProperty,AST_DestructuredKeyVal,AST_ObjectProperty],function(n){"string"==typeof this.key&&n.add_mapping(this.start,this.key)})}();


// compress
"use strict";function Compressor(e,n){if(!(this instanceof Compressor))return new Compressor(e,n);TreeTransformer.call(this,this.before,this.after),this.options=defaults(e,{annotations:!n,arguments:!n,arrows:!n,assignments:!n,awaits:!n,booleans:!n,collapse_vars:!n,comparisons:!n,conditionals:!n,dead_code:!n,default_values:!n,directives:!n,drop_console:!1,drop_debugger:!n,evaluate:!n,expression:!1,functions:!n,global_defs:!1,hoist_exports:!n,hoist_funs:!1,hoist_props:!n,hoist_vars:!1,ie:!1,if_return:!n,imports:!n,inline:!n,join_vars:!n,keep_fargs:n,keep_fnames:!1,keep_infinity:!1,loops:!n,merge_vars:!n,module:!1,negate_iife:!n,objects:!n,optional_chains:!n,passes:1,properties:!n,pure_funcs:null,pure_getters:!n&&"strict",reduce_funcs:!n,reduce_vars:!n,rests:!n,sequences:!n,side_effects:!n,spreads:!n,strings:!n,switches:!n,templates:!n,top_retain:null,toplevel:!(!e||e.expression||!e.top_retain),typeofs:!n,unsafe:!1,unsafe_comps:!1,unsafe_Function:!1,unsafe_math:!1,unsafe_proto:!1,unsafe_regexp:!1,unsafe_undefined:!1,unused:!n,varify:!n,webkit:!1,yields:!n},!0);var e=this.options.evaluate,t=(this.eval_threshold=/eager/.test(e)?1/0:+e,this.options.global_defs);if("object"==typeof t)for(var i in t)/^@/.test(i)&&HOP(t,i)&&(t[i.slice(1)]=parse(t[i],{expression:!0}));!0===this.options.inline&&(this.options.inline=4),this.drop_fargs=this.options.keep_fargs?return_false:function(e,n){var t;return!e.length_read&&((t=e.name)?t.fixed_value()===e&&!(t=t.definition()).direct_access&&(t=t.escaped)&&1!=t.depth:n&&"Call"==n.TYPE&&n.expression===e)},this.options.module&&(this.directives["use strict"]=!0);var r=this.options.pure_funcs,n=("function"==typeof r?this.pure_funcs=r:"string"==typeof r?this.pure_funcs=function(e){var n;return e instanceof AST_Call?n=e.expression:e instanceof AST_Template&&(n=e.tag),!(n&&r===n.print_to_string())}:Array.isArray(r)?this.pure_funcs=function(e){var n;return e instanceof AST_Call?n=e.expression:e instanceof AST_Template&&(n=e.tag),!(n&&member(n.print_to_string(),r))}:this.pure_funcs=return_true,this.options.sequences),o=(this.sequences_limit=1==n?800:0|n,this.options.top_retain),e=(o instanceof RegExp?this.top_retain=function(e){return o.test(e.name)}:"function"==typeof o?this.top_retain=o:o&&("string"==typeof o&&(o=o.split(/,/)),this.top_retain=function(e){return member(e.name,o)}),this.options.toplevel);this.toplevel="string"==typeof e?{funcs:/funcs/.test(e),vars:/vars/.test(e)}:{funcs:e,vars:e}}Compressor.prototype=new TreeTransformer(function(e,n){var t,i;return e._squeezed?e:((t=e instanceof AST_Scope)&&(this.option("arrows")&&is_arrow(e)&&e.value&&(e.body=[e.first_statement()],e.value=null),e.hoist_properties(this),e.hoist_declarations(this),e.process_returns(this)),n(e,this),n(e,this),i=e.optimize(this),!t||i!==e||this.has_directive("use asm")||i.pinned()||(i.drop_unused(this),i.merge_variables(this)&&i.drop_unused(this),n(i,this)),i===e&&(i._squeezed=!0),i)}),Compressor.prototype.option=function(e){return this.options[e]},Compressor.prototype.exposed=function(e){var n;return!!e.exported||!!e.undeclared||!!(e.global||e.scope.resolve()instanceof AST_Toplevel)&&(n=this.toplevel,!all(e.orig,function(e){return n[e instanceof AST_SymbolDefun?"funcs":"vars"]}))},Compressor.prototype.compress=function(e){(e=e.resolve_defines(this)).hoist_exports(this),this.option("expression")&&e.process_expression(!0);for(var n=this.options.merge_vars,t=+this.options.passes||1,i=1/0,r=!1,o={ie:this.option("ie")},a=0;a<t;a++)if(e.figure_out_scope(o),(0<a||this.option("reduce_vars"))&&e.reset_opt_flags(this),this.options.merge_vars=n&&(r||a==t-1),e=e.transform(this),1<t){var s=0;if(e.walk(new TreeWalker(function(){s++})),AST_Node.info("pass {pass}: last_count: {min_count}, count: {count}",{pass:a,min_count:i,count:s}),s<i)i=s,r=!1;else{if(r)break;r=!0}}return this.option("expression")&&e.process_expression(!1),e},function(e){function u(e,n){var t,i=n.get_property();if(!(i instanceof AST_Node)){if(e instanceof AST_Array){n=e.elements;if("length"==i)return Z(n.length,e);"number"==typeof i&&i in n&&(t=n[i])}else if(e instanceof AST_Lambda){if("length"==i)return e.length_read=!0,Z(e.argnames.length,e)}else if(e instanceof AST_Object)for(var i=""+i,r=e.properties,o=r.length;0<=--o;){if(!st(r[o]))return;t||r[o].key!==i||(t=r[o].value)}return t instanceof AST_SymbolRef&&t.fixed_value()||t}}function ye(e,n,t,i,r,o,a){var s=n.parent(r);if(!(e.option("unsafe")&&s instanceof AST_Dot&&(f=i,l=s.property,f instanceof AST_Boolean?T.Boolean[l]:f instanceof AST_Number?T.Number[l]:f instanceof AST_String?T.String[l]:"valueOf"!=l&&(f instanceof AST_Array?T.Array[l]:f instanceof AST_Lambda?T.Function[l]:f instanceof AST_Object?T.Object[l]:f instanceof AST_RegExp&&T.RegExp[l]&&!f.value.global)))){var f,c,l=is_lhs(t,s);if(l)return l;if(0!=r||!i||!i.is_constant()){if(s instanceof AST_Array)return ye(e,n,s,s,r+1);if(s instanceof AST_Assign)switch(s.operator){case"=":return ye(e,n,s,i,r+1,o,a);case"&&=":case"||=":case"??=":return ye(e,n,s,s,r+1);default:return}return s instanceof AST_Binary?Ne[s.operator]?ye(e,n,s,s,r+1):void 0:s instanceof AST_Call?!o&&s.expression===t&&!s.is_expr_pure(e)&&(!(i instanceof AST_LambdaExpression)||!(s instanceof AST_New)&&i.contains_this()):s instanceof AST_Conditional?s.condition===t?void 0:ye(e,n,s,s,r+1):s instanceof AST_ForEnumeration?s.init===t:s instanceof AST_ObjectKeyVal?s.value!==t?void 0:(f=n.parent(r+1),ye(e,n,f,f,r+2)):s instanceof AST_PropAccess?s.expression!==t?void 0:(c=u(i,s),(!o||a)&&ye(e,n,s,c,r+1)):s instanceof AST_Sequence&&s.tail_node()===t?ye(e,n,s,i,r+1,o,a):void 0}}}function w(e){return e instanceof AST_Class||e instanceof AST_Lambda}function Re(e){return e instanceof AST_Class||e instanceof AST_Defun||e instanceof AST_Function}function ge(e){return"arguments"==e.name&&e.scope.uses_arguments}function b(e,n){do{if(e===n)return;if(n instanceof AST_Scope)return 1}while(n=n.parent_scope)}function be(e,n,t){var i=e.redef||e.definition();return(!e.in_arg||!is_funarg(i))&&all(i.orig,function(e){return e instanceof AST_SymbolConst||e instanceof AST_SymbolLet?e instanceof AST_SymbolImport||n&&qn(n,e):!(t&&e instanceof AST_SymbolLambda)})}function Oe(e,n,t,i){return i instanceof AST_Assign?"="==i.operator&&i.right===t:i instanceof AST_Call?i.expression!==t||i instanceof AST_New:i instanceof AST_ClassField?i.value===t&&!i.static:i instanceof AST_Exit?i.value===t&&n.resolve()!==e.scope.resolve():i instanceof AST_VarDef&&i.value===t}function m(e,n){var t=ke(AST_SymbolRef,e);return t.fixed=n||ke(AST_Undefined,e),t}function v(t,i){return function(e){var n=t(e),e=m(n,i),n=n.definition();return n.references.push(e),n.replaced++,e}}e(AST_Node,function(e){return e}),AST_Toplevel.DEFMETHOD("hoist_exports",function(e){if(e.option("hoist_exports")){for(var n=this.body,t=[],i=0;i<n.length;i++){var r=n[i];r instanceof AST_ExportDeclaration?(n[i]=r=r.body,r instanceof AST_Definitions?r.definitions.forEach(function(e){e.name.match_symbol(o,!0)}):o(r.name)):r instanceof AST_ExportReferences&&(n.splice(i--,1),[].push.apply(t,r.properties))}t.length&&n.push(ke(AST_ExportReferences,this,{properties:t}))}function o(e){e instanceof AST_SymbolDeclaration&&((e=ke(AST_SymbolExport,e)).alias=ke(AST_String,e,{value:e.name}),t.push(e))}}),AST_Scope.DEFMETHOD("process_expression",function(r,o){var a=this,s=new TreeTransformer(function(e){var n;if(r){if((e=e instanceof AST_Directive?ke(AST_SimpleStatement,e,{body:ke(AST_String,e)}):e)instanceof AST_SimpleStatement)return o?o(e):ke(AST_Return,e,{value:e.body})}else if(e instanceof AST_Return)return o?o(e):(n=e.value)instanceof AST_String?ke(AST_Directive,n):ke(AST_SimpleStatement,e,{body:n||ke(AST_UnaryPrefix,e,{operator:"void",expression:ke(AST_Number,e,{value:0})})});if(e instanceof AST_Block){if(e instanceof AST_Lambda){if(e!==a)return e}else if("awaits"===r&&e instanceof AST_Try&&e.bfinally)return e;for(var t=e.body.length;0<=--t;){var i=e.body[t];if(!F(i,!0)){e.body[t]=i.transform(s);break}}}else e instanceof AST_If?(e.body=e.body.transform(s),e.alternative&&(e.alternative=e.alternative.transform(s))):e instanceof AST_With&&(e.body=e.body.transform(s));return e});a.transform(s)}),AST_Toplevel.DEFMETHOD("unwrap_expression",function(){var e=this;switch(e.body.length){case 0:return ke(AST_UnaryPrefix,e,{operator:"void",expression:ke(AST_Number,e,{value:0})});case 1:var n=e.body[0];if(n instanceof AST_Directive)return ke(AST_String,n);if(n instanceof AST_SimpleStatement)return n.body;default:return ke(AST_Call,e,{expression:ke(AST_Function,e,{argnames:[],body:e.body}).init_vars(e,e),args:[]})}}),AST_Node.DEFMETHOD("wrap_expression",function(){var e=this;return e=(e=is_statement(e)?e:ke(AST_SimpleStatement,e,{body:e}))instanceof AST_Toplevel?e:ke(AST_Toplevel,e,{body:[e]})});var y=/^(0|[1-9][0-9]*)$/;function o(e,n,t){t.assignments=0,t.bool_return=0,t.cross_loop=!1,t.direct_access=!1,t.drop_return=0,t.escaped=[],t.first_decl=null,t.fixed=!t.const_redefs&&!t.scope.pinned()&&!n.exposed(t)&&!(t.init instanceof AST_LambdaExpression&&t.init!==t.scope)&&t.init,t.reassigned=0,t.recursive_refs=0,t.references=[],t.single_use=void 0}function a(e,n,t){t.variables.each(function(e){o(0,n,e)})}function g(t,i,r){r.fn_defs=[],r.variables.each(function(e){o(0,i,e);var n=e.init;n instanceof AST_LambdaDefinition&&(r.fn_defs.push(n),n.safe_ids=null),null===e.fixed?(e.safe_ids=t.safe_ids,d(t,e)):e.fixed&&(t.loop_ids[e.id]=t.in_loop,d(t,e))}),r.may_call_this=function(){r.may_call_this=r.contains_this()?return_true:return_false},r.uses_arguments&&r.each_argname(function(e){e.definition().last_ref=!1}),i.option("ie")&&r.variables.each(function(e){var n=e.orig[0].definition();n!==e&&(n.fixed=!1)})}function s(e,n){n=n.safe_ids;return void 0===n||n===e.safe_ids}function c(e,n){var t=e.fn_scanning;(e.fn_scanning=n).walk(e),e.fn_scanning=t}function l(t,i){i.enclosed.forEach(function(e){var n;i.variables.get(e.name)===e||R(t,e)||(e.single_use=!1,(n="function"==typeof(n=e.fixed)?n():n)instanceof AST_Lambda&&void 0!==n.safe_ids)||(e.fixed=!1)})}function x(e,n,t){var i,r=t.safe_ids;void 0!==r&&!1!==r&&(t.parent_scope.resolve().may_call_this===return_true?member(t,e.fn_visited)&&l(e,t):r?(i=member(t,e.fn_visited),r===e.safe_ids?i||c(e,t):i?l(e,t):t.safe_ids=!1):e.fn_scanning&&e.fn_scanning!==n.scope.resolve()?t.safe_ids=!1:(t.safe_ids=e.safe_ids,c(e,t)))}function k(n,e){p(n);var t=e.fn_defs;t.forEach(function(e){e.safe_ids=n.safe_ids,c(n,e)}),t.forEach(function(e){e.safe_ids=void 0}),e.fn_defs=void 0,e.may_call_this=void 0}function S(e,n){var t=Object.create(e.defined_ids),i=Object.create(e.safe_ids);n||(t.seq={},i.seq={}),e.defined_ids=t,e.safe_ids=i}function p(e){e.defined_ids=Object.getPrototypeOf(e.defined_ids),e.safe_ids=Object.getPrototypeOf(e.safe_ids)}function r(e,n){e.defined_ids[n.id]=e.defined_ids.seq}function D(e,n){e.assigned_ids[n.id]=e.defined_ids.seq,e.defined_ids[n.id]=!1}function d(e,n){e.safe_ids[n.id]={}}function E(e,n){e.references.push(n),!1!==e.last_ref&&(e.last_ref=n)}function R(e,n){var t,i,r;return"m"!=n.single_use&&((t=e.safe_ids[n.id])?((i=HOP(e.safe_ids,n.id))||(r=e.safe_ids.seq,t.read?t.read!==r&&(t.read=!0):t.read=r),null==n.fixed?!ge(n)&&!(n.global&&"arguments"==n.name||(e.loop_ids[n.id]=null,n.fixed=ke(AST_Undefined,n.orig[0]),i&&(n.safe_ids=void 0),0)):!t.assign||t.assign===e.safe_ids):n.fixed instanceof AST_LambdaDefinition)}function O(e,n,t){if(!t){if(is_funarg(n)&&n.scope.uses_arguments&&!e.has_directive("use strict"))return;if(!all(n.orig,function(e){return!(e instanceof AST_SymbolConst)}))return}if(void 0===n.fixed)return t||all(n.orig,function(e){return!(e instanceof AST_SymbolLet)});if(!1!==n.fixed&&0!==n.fixed){t=e.safe_ids[n.id];if(n.safe_ids)return n.safe_ids[n.id]=!1,n.safe_ids=void 0,null===n.fixed||HOP(e.safe_ids,n.id)&&!t.read;if(!HOP(e.safe_ids,n.id)){if(!t)return;if(t.read||e.in_loop){var i=e.find_parent(AST_BlockScope);if(i instanceof AST_Class)return;if(n.scope.resolve()!==i.resolve())return}t.assign=!(!t.assign||t.assign===e.safe_ids)||e.safe_ids}if(null!=n.fixed&&t.read){if(t.read!==e.safe_ids.seq)return;if(e.loop_ids[n.id]!==e.in_loop)return}return R(e,n)&&all(n.orig,function(e){return!(e instanceof AST_SymbolLambda)})}}function U(e){var n;return!!e&&(e instanceof AST_Assign?"="==(n=e.operator)?U(e.right):!Ne[n.slice(0,-1)]:e instanceof AST_Sequence?U(e.tail_node()):e.is_constant()||w(e)||e instanceof AST_ObjectIdentity)}function j(e,n,t,i,r,o,a){var s,f=e.parent(o);if(!r||!r.is_constant())if(Oe(n,t,i,f))n.escaped.push(f),!(1<a)||r&&r.is_constant_expression(t)||(a=1),(!n.escaped.depth||n.escaped.depth>a)&&(n.escaped.depth=a),n.scope.resolve()!==t.resolve()&&(n.escaped.cross_scope=!0),n.fixed&&(n.fixed.escaped=n.escaped);else{if(c=i,(s=f)instanceof AST_Array||(s instanceof AST_Binary?Ne[s.operator]:s instanceof AST_Conditional?s.condition!==c:s instanceof AST_Sequence?s.tail_node()===c:s instanceof AST_Spread))j(e,n,t,f,f,o+1,a);else if(f instanceof AST_ObjectKeyVal&&f.value===i){var c=e.parent(o+1);j(e,n,t,c,c,o+2,a)}else if(f instanceof AST_PropAccess&&f.expression===i&&(j(e,n,t,f,r=u(r,f),o+1,a+1),r))return;0<o||f instanceof AST_Call&&f.expression===i||f instanceof AST_Sequence&&f.tail_node()!==i||f instanceof AST_SimpleStatement||f instanceof AST_Unary&&!unary_side_effects[f.operator]||(n.direct_access=!0,n.fixed&&(n.fixed.direct_access=!0))}}function L(e){var n;e instanceof AST_Sub&&(n=e.expression)instanceof AST_SymbolRef&&ge(n=n.definition())&&((e=(e=e.property).is_constant()?e.value:e)instanceof AST_Node||y.test(e))&&(n.reassigned++,(e instanceof AST_Node?n.scope.argnames:[n.scope.argnames[e]]).forEach(function(e){e instanceof AST_SymbolFunarg&&(e.definition().fixed=!1)}))}function V(n,t){var i,r;return function(){var e=n();return r=i!==e?t(i=e):r}}function I(c,n,e,l,u){var _=new TreeWalker(function(i){var t,r,o,a,s,f,e;return i instanceof AST_DefaultValue?(A(i),S(c,!0),i.value.walk(c),p(c),(e=l)&&(t=n,r=i,o=e,l=function(){var e,n;return s===r?r:(e=o(),(n=N(t,e,!0))instanceof AST_Node?s=r:a!==e&&(a=e,s=void 0===n?we(r,[e,r.value]):e),s)}),i.name.walk(_),l=e):i instanceof AST_DestructuredArray?(A(i),e=l,i.elements.forEach(function(n,t){if(n instanceof AST_Hole)return A(n);e&&(l=V(e,function(e){return ke(AST_Sub,n,{expression:e,property:ke(AST_Number,n,{value:t})})})),n.walk(_)}),i.rest&&(e&&(l=n.option("rests")&&V(e,function(e){if(!(e instanceof AST_Array))return i;for(var n=0,t=i.elements.length;n<t;n++)if(e.elements[n]instanceof AST_Spread)return i;return(f=f||ke(AST_Array,i,{})).elements=e.elements.slice(t),f})),i.rest.walk(_)),l=e):i instanceof AST_DestructuredObject?(A(i),e=l,i.properties.forEach(function(i){A(i),i.key instanceof AST_Node&&(S(c),i.key.walk(c),p(c)),e&&(l=V(e,function(e){var n=i.key,t=AST_Sub;return"string"==typeof n&&(is_identifier_string(n)?t=AST_Dot:n=Z(n,i)),ke(t,i,{expression:e,property:n})})),i.value.walk(_)}),i.rest&&(l=!1,i.rest.walk(_)),l=e):u(i,l,function(){for(var e=c.stack.length,n=0,t=_.stack.length-1;n<t;n++)c.stack.push(_.stack[n]);i.walk(c),c.stack.length=e}),!0});e.walk(_)}function M(i,e,r){var n,o=this,a=(o.inlined=!1,i.parent()),t=!is_async(o)&&!is_generator(o),s=!t,f=!1,c=(o.walk(new TreeWalker(function(e){return s?f=!0:e instanceof AST_Return?s=!0:e instanceof AST_Scope&&e!==o||void 0})),f&&S(i,t),g(i,r,o),!o.uses_arguments||i.has_directive("use strict")),l=(o.argnames.forEach(function(n,e){var t=a.args[e];I(i,r,n,function(){var e=o.argnames.indexOf(n),e=e<0?t:a.args[e];return(e=e instanceof AST_Sequence&&e.expressions.length<2?e.expressions[0]:e)||ke(AST_Undefined,a)},_)}),o.rest),t=(l&&I(i,r,l,r.option("rests")&&function(){return o.rest!==l?l:((n=n||ke(AST_Array,o,{})).elements=a.args.slice(o.argnames.length),n)},_),walk_lambda(o,i),i.defined_ids),u=i.safe_ids;return k(i,o),f||(i.defined_ids=t,i.safe_ids=u),!0;function _(e,n){var t=e.definition();t.first_decl||0!=t.references.length||(t.first_decl=e),n&&c&&void 0===t.fixed?(d(i,t),i.loop_ids[t.id]=i.in_loop,t.fixed=n,t.fixed.assigns=[e]):t.fixed=!1}}function A(e){e._squeezed=!1,e._optimized=!1,e.single_use=!1,e instanceof AST_BlockScope&&(e._var_names=void 0),e instanceof AST_SymbolRef&&(e.fixed=void 0)}function H(t,i){return this.transform(new TreeTransformer(function(e,n){return e instanceof AST_DefaultValue?((e=e.clone()).name=e.name.transform(this),e):e instanceof AST_Destructured?(n(e=e.clone(),this),e):e instanceof AST_DestructuredKeyVal?((e=e.clone()).value=e.value.transform(this),e):e.convert_symbol(t,i)}))}function $(e,n){e=ke(e,this);return n(e,this)||e}function X(e){var n=e.definition();n.assignments++,n.references.push(e)}function J(n,t){var i=new TreeWalker(function(e){return e instanceof AST_DefaultValue?(e.value.walk(t),e.name.walk(i),!0):e instanceof AST_DestructuredKeyVal?(e.key instanceof AST_Node&&e.key.walk(t),e.value.walk(i),!0):n(e)});this.walk(i)}function Q(e){return e(this)}function ne(n,t){var i=!1,r=new TreeWalker(function(e){return!!i||(e instanceof AST_DefaultValue?t?(e.name.walk(r),!0):i=!0:e instanceof AST_DestructuredKeyVal?!t&&e.key instanceof AST_Node?i=!0:(e.value.walk(r),!0):n(e)?i=!0:void 0)});return this.walk(r),i}function B(e){return e instanceof AST_AsyncGeneratorDefun||e instanceof AST_AsyncGeneratorFunction}function xe(e){var n=0,t=e.self();do{if(t.variables)return t}while(t=e.parent(n++))}function Be(e,n,t,i,r,o){for(var a;a=e.parent(n++);t=a){if(a===i)return!1;if(o&&a instanceof AST_Lambda){if(a.name||is_async(a)||is_generator(a))return!0}else if(a instanceof AST_Try){if(a.bfinally&&a.bfinally!==t)return!0;if(r&&a.bcatch&&a.bcatch!==t)return!0}}return!1}(n=function(e,n){e.DEFMETHOD("reduce_vars",n)})(AST_Node,noop),n(AST_Assign,function(o,e,n){var a=this,s=a.left,f=a.right,t=s instanceof AST_SymbolRef&&s.definition(),i=t||s instanceof AST_Destructured;switch(a.operator){case"=":return s.equals(f)&&!s.has_side_effects(n)?(f.walk(o),function e(n){A(n);{var t;n instanceof AST_Dot?e(n.expression):n instanceof AST_Sub?(e(n.expression),n.property.walk(o)):n instanceof AST_SymbolRef?(E(t=n.definition(),n),t.fixed&&(n.fixed=t.fixed,n.fixed.assigns?n.fixed.assigns.push(a):n.fixed.assigns=[a])):n.walk(o)}}(s),!0):t&&f instanceof AST_LambdaExpression?(u(),f.parent_scope.resolve().fn_defs.push(f),f.safe_ids=null,t.fixed&&a.write_only||x(o,t,f),!0):i?(f.walk(o),u(),!0):void L(s);case"&&=":case"||=":case"??=":var r=!0;default:if(!i)return L(s),_();D(o,t),t.assignments++;var c,l=t.fixed;return ye(n,o,a,a,0)?(t.fixed=!1,_()):(c=R(o,t),r&&S(o,!0),f.walk(o),r&&p(o),c&&!s.in_arg&&O(o,t)?(E(t,s),d(o,t),t.single_use&&(t.single_use=!1),s.fixed=t.fixed=function(){return ke(AST_Binary,a,{operator:a.operator.slice(0,-1),left:m(s,l),right:a.right})},s.fixed.assigns=l&&l.assigns?l.assigns.slice():[t.orig[0]],s.fixed.assigns.push(a),s.fixed.to_binary=v(function(e){return e.left},l)):(s.walk(o),t.fixed=!1),!0)}function u(){var e=t&&Qn(o,t),r=ye(n,o,a,f,0,U(f),e);I(o,n,s,function(){return a.right},function(e,n,t){var i;e instanceof AST_SymbolRef?(i=e.definition(),D(o,i),i.assignments++,n&&!e.in_arg&&O(o,i)?(E(i,e),d(o,i),(s instanceof AST_Destructured||1==i.orig.length&&i.orig[0]instanceof AST_SymbolDefun)&&(i.single_use=!1),o.loop_ids[i.id]=o.in_loop,i.fixed=r?0:n,e.fixed=n,e.fixed.assigns=[a],j(o,i,e.scope,a,f,0,1)):(t(),i.fixed=!1)):(L(e),t())})}function _(){if(r)return s.walk(o),S(o,!0),f.walk(o),p(o),!0}}),n(AST_Binary,function(e){if(Ne[this.operator])return this.left.walk(e),S(e,!0),this.right.walk(e),p(e),!0}),n(AST_BlockScope,function(e,n,t){a(0,t,this)}),n(AST_Call,function(n){var t,e=this,i=e.expression;if(i instanceof AST_LambdaExpression)t=Fe(e),e.args.forEach(function(e){e.walk(n),e instanceof AST_Spread&&(t=!1)}),t&&(i.reduce_vars=M),i.walk(n),t&&delete i.reduce_vars;else{if("Call"==e.TYPE)switch(n.in_boolean_context()){case"d":var r=!0;case!0:!function e(n,t){n instanceof AST_Assign?"="==n.operator&&(e(n.left,t),e(n.right,t)):n instanceof AST_Binary?Ne[n.operator]&&(e(n.left,t),e(n.right,t)):n instanceof AST_Conditional?(e(n.consequent,t),e(n.alternative,t)):n instanceof AST_SymbolRef&&((n=n.definition()).bool_return++,t)&&n.drop_return++}(i,r)}i.walk(n);var o=e.optional,e=(o&&S(n,!0),e.args.forEach(function(e){e.walk(n)}),o&&p(n),i instanceof AST_SymbolRef&&i.fixed_value());e instanceof AST_Lambda?x(n,i.definition(),e):(n.defined_ids.seq={},n.find_parent(AST_Scope).may_call_this())}return!0}),n(AST_Class,function(n,e,t){var i,r,o=this,t=(a(0,t,o),o.extends&&o.extends.walk(n),o.properties.filter(function(e){return A(e),e.key instanceof AST_Node&&(n.push(e),e.key.walk(n),n.pop()),e.value}));return o.name&&(i=o.name.definition(),((r=n.parent())instanceof AST_ExportDeclaration||r instanceof AST_ExportDefault)&&(i.single_use=!1),O(n,i,!0)?(d(n,i),n.loop_ids[i.id]=n.in_loop,i.fixed=function(){return o},i.fixed.assigns=[o],On(i)||(i.single_use=!1)):i.fixed=!1),t.forEach(function(e){n.push(e),!e.static||he(e)&&e.value.contains_this()?(S(n),e.value.walk(n),p(n)):e.value.walk(n),n.pop()}),!0}),n(AST_ClassInitBlock,function(e,n,t){return S(e,!0),g(e,t,this),n(),k(e,this),!0}),n(AST_Conditional,function(e){return this.condition.walk(e),S(e,!0),this.consequent.walk(e),p(e),S(e,!0),this.alternative.walk(e),p(e),!0}),n(AST_DefaultValue,function(e){return S(e,!0),this.value.walk(e),p(e),this.name.walk(e),!0}),n(AST_Do,function(e){var n=e.in_loop;return e.in_loop=this,S(e),this.body.walk(e),Cn(this,e.parent())&&(p(e),S(e)),this.condition.walk(e),p(e),e.in_loop=n,!0}),n(AST_Dot,function(e,n){n();n=this.expression;return!this.optional&&n instanceof AST_SymbolRef&&r(e,n.definition()),!0}),n(AST_For,function(e,n,t){var i=this,t=(a(0,t,i),i.init&&i.init.walk(e),e.in_loop);return e.in_loop=i,S(e),i.condition&&i.condition.walk(e),i.body.walk(e),i.step&&(Cn(i,e.parent())&&(p(e),S(e)),i.step.walk(e)),p(e),e.in_loop=t,!0}),n(AST_ForEnumeration,function(e,n,t){var i=this,t=(a(0,t,i),i.object.walk(e),e.in_loop),r=(e.in_loop=i,S(e),i.init);return r instanceof AST_Definitions?r.definitions[0].name.mark_symbol(function(e){e instanceof AST_SymbolDeclaration&&((e=e.definition()).assignments++,e.fixed=!1)},e):r instanceof AST_Destructured||r instanceof AST_SymbolRef?r.mark_symbol(function(e){var n;e instanceof AST_SymbolRef&&(E(n=e.definition(),e),n.assignments++,e.is_immutable()||(n.fixed=!1))},e):r.walk(e),i.body.walk(e),p(e),e.in_loop=t,!0}),n(AST_If,function(e){return this.condition.walk(e),S(e,!0),this.body.walk(e),p(e),this.alternative&&(S(e,!0),this.alternative.walk(e),p(e)),!0}),n(AST_LabeledStatement,function(e){return S(e,!0),this.body.walk(e),p(e),!0}),n(AST_Lambda,function(e,n,t){var i=this;return s(e,i)&&push_uniq(e.fn_visited,i)&&(i.inlined=!1,S(e),g(e,t,i),n(),k(e,i),i.name)&&j(e,i.name.definition(),i,i.name,i,0,1),!0}),n(AST_LambdaDefinition,function(e,n,t){var i=this,r=i.name.definition(),o=e.parent();return(o instanceof AST_ExportDeclaration||o instanceof AST_ExportDefault)&&(r.single_use=!1),s(e,i)&&push_uniq(e.fn_visited,i)&&(i.inlined=!1,S(e),g(e,t,i),n(),k(e,i)),!0}),n(AST_Sub,function(e,n){var t=this.expression;return this.optional?(t.walk(e),S(e,!0),this.property.walk(e),p(e)):(n(),t instanceof AST_SymbolRef&&r(e,t.definition())),!0}),n(AST_Switch,function(n,e,t){a(0,t,this),this.expression.walk(n);var i=!0;return this.body.forEach(function(e){e instanceof AST_Default||(e.expression.walk(n),i&&S(n,!(i=!1)))}),i||p(n),walk_body(this,n),!0}),n(AST_SwitchBranch,function(e){return S(e,!0),walk_body(this,e),p(e),!0}),n(AST_SymbolCatch,function(){var e=this.definition();e.first_decl||0!=e.references.length||(e.first_decl=this),e.fixed=!1}),n(AST_SymbolDeclaration,function(){var e=this.definition();e.first_decl||0!=e.references.length||(e.first_decl=this)}),n(AST_SymbolDefun,function(){var e=this.definition();e.first_decl||0!=e.references.length||(e.first_decl=this),1<e.orig.length&&e.scope.resolve()!==this.scope&&(e.fixed=!1)}),n(AST_SymbolImport,function(){var e=this.definition();e.first_decl=this,e.fixed=!1}),n(AST_SymbolRef,function(t,e,n){var i,r=this,o=r.definition(),a=o.fixed||o.last_ref&&o.last_ref.fixed,s=(E(o,r),!function(e,n){var t=e.defined_ids.seq,i=e.defined_ids[n.id];if(i===t)return!(i=e.assigned_ids[n.id])||i===t}(t,o)||(r.defined=!0),1==o.references.length&&!o.fixed&&o.orig[0]instanceof AST_SymbolDefun&&(t.loop_ids[o.id]=t.in_loop),Qn(t,o));switch(s&&s.enclosed.forEach(function(e){var n;o===e||e.scope.resolve()===s||!(n=e.fixed&&e.fixed.assigns)||n[n.length-1]instanceof AST_VarDef||(n=t.safe_ids[e.id])&&(n.assign=!0)}),"m"==o.single_use&&o.fixed&&(o.fixed=0,o.single_use=!1),o.fixed){case 0:R(t,o)||(o.fixed=!1);case!1:var f=o.redefined();f&&b(o.scope,r.scope)&&(f.single_use=!1);break;case void 0:o.fixed=!1;break;default:R(t,o)?(r.in_arg&&o.orig[0]instanceof AST_SymbolLambda&&(r.fixed=o.scope),i=r.fixed_value(),s?o.recursive_refs++:!i||(f=o,!n.option("unused"))||f.scope.pinned()||!1===f.single_use||f.references.length-f.recursive_refs!=1||is_funarg(f)&&f.scope.uses_arguments?o.single_use=!1:(o.in_loop=t.loop_ids[o.id]!==t.in_loop,o.single_use=w(i)&&!i.pinned()&&(!o.in_loop||t.parent()instanceof AST_Call)||!o.in_loop&&o.scope===r.scope.resolve()&&i.is_constant_expression()),ye(n,t,r,i,0,U(i),s)&&(o.single_use?o.single_use="m":o.fixed=0),o.fixed&&t.loop_ids[o.id]!==t.in_loop&&(o.cross_loop=!0),j(t,o,r.scope,r,i,0,1)):o.fixed=!1}if(r.fixed||(r.fixed=0===o.fixed?a:o.fixed),(i=!i&&a?a instanceof AST_Node?a:a():i)instanceof AST_Lambda){if(o.fixed){a=t.parent();if(a instanceof AST_Call&&a.expression===r)return}x(t,o,i)}}),n(AST_Template,function(n,e){var t,i=this.tag;if(i)return i instanceof AST_LambdaExpression?(this.expressions.forEach(function(e){e.walk(n)}),i.walk(n)):(i.walk(n),this.expressions.forEach(function(e){e.walk(n)}),(t=i instanceof AST_SymbolRef&&i.fixed_value())instanceof AST_Lambda?x(n,i.definition(),t):n.find_parent(AST_Scope).may_call_this()),!0}),n(AST_Toplevel,function(e,n,t){return this.globals.each(function(e){o(0,t,e)}),S(e,!0),g(e,t,this),n(),k(e,this),!0}),n(AST_Try,function(e,n,t){var i=this;return a(0,t,i),S(e,!0),walk_body(i,e),p(e),i.bcatch&&(S(e,!0),i.bcatch.walk(e),p(e)),i.bfinally&&i.bfinally.walk(e),!0}),n(AST_Unary,function(e,n){var t=this;if(UNARY_POSTFIX[t.operator]){var i,r,o=t.expression;if(o instanceof AST_SymbolRef)return(i=o.definition()).assignments++,r=i.fixed,R(e,i)&&!o.in_arg&&O(e,i)?(E(i,o),d(e,i),i.single_use&&(i.single_use=!1),i.fixed=function(){return ke(AST_Binary,t,{operator:t.operator.slice(0,-1),left:ke(AST_UnaryPrefix,t,{operator:"+",expression:m(o,r)}),right:ke(AST_Number,t,{value:1})})},i.fixed.assigns=r&&r.assigns?r.assigns.slice():[],i.fixed.assigns.push(t),t instanceof AST_UnaryPrefix?o.fixed=i.fixed:(o.fixed=function(){return ke(AST_UnaryPrefix,t,{operator:"+",expression:m(o,r)})},o.fixed.assigns=r&&r.assigns,o.fixed.to_prefix=v(function(e){return e.expression},i.fixed))):(o.walk(e),i.fixed=!1),!0;L(o)}}),n(AST_VarDef,function(i,e,n){var t,r=this,o=r.value;return o instanceof AST_LambdaExpression&&r.name instanceof AST_SymbolDeclaration?(a(),o.parent_scope.resolve().fn_defs.push(o),o.safe_ids=null,(t=r.name.definition()).fixed||x(i,t,o)):o?(o.walk(i),a()):i.parent()instanceof AST_Let?a():r.name.walk(i),!0;function a(){I(i,n,r.name,function(){return r.value||ke(AST_Undefined,r)},function(e,n){var t=e.definition();D(i,t),t.first_decl||0!=t.references.length||(t.first_decl=e),n&&O(i,t,!0)?(d(i,t),i.loop_ids[t.id]=i.in_loop,t.fixed=n,t.fixed.assigns=[r],(e instanceof AST_SymbolConst&&t.redefined()||!be(e)&&!On(t))&&(t.single_use=!1)):t.fixed=!1})}}),n(AST_While,function(e,n){var t=e.in_loop;return e.in_loop=this,S(e),n(),p(e),e.in_loop=t,!0}),AST_Toplevel.DEFMETHOD("reset_opt_flags",function(t){var i=new TreeWalker(t.option("reduce_vars")?function(e,n){return A(e),e.reduce_vars(i,n,t)}:A);i.assigned_ids=Object.create(null),i.defined_ids=Object.create(null),i.defined_ids.seq={},i.fn_scanning=null,i.fn_visited=[],i.in_loop=null,i.loop_ids=Object.create(null),i.safe_ids=Object.create(null),i.safe_ids.seq={},this.walk(i)}),AST_Symbol.DEFMETHOD("fixed_value",function(e){var n=this.definition(),t=n.fixed;return t?((t=this.fixed?this.fixed:t)instanceof AST_Node?t:t()).tail_node():(t=0===t&&this.fixed)&&(t=(t instanceof AST_Node?t:t()).tail_node(),e&&1!=n.escaped.depth&&Kn(t,!0)||t.is_constant()?t:void 0)}),AST_SymbolRef.DEFMETHOD("is_immutable",function(){var e=this.redef||this.definition();return e.orig[0]instanceof AST_SymbolLambda&&(1==e.orig.length||!(!this.in_arg||e.orig[1]instanceof AST_SymbolFunarg))}),AST_Node.DEFMETHOD("convert_symbol",noop),AST_DefaultValue.DEFMETHOD("convert_symbol",H),AST_Destructured.DEFMETHOD("convert_symbol",H),AST_SymbolDeclaration.DEFMETHOD("convert_symbol",$),AST_SymbolRef.DEFMETHOD("convert_symbol",$),AST_DefaultValue.DEFMETHOD("mark_symbol",J),AST_Destructured.DEFMETHOD("mark_symbol",J),AST_SymbolDeclaration.DEFMETHOD("mark_symbol",Q),AST_SymbolRef.DEFMETHOD("mark_symbol",Q),AST_Node.DEFMETHOD("match_symbol",function(e){return e(this)}),AST_DefaultValue.DEFMETHOD("match_symbol",ne),AST_Destructured.DEFMETHOD("match_symbol",ne);var te=makePredicate("Infinity NaN undefined");function Pe(e,n){if(e instanceof AST_Assign)return"="!=e.operator||!!e.right.tail_node().is_constant()||Pe(e.left,n);if(e instanceof AST_Atom)return!0;if(e instanceof AST_ObjectIdentity)return!0;if(e instanceof AST_PropAccess){if("__proto__"===e.property)return!0;if((e=e.expression)instanceof AST_SymbolRef){if(e.is_immutable())return!1;e=e.fixed_value()}return e?!!e.tail_node().is_constant()||Pe(e,n):!0}return e instanceof AST_SymbolRef&&(!!e.is_immutable()||(e=e.definition(),n.exposed(e)&&te[e.name]))}function ke(e,n,t){return t?(t.start=n.start,t.end=n.end):t=n,new e(t)}function we(e,n){return 1==n.length?n[0]:ke(AST_Sequence,e,{expressions:n.reduce(re,[])})}function Z(e,n){switch(typeof e){case"string":return ke(AST_String,n,{value:e});case"number":return isNaN(e)?ke(AST_NaN,n):isFinite(e)?1/e<0?ke(AST_UnaryPrefix,n,{operator:"-",expression:ke(AST_Number,n,{value:-e})}):ke(AST_Number,n,{value:e}):e<0?ke(AST_UnaryPrefix,n,{operator:"-",expression:ke(AST_Infinity,n)}):ke(AST_Infinity,n);case"boolean":return ke(e?AST_True:AST_False,n);case"undefined":return ke(AST_Undefined,n);default:if(null===e)return ke(AST_Null,n);if(e instanceof RegExp)return ke(AST_RegExp,n,{value:e});throw new Error(string_template("Can't handle constant of type: {type}",{type:typeof e}))}}function ie(e){return e instanceof AST_PropAccess||Ee(e)&&"eval"==e.name}function De(e,n,t){var i=!1;return"Call"==e.TYPE?i=e.expression===n&&ie(t):e instanceof AST_Template?i=e.tag===n&&ie(t):e instanceof AST_UnaryPrefix&&(i="delete"==e.operator||"typeof"==e.operator&&Ee(t)),i?we(n,[ke(AST_Number,n,{value:0}),t]):t}function P(e,n){var i=new Dictionary;return e.walk(new TreeWalker(function(e){var n;e instanceof AST_SymbolRef&&(n=e.definition(),(e=e.fixed)&&i.has(n.id)?i.get(n.id)!==e&&i.set(n.id,!1):i.set(n.id,e))})),0<i.size()&&n.walk(new TreeWalker(function(e){var n,t;e instanceof AST_SymbolRef&&(n=e.definition(),t=e.fixed)&&i.has(n.id)&&i.get(n.id)!==t&&(e.fixed=!1)})),n}function re(e,n){return n instanceof AST_Sequence?[].push.apply(e,n.expressions):e.push(n),e}function oe(e){return e instanceof AST_Const||e instanceof AST_DefClass||e instanceof AST_Let}function ae(e){var n,t;return e instanceof AST_LambdaDefinition?(n=e.name.definition(),t=e.name.scope,!(1<n.orig.length&&n.scope.resolve()!==t)&&(n.scope===t||all(n.references,function(e){var n=e.scope;do{if(n===t)return!0}while(n=n.parent_scope)}))):!oe(e)}function se(e){if(null===e)return[];if(e instanceof AST_BlockStatement)return all(e.body,ae)?e.body:[e];if(e instanceof AST_EmptyStatement)return[];if(is_statement(e))return[e];throw new Error("Can't convert thing to statement array")}function ee(e){return null===e||e instanceof AST_EmptyStatement||e instanceof AST_BlockStatement&&0==e.body.length}function fe(e){return all(e.body,function(e){return ee(e)||e instanceof AST_Defun||e instanceof AST_Var&&W(e)})}function ce(e){return e instanceof AST_IterationStatement&&e.body instanceof AST_BlockStatement?e.body:e}function le(e){if("Call"!=e.TYPE)return!1;for(;(e=e.expression)instanceof AST_PropAccess;);return e instanceof AST_LambdaExpression?!is_arrow(e):le(e)}function Fe(e){var n,t=e.expression;return!(t.name||e instanceof AST_New&&(n=!1,t.walk(new TreeWalker(function(e){return!!n||(e instanceof AST_NewTarget?n=!0:e instanceof AST_Scope&&e!==t||void 0)})),n))}function Ee(e){return e instanceof AST_SymbolRef&&e.definition().undeclared}var ue,_e,Se,pe,de,Ae,Te,qe=makePredicate("Array Boolean clearInterval clearTimeout console Date decodeURI decodeURIComponent encodeURI encodeURIComponent Error escape eval EvalError Function isFinite isNaN JSON Map Math Number parseFloat parseInt RangeError ReferenceError RegExp Object Set setInterval setTimeout String SyntaxError TypeError unescape URIError WeakMap WeakSet");function he(e){return e.static&&e.value&&(e instanceof AST_ClassField||e instanceof AST_ClassInit)}function W(e){return all(e.definitions,function(e){return!e.value})}function F(e,n){return e instanceof AST_DefClass?n&&!e.extends&&all(e.properties,function(e){return!(e.key instanceof AST_Node||he(e))}):e instanceof AST_Definitions?(n||e instanceof AST_Var)&&W(e):e instanceof AST_ExportDeclaration||e instanceof AST_ExportDefault?F(e.body,n):e instanceof AST_LambdaDefinition}function ze(e,n){var t=e.lastIndexOf(n);if(t<0)return!1;for(;++t<e.length;)if(!F(e[t],!0))return!1;return!0}function Ue(e,n){var t;if(e.init instanceof AST_BlockStatement&&(e.init=(t=e.init).body.pop(),t.body.push(e)),e.init instanceof AST_Defun?((t=t||ke(AST_BlockStatement,e,{body:[e]})).body.splice(-1,0,e.init),e.init=null):e.init instanceof AST_SimpleStatement?e.init=e.init.body:ee(e.init)&&(e.init=null),t)return n?List.splice(t.body):t}function me(e,S){var de,Ae,Te,he,me,ve,R=O(S,function(e){return e instanceof AST_Lambda}),n=S.self(),t=0;do{if(!de&&n.variables&&(de=n),n instanceof AST_Catch)S.parent(t).bfinally&&((me=me||{}).bfinally=!0),t++;else if(n instanceof AST_Finally)t++;else if(n instanceof AST_IterationStatement)he=!0;else{if(n instanceof AST_Scope){ve=n;break}n instanceof AST_Try&&(me=me||{},n.bcatch&&(me.bcatch=!0),n.bfinally)&&(me.bfinally=!0)}}while(n=S.parent(t++));var i,r,o=10;do{if(r=i,i=0,!(i=!function e(n){var t=!1,i=[];for(var r=0;r<n.length;){var o=n[r];if(o instanceof AST_BlockStatement&&all(o.body,ae))t=!0,e(o.body),[].splice.apply(n,[r,1].concat(o.body)),r+=o.body.length;else{if(o instanceof AST_Directive){if(member(o.value,i)){t=!0,n.splice(r,1);continue}i.push(o.value)}o instanceof AST_EmptyStatement?(t=!0,n.splice(r,1)):r++}}return t}(e)?i:1)&&1==r)break;if(S.option("dead_code")&&!(i=!function(n,t){var e,i=t.self();i instanceof AST_Catch?i=t.parent():i instanceof AST_LabeledStatement&&(i=i.body);for(var r=0,o=0,a=n.length;r<a;r++){var s,f=n[r];if(!(f instanceof AST_LoopControl)||ce(s=t.loopcontrol_target(f))!==i||f instanceof AST_Break&&s instanceof AST_IterationStatement?n[o++]=f:f.label&&remove(f.label.thedef.references,f),q(f)){e=n.slice(r+1);break}}n.length=o,e&&e.forEach(function(e){C(t,e,n)});return n.length!=a}(e,S)?i:2)&&2==r)break;if(S.option("if_return")&&!(i=!function(a,i){for(var r,s,o,f=!1,c=i.parent(),l=i.self(),e=R&&c&&"Call"==c.TYPE&&c.expression===l,n=R&&i.option("conditionals")&&i.option("sequences"),u=!(me&&me.bfinally&&B(ve)),t=function(e){for(var n=0,t=e.length;0<=--t;){var i=e[t];if(i instanceof AST_If&&i.body instanceof AST_Return&&1<++n)return!0}return!1}(a),_=a.length;0<=--_;){var S=a[_],p=N(_),d=a[p];if(R&&r&&!d&&S instanceof AST_Return&&u&&!(l instanceof AST_SwitchBranch)){if(!(m=S.value)){f=!0,a.splice(_,1);continue}var A=m.tail_node();if(Ce(A)){f=!0,m instanceof AST_UnaryPrefix?m=m.expression:A instanceof AST_UnaryPrefix&&((m=m.clone()).expressions[m.expressions.length-1]=A.expression),a[_]=ke(AST_SimpleStatement,S,{body:m});continue}}if(S instanceof AST_If){A=q(S.body);if(k(A)){A.label&&remove(A.label.thedef.references,A),f=!0,(S=S.clone()).body=ke(AST_BlockStatement,S,{body:E(S.body,A)}),S.alternative=ke(AST_BlockStatement,S,{body:se(S.alternative).concat(w(o,s))}),C(A.value,o),a[_]=S,a[_]=S.transform(i);continue}if(A&&!S.alternative&&d instanceof AST_Jump){var T=S.condition,h=_+1==p&&S.body instanceof AST_BlockStatement;if((T=Y(T,T.negate(i),h))!==S.condition){f=!0,(S=S.clone()).condition=T;var m=S.body;S.body=ke(AST_BlockStatement,d,{body:w(!0,null,p+1)}),a.splice(_,1,S,m),(!R||l instanceof AST_Block&&l.body===a)&&(a[_]=S.transform(i));continue}}var v,h=q(S.alternative);if(k(h)){h.label&&remove(h.label.thedef.references,h),f=!0,(S=S.clone()).body=ke(AST_BlockStatement,S.body,{body:se(S.body).concat(w(o,s))}),S.alternative=ke(AST_BlockStatement,S.alternative,{body:E(S.alternative,h)}),C(h.value,o),a[_]=S,a[_]=S.transform(i);continue}i.option("typeofs")&&(A&&!h&&(v=ke(AST_BlockStatement,l,{body:a.slice(_+1)}),z(S.condition,null,v)),!A)&&h&&(v=ke(AST_BlockStatement,l,{body:a.slice(_+1)}),z(S.condition,v))}if(S instanceof AST_If&&S.body instanceof AST_Return){var T=S.body.value,y=S.body.in_bool||d instanceof AST_Return&&d.in_bool;if(!S.alternative&&d instanceof AST_Return&&(u||!T==!d.value)){f=!0,(S=S.clone()).alternative=ke(AST_BlockStatement,d,{body:w(!0,null,p+1)}),a[_]=S,a[_]=S.transform(i);continue}if(R&&r&&!d&&!S.alternative&&(y||T&&t||T instanceof AST_Conditional&&(Ce(T.consequent,i)||Ce(T.alternative,i)))){f=!0,(S=S.clone()).alternative=ke(AST_Return,S,{value:null}),a[_]=S,a[_]=S.transform(i);continue}if(n&&!S.alternative&&(!(g=a[y=function(e){for(var n=e;0<=--n;){var t=a[n];if(!(t instanceof AST_Var)&&!F(t))break}return n}(_)])&&e||g instanceof AST_If&&g.body instanceof AST_Return)&&(d?d instanceof AST_SimpleStatement&&N(p)==a.length:!r)){f=!0;var g=[];S=S.clone(),g.push(S.condition),S.condition=we(S,g),S.alternative=ke(AST_BlockStatement,l,{body:w().concat(ke(AST_Return,l,{value:null}))}),a[_]=S.transform(i),_=y+1;continue}}S instanceof AST_Break||S instanceof AST_Exit?s=S:r&&s&&s===d&&function e(n,t,i){if(n instanceof AST_Exit){var r=!(t&&n instanceof AST_Throw)&&x(n,!0);if(r)return f=!0,(r=D(n.value,r))?ke(AST_SimpleStatement,r,{body:r}):i?null:ke(AST_EmptyStatement,n)}else{var o;n instanceof AST_If?(n.body=e(n.body,t),n.alternative&&(n.alternative=e(n.alternative,t))):n instanceof AST_LabeledStatement?n.body=e(n.body,t):n instanceof AST_Try?n.bfinally&&s.value&&!s.value.is_constant()||(n.bcatch&&e(n.bcatch,t),(o=e(n.body.pop(),!0,!0))&&n.body.push(o)):n instanceof AST_Block&&!(n instanceof AST_Scope||n instanceof AST_Switch)&&(o=e(n.body.pop(),t,!0))&&n.body.push(o)}return n}(S)}return f;function b(n){return O(i,function(e){return e===n})}function x(e,n){var t;return!!s&&s.TYPE==e.TYPE&&!!(t=e.value)&&(!(e=!(e=s.equals(e))&&t instanceof AST_Sequence&&(t=t.tail_node(),s.value)&&s.value.equals(t)?2:e)&&!n&&s.value instanceof AST_Sequence&&s.value.tail_node().equals(t)?3:e)}function k(e){if(o=!1,function(e){if(e instanceof AST_Exit){if(!(o=x(e))){if(!R)return;if(!(e instanceof AST_Return))return;var n=e.value;if(n){if(!u)return;if(!Ce(n.tail_node()))return}if(l instanceof AST_SwitchBranch){if(!s)return;if(s instanceof AST_Exit&&s.value)return;o=4}}return 1}if(e instanceof AST_LoopControl){if(l instanceof AST_SwitchBranch)if(s instanceof AST_Exit){if(!R)return;if(s.value)return;o=!0}else if(s){if(i.loopcontrol_target(s)!==c)return;o=!0}else if(!1===s)return;n=i.loopcontrol_target(e);return e instanceof AST_Continue?b(ce(n)):!(n instanceof AST_IterationStatement)&&b(n)}}(e)){for(var n=a.length;--n>_;){var t=a[n];if(t instanceof AST_DefClass){if(t.name.definition().preinit)return}else if((t instanceof AST_Const||t instanceof AST_Let)&&!all(t.definitions,function(e){return!e.name.match_symbol(function(e){return e instanceof AST_SymbolDeclaration&&e.definition().preinit})}))return}return 1}}function w(e,n,t){var i=[],r=!1,o=_+1,t=(e?n?t=a.lastIndexOf(n):(n=a[t])!==s&&(s=!1):(t=a.length,s=null),a.splice(o,t-o).filter(function(e){return e instanceof AST_LambdaDefinition?(i.push(e),!1):(oe(e)&&(r=!0),!0)}));return 3===e&&(t.push(ke(AST_SimpleStatement,n.value,{body:we(n.value,n.value.expressions.slice(0,-1))})),n.value=n.value.tail_node()),[].push.apply(r?t:a,i),t}function D(e,n){if(e)switch(n){case 4:return e;case 3:if(!(e instanceof AST_Sequence))break;case 2:return we(e,e.expressions.slice(0,-1))}}function E(e,n){for(var t,e=se(e),i=e;(t=i[i.length-1])!==n;)i=t.body;i.pop();var r=n.value;return(r=o?D(r,o):r)&&i.push(ke(AST_SimpleStatement,r,{body:r})),e}function C(e,n){if(n&&e){switch(n){case 4:return;case 3:case 2:e=e.tail_node()}P(e,s.value)}}function N(e){r=!0;for(var n=e;++n<a.length;){var t=a[n];if(!F(t)){if(!(t instanceof AST_Var))break;r=!1}}return n}}(e,S)?i:3)&&3==r)break;if(S.option("awaits")&&S.option("side_effects")&&!(i=!function(e,n){if(!(!R||me&&me.bfinally)){for(var t=!1,i=e.length;0<=--i;){var r=e[i];if(!(r instanceof AST_SimpleStatement))break;var o=r.body.tail_node();if(!(o instanceof AST_Await))break;o=o.expression;if(!h(n,o))break;if(t=!0,o=o.drop_side_effect_free(n,!0),r.body instanceof AST_Sequence){var a=r.body.expressions.slice();a.pop(),o&&a.push(o),r.body=we(r.body,a);break}if(o){r.body=o;break}}return e.length=i+1,t}}(e,S)?i:4)&&4==r)break;if(4<=S.option("inline")&&!(i=!function(e,n){var t=!1,i=e.length-1;{var r;R&&0<=i&&(r=me&&me.bfinally&&B(ve),a=e[i].try_inline(n,de,r))&&(e[i--]=a,t=!0)}for(var o=he&&me&&me.bfinally?"try":he;0<=i;i--){var a;(a=e[i].try_inline(n,de,!0,o))&&(e[i]=a,t=!0)}return t}(e,S)?i:5)&&5==r)break;if(0<S.sequences_limit){if(!(i=!function(n,e){if(!(n.length<2)){for(var t=[],i=0,r=0,o=n.length;r<o;r++){var a=n[r];a instanceof AST_SimpleStatement?(t.length>=e.sequences_limit&&s(),re(t,a.body)):(F(a)||s(),n[i++]=a)}return s(),(n.length=i)!=o}function s(){var e;t.length&&(e=we(t[0],t),n[i++]=ke(AST_SimpleStatement,e,{body:e}),t=[])}}(e,S)?i:6)&&6==r)break;if(!(i=!function(e,n){for(var t,i=!1,r=0,o=0;o<e.length;o++){var a,s=e[o];if(t&&(s instanceof AST_Exit?!s.value&&B(ve)||(s.value=_(s.value||ke(AST_Undefined,s)).optimize(n)):s instanceof AST_For?s.init instanceof AST_Definitions||(a=!1,t.body.walk(new TreeWalker(function(e){return!!(a||e instanceof AST_Scope)||(e instanceof AST_Binary&&"in"==e.operator?a=!0:void 0)})),a)||(s.init?s.init=_(s.init):(s.init=t.body,r--,i=!0)):s instanceof AST_ForIn?oe(s.init)||(s.object=_(s.object)):s instanceof AST_If?s.condition=_(s.condition):(s instanceof AST_Switch||s instanceof AST_With)&&(s.expression=_(s.expression))),n.option("conditionals")&&s instanceof AST_If){var f=[],c=p(s.body,f),l=p(s.alternative,f);if(!1!==c&&!1!==l&&0<f.length){var u=f.length;f.push(ke(AST_If,s,{condition:s.condition,body:c||ke(AST_EmptyStatement,s.body),alternative:l})),f.unshift(r,1),[].splice.apply(e,f),o+=u,r+=u+1,i=!(t=null);continue}}e[r++]=s,t=s instanceof AST_SimpleStatement?s:null}return e.length=r,i;function _(e){r--,i=!0;var n=t.body;return we(n,[n,e])}}(e,S)?i:7)&&7==r)break}if(S.option("join_vars")&&!(i=!function(e){for(var r,n,o=!1,t=0,i=-1;t<e.length;t++){var a,s,f,c=e[t],l=e[i];if(c instanceof AST_Definitions)l&&l.TYPE==c.TYPE?(l.definitions=l.definitions.concat(c.definitions),o=!0):c&&l instanceof AST_Let&&c.can_letify(S)?(l.definitions=l.definitions.concat(Pn(c,de).definitions),o=!0):l&&c instanceof AST_Let&&l.can_letify(S)?(r=n,e[i]=l=Pn(l,de),l.definitions=l.definitions.concat(c.definitions),o=!0):r&&r.TYPE==c.TYPE&&W(c)?(r.definitions=r.definitions.concat(c.definitions),o=!0):c instanceof AST_Var?((s=A(l,c))?(s.length&&(l.body=we(l,s),i++),o=!0):i++,n=r,e[i]=r=c):e[++i]=c;else{if(c instanceof AST_Exit)c.value=u(c.value);else if(c instanceof AST_For)if(s=d(l,c.init))o=!0,c.init=s.length?we(c.init,s):null;else{if(l instanceof AST_Var&&(!c.init||c.init.TYPE==l.TYPE)){c.init&&(l.definitions=l.definitions.concat(c.init.definitions)),c=c.clone(),n=r,r=c.init=l,e[i]=_(c),o=!0;continue}if(r&&c.init&&r.TYPE==c.init.TYPE&&W(c.init))r.definitions=r.definitions.concat(c.init.definitions),c.init=null,o=!0;else if(c.init instanceof AST_Var&&(n=r,r=c.init,s=A(l,c.init))){if(o=!0,0==s.length){e[i]=_(c);continue}l.body=we(l,s)}}else if(c instanceof AST_ForEnumeration)r&&r.TYPE==c.init.TYPE&&(a=r.definitions.slice(),c.init=c.init.definitions[0].name.convert_symbol(AST_SymbolRef,function(e,n){a.push(ke(AST_VarDef,n,{name:n,value:null})),n.definition().references.push(e)}),r.definitions=a,o=!0),c.object=u(c.object);else if(c instanceof AST_If)c.condition=u(c.condition);else if(c instanceof AST_SimpleStatement){if(s=d(l,c.body)){if(o=!0,!s.length)continue;c.body=we(c.body,s)}else if(l instanceof AST_Definitions&&(f=e[t+1])&&l.TYPE==f.TYPE&&(f=f.definitions[0]).value){o=!0,f.value=we(c,[c.body,f.value]);continue}}else(c instanceof AST_Switch||c instanceof AST_With)&&(c.expression=u(c.expression));e[++i]=r?_(c):c}}return e.length=i+1,o;function u(e){var n=d(l,e,1);if(!n)return e;o=!0;var t=e.tail_node();return n[n.length-1]!==t&&n.push(t.left),we(e,n)}function _(e){return e.transform(new TreeTransformer(function(e,n,t){var i;return e instanceof AST_Definitions?r!==e&&r.TYPE==e.TYPE&&!((i=this.parent())instanceof AST_ForEnumeration&&i.init===e)&&W(e)?(r.definitions=r.definitions.concat(e.definitions),o=!0,i instanceof AST_For&&i.init===e?null:t?List.skip:ke(AST_EmptyStatement,e)):e:!(e instanceof AST_ExportDeclaration)&&!(e instanceof AST_Scope)&&is_statement(e)?void 0:e}))}}(e)?i:8)&&8==r)break;!S.option("collapse_vars")||!function(i,_){if(!ve.pinned()){for(var S,z,U=new Dictionary,p=[],j=!1,d=new Dictionary,r=i.length,l=new TreeTransformer(function(e,n){if(D)return e;if(!w){if(e===A[T]){if(++T<A.length)return O(e,l);w=!0,(u=(h?F:te)(e,0))===e&&(D=!0)}return e}var t,i,r,o=l.parent();if(!m&&ee(e,o)&&(m=o),I&&V&&C&&!m&&e instanceof AST_Assign&&"="!=e.operator&&e.left.equals(v))return E++,j=!0,AST_Node.info("Cascading {this} [{start}]",e),C=!1,b=ue(v),e.right.transform(l),ce(s),i=D?s:(D=!0,ke(AST_Binary,s,{operator:I,left:v.fixed&&v.definition().fixed?v.fixed.to_binary(s):v,right:k})),ke(AST_Assign,e,{operator:"=",left:e.left,right:ke(AST_Binary,e,{operator:e.operator.slice(0,-1),left:i,right:e.right})});if(function(n,e){if(n===k)return 1;if(e instanceof AST_For&&n!==e.init)return 1;if(n instanceof AST_Assign)return"="!=n.operator&&v.equals(n.left);if(n instanceof AST_BlockStatement)return K&&!all(K,function(e){return n!==e});if(n instanceof AST_Call)return v instanceof AST_PropAccess&&v.equals(n.expression)&&(!(k instanceof AST_LambdaExpression)||k.contains_this());return n instanceof AST_Class?!_.has_directive("use strict"):n instanceof AST_Debugger||(n instanceof AST_Defun?M&&v.name===n.name.name:n instanceof AST_DestructuredKeyVal?n.key instanceof AST_Node:n instanceof AST_DWLoop||n instanceof AST_LoopControl||n instanceof AST_Try||n instanceof AST_With)}(e,o))return D=!0,e;if(e.single_use)return e;if(e instanceof AST_SymbolDeclaration||!(V&&v.equals(e)||g&&(t=g(e,this))))return function(e,n){if(e instanceof AST_SymbolRef){if(e.is_declared(_)){if(e.fixed_value())return;if(be(e))return!(n instanceof AST_PropAccess&&n.expression===e)&&ge(e.definition())}else if(Z(e,n))return;if(!Q)return 1;g=!1}return}(e,o)?(D=!0,e):((ne(e,o)||H(e))&&(u=e)instanceof AST_Scope&&(D=!0),e instanceof AST_Accessor||e instanceof AST_Destructured?(r=C,C=!1,n(e,l),C=r,R(e)):e instanceof AST_DefaultValue?(e.name=e.name.transform(l),r=C,C=!1,e.value=e.value.transform(l),C=r,R(e)):!(e instanceof AST_BlockScope)||e instanceof AST_Scope||e.variables&&e.variables.all(function(e){return!G.has(e.name)&&!b.has(e.name)})?O(e,l)?R(e):void 0:(r=C,C=!1,O(e,l)||n(e,l),C=r,R(e)));if(!C||m&&(t||!X||!Q))return t||h||(D=!0),e;if(is_lhs(e,o))return h&&!t&&(c=!0),e;if(!t&&L&&e.fixed!==v.fixed)return D=!0,e;if(h)return m&&0==f&&(f=a-E),t||E++,e;if(E++,j=D=!0,AST_Node.info("Collapsing {this} [{start}]",e),"Binary"==s.TYPE)return le(s,e),ke(AST_Assign,s,{operator:"=",left:s.right.left,right:ke(AST_Conditional,s,"&&"==s.operator?{condition:s.left,consequent:s.right.right,alternative:e}:{condition:s.left,consequent:e,alternative:s.right.right})});if(s instanceof AST_UnaryPostfix)return ke(AST_UnaryPrefix,s,{operator:s.operator,expression:v.fixed&&v.definition().fixed?v.fixed.to_prefix(s):v});if(s instanceof AST_UnaryPrefix)return ce(s),s;if(le(k,e),s instanceof AST_VarDef)return(i=s.name.definition()).references.length-i.replaced!=1||_.exposed(i)?ke(AST_Assign,s,{operator:"=",left:e,right:k}):(i.replaced++,De(o,e,k));ce(k);n=s.clone();return n.right=k,n},R),o=new TreeTransformer(function(e){if(D)return e;if(!w){if(e!==A[T])return e;switch(T++,A.length-T){case 0:if(w=!0,c)return e;if(e!==s)return e;if(e instanceof AST_VarDef)return e;N.replaced++;var n=o.parent();return n instanceof AST_Sequence&&n.tail_node()!==e?(h.replaced++,k===x?List.skip:we(x,x.expressions.slice(0,-1))):k;case 1:if(!c&&e.body===s)return w=!0,N.replaced++,h.replaced++,null;default:return O(e,o)}}if(e instanceof AST_SymbolRef&&e.definition()===N){if(is_lhs(e,o.parent()))return e;--E||(D=!0),AST_Node.info("Replacing {this} [{start}]",e);var t=k.clone();return(t.scope=e.scope,t.reference(),E==f)?(D=!0,ke(AST_Assign,s,{operator:"=",left:e,right:t})):(N.replaced++,t)}return e instanceof AST_Default||e instanceof AST_Scope?e:void 0},function(e){return _e(e,o)});0<=--r;){0==r&&_.option("unused")&&!function(){if(!1!==Te){var e=_.parent(),i=_.self();if(void 0===Te){if(!(i instanceof AST_LambdaExpression)||is_generator(i)||i.uses_arguments||i.pinned()||!(e instanceof AST_Call)||e.expression!==i||!all(e.args,function(e){return!(e instanceof AST_Spread)}))return Te=!1;if(!Fe(e))return;Te=!0}for(var r,o=i.in_strict_mode(_)&&!i.parent_scope.resolve(!0).in_strict_mode(_),a=(is_async(i)?(r=function(e){return e instanceof AST_Symbol&&"await"==e.name},Ae=!0):(r=function(e){return e instanceof AST_Await&&!n.find_parent(AST_Scope)},void 0===Ae&&(Ae=Be(_,1,e,null,!0,!0))),null),n=new TreeWalker(function(e,n){var t;return!l||(r(e)||e instanceof AST_Yield?!(l=null):e instanceof AST_ObjectIdentity?(!o&&a||(l=null),!0):e instanceof AST_SymbolRef?((e.in_arg&&!On(e.definition())||(t=i.variables.get(e.name))&&t!==e.definition())&&(l=null),!0):e instanceof AST_Scope&&!is_arrow(e)?(t=a,a=e,n(),a=t,!0):void 0)}),t=(S=e.args.slice()).length,s=new Dictionary,f=i.argnames.length;0<=--f;){var c=i.argnames[f],l=S[f],u=null;if(c instanceof AST_DefaultValue&&(u=c.value,c=c.name,S[t+f]=u),c instanceof AST_Destructured){if(Ae&&B(function(e){return e.has_side_effects(_)},c,l)){p.length=0;break}S[t+f]=i.argnames[f]}else s.has(c.name)||(s.set(c.name,!0),(l=u?Ce(l)?u:null:l)||u?l instanceof AST_Lambda&&l.pinned()?l=null:l&&l.walk(n):l=ke(AST_Undefined,c).transform(_),l&&((c=ke(AST_VarDef,c,{name:c,value:l})).name_index=f,c.arg_index=u?t+f:f,p.unshift([c])))}i.rest&&S.push(i.rest)}}();var A=[];for(P(i[r]);0<p.length;){A=p.pop();var a,T=0,s=A[A.length-1],f=-1,c=!1,L=!1,h=null,u=null,m=null,v=function(n){if(n instanceof AST_Assign)return(t=n.left)instanceof AST_SymbolRef&&(i=t.definition(),ve.uses_arguments&&is_funarg(i)||_.exposed(i)||(a=ae(i),i.fixed&&t.fixed&&(e=i.references.filter(function(e){return e.fixed===t.fixed}).length-1)<a&&(a=e,L=!(f=0)),"="==n.operator&&oe(n.right))),t;if(n instanceof AST_Binary)return n.right.left;if(n instanceof AST_Unary)return n.expression;if(n instanceof AST_VarDef){var t,e,i=(t=n.name).definition();if(!i.const_redefs)if(member(t,i.orig))if(!ve.uses_arguments||!is_funarg(i))return e=i.orig.length-i.eliminated-(d.get(i.name)||0),a=ae(i),i.fixed&&(a=Math.min(a,i.references.filter(function(e){return!e.fixed||!e.fixed.assigns||(e=e.fixed.assigns[0])===t||se(e)===n.value}).length)),1<e&&!(t instanceof AST_SymbolFunarg)?(oe(n.value),ke(AST_SymbolRef,t)):oe(n.value)||1==a&&!_.exposed(i)?ke(AST_SymbolRef,t):void 0}}(s),y=v&&v.has_side_effects(_),V=v&&(!y||v instanceof AST_SymbolRef)&&!Pe(v,_),g=function(n){if(!(n instanceof AST_Assign&&n.right.single_use)){for(var t,i=Object.create(null),e=new TreeWalker(function(e){e instanceof AST_SymbolRef&&(i[e.definition().id]=!0)});n instanceof AST_Assign&&"="==n.operator;)n.left.walk(e),n=n.right;if(n instanceof AST_ObjectIdentity)return o;if(n instanceof AST_SymbolRef)return(r=n.evaluate(_))===n?o:fe(r,o);if(n.is_truthy())return fe(!0,return_false);if(n.is_constant()){var r=n.evaluate(_);if(!(r instanceof AST_Node))return fe(r,o)}return v instanceof AST_SymbolRef?!!function e(n){if(n instanceof AST_Array)return!1;if(n instanceof AST_Binary&&Ne[n.operator])return e(n.left)&&e(n.right);if(n instanceof AST_Call)return!1;if(n instanceof AST_Conditional)return e(n.consequent)&&e(n.alternative);if(n instanceof AST_Object)return!1;return!n.has_side_effects(_)}(n)&&(n.walk(new TreeWalker(function(e){if(t)return!0;e instanceof AST_SymbolRef&&i[e.definition().id]&&(t=!0)})),!t)&&o:!1}function o(e){return n.equals(e)}}(s);if(V||g){var I=s instanceof AST_Assign&&s.operator.slice(0,-1),M=s.name instanceof AST_SymbolFunarg,H=return_false;if(s.may_throw(_)){if(M&&is_async(ve))continue;H=me?function(e){return e.has_side_effects(_)}:t}var W=!1,Y=!1,K=function(e){if(e instanceof AST_SymbolDeclaration||e instanceof AST_SymbolRef||e instanceof AST_Destructured){var n=[];if(e.mark_symbol(function(e){var t,i;e instanceof AST_Symbol&&(e=e.definition(),t=e.scope.resolve(),i=!1,e=e.orig.reduce(function(e,n){return n instanceof AST_SymbolDefun?n.scope!==t&&push_uniq(e,n.scope):i=!0,e},[]),i)&&e.forEach(function(e){push_uniq(n,e)})}),0!=n.length)return n}}(v),G=new Dictionary,$=!0,b=ue(s),X=function(e){var n=root_expr(e);return n instanceof AST_SymbolRef&&n.definition().scope.resolve()===ve&&(!he||!I&&!(s instanceof AST_Unary||(n=b.get(n.name))&&n[0]!==e))}(v),x=se(s),k=x,J=(y||(!I&&k instanceof AST_Sequence&&(k=k.tail_node()),y=!(s instanceof AST_Unary)&&k.has_side_effects(_)),me||!X?function(e){return e instanceof AST_Destructured}:return_false),Q=function(e){if(e instanceof AST_Unary)return!1;if(y)return!1;if(!h){if(!(v instanceof AST_SymbolRef))return!1;var n;if(e instanceof AST_VarDef)n=1;else{if("="!=e.operator)return!1;n=2}e=v.definition();if(e.references.length-e.replaced!=n){if(!e.fixed)return!1;if(!v.fixed)return!1;var t=v.fixed.assigns,i=0;if(!all(e.references,function(e,n){e=e.fixed;return!!e&&!e.to_binary&&!e.to_prefix&&(e===v.fixed?(i++,!0):t&&e.assigns&&t[0]!==e.assigns[0])}))return!1;if(i!=n)return!1;L=!0}}return!0}(s),w=M,D=!1,E=0,C=!S||!w;if(!C){for(var n=s.arg_index+1;!D&&n<S.length;n++)S[n]&&S[n].transform(l);C=!0}for(var e=r;!D&&e<i.length;e++)i[e].transform(l);if(h){if(!E||E+c<a){p.push(A),z=!0;continue}E==f&&(c=!0);var N=v.definition();D=!1,T=0,w=M;for(e=r;!D&&e<i.length;e++)i[e].transform(o)||i.splice(e--,1);E=s instanceof AST_VarDef&&s===A[A.length-1]&&N.references.length==N.replaced&&!_.exposed(N),h.last_ref=!1,h.single_use=!1,j=!0}E&&!function(e){var n,t,f,c,l,u=k===x?null:we(x,x.expressions.slice(0,-1)),e=e.name_index;0<=e?(t=ve.argnames[e])instanceof AST_DefaultValue?(ve.argnames[e]=t=t.clone(),t.value=u||ke(AST_Number,t,{value:0})):(n=_.parent().args)[e]&&(ve.argnames[e]=t.clone(),n[e]=u||ke(AST_Number,n[e],{value:0})):(f=A.length-1,c=A[f],(c instanceof AST_VarDef||A[f-1].body===c)&&f--,l=new TreeTransformer(function(e,n,t){var i,r,o,a,s;return w||e!==A[T]?e:++T<=f?O(e,l):(w=!0,e instanceof AST_Definitions?(d.set(c.name.name,(d.get(c.name.name)||0)+1),h&&h.replaced++,r=(i=e.definitions).indexOf(c),(o=c.clone()).value=null,u?(a=[ke(AST_SimpleStatement,u,{body:u})],0<r&&((s=e.clone()).definitions=i.slice(0,r),a.unshift(s),(e=e.clone()).definitions=i.slice(r)),a.push(e),e.definitions[0]=o,t?List.splice(a):ke(AST_BlockStatement,e,{body:a})):(e.definitions[r]=o,e)):u?is_statement(e)?ke(AST_SimpleStatement,u,{body:u}):u:t?List.skip:null)},function(e,n){return e instanceof AST_For?Ue(e,n):_e(e,l)}),w=D=!1,T=0,(i[r]=i[r].transform(l))||i.splice(r,1))}(s)}}}return j}function R(e){return D||(u===e&&(D=!0),m===e&&(m=null)),e}function O(e,n){if(e instanceof AST_BlockScope){if(e instanceof AST_Scope)return e;if(e instanceof AST_Class){for(var t=C,i=(C=!1,e.name&&e.name.transform(n),!D&&e.extends&&e.extends.transform(n),[]),r=[],o=0;!D&&o<e.properties.length;o++){var a=e.properties[o];a.key instanceof AST_Node&&(a.key=a.key.transform(n)),a.static&&(a instanceof AST_ClassField?a.value&&i.push(a):a instanceof AST_ClassInit&&[].push.apply(r,a.value.body))}for(o=0;!D&&o<r.length;o++)r[o].transform(n);for(o=0;!D&&o<i.length;o++)i[o].value.transform(n);return C=t,e}if(e instanceof AST_ForEnumeration)return e.object=e.object.transform(n),D=!0,e;if(e instanceof AST_Switch){e.expression=e.expression.transform(n);for(o=0;!D&&o<e.body.length;o++){var s=e.body[o];if(s instanceof AST_Case){if(!w){if(s!==A[T])continue;T++}if(s.expression=s.expression.transform(n),!Q||L)break;g=!1}}return D=!0,e}}}function Z(e,n){return n instanceof AST_Assign?"="==n.operator&&n.left===e:n instanceof AST_DefaultValue?n.name===e:n instanceof AST_DestructuredArray||n instanceof AST_DestructuredKeyVal&&n.value===e}function ee(e,n){return n instanceof AST_Assign?n.left!==e&&Ne[n.operator.slice(0,-1)]:n instanceof AST_Binary?n.left!==e&&Ne[n.operator]:n instanceof AST_Call?n.optional&&n.expression!==e:n instanceof AST_Case?n.expression!==e:n instanceof AST_Conditional||n instanceof AST_If?n.condition!==e:n instanceof AST_Sub&&n.optional&&n.expression!==e}function ne(e,n){if(e instanceof AST_Await)return 1;if("Binary"==e.TYPE)return!Gn(e,_);if(e instanceof AST_Call){var t=e.expression;if(t instanceof AST_SymbolRef&&(f=t.definition(),t=t.fixed_value()),!(t instanceof AST_Lambda))return!e.is_expr_pure(_);if(!f||!Qn(_,f,t)){if(t.collapse_scanning)return;t.collapse_scanning=!0;for(var i=C,r=(C=!1,u),o=m,a=0;!D&&a<t.argnames.length;a++)B(c,t.argnames[a],e.args[a])&&(D=!0);if(!D)if(t.rest&&B(c,t.rest,ke(AST_Array,e,{elements:e.args.slice(a)})))D=!0;else if(is_arrow(t)&&t.value)t.value.transform(l);else for(a=0;!D&&a<t.body.length;a++){var s=t.body[a];if(s instanceof AST_Return){s.value&&s.value.transform(l);break}s.transform(l)}if(m=o,u=r,C=i,t.collapse_scanning=!1,!D)return;D=!1}return 1}var f;if(e instanceof AST_Class)return me&&(o=e.extends)&&!Re(o=o instanceof AST_SymbolRef?o.fixed_value():o);if(e instanceof AST_Exit){if(me){if(me.bfinally)return 1;if(me.bcatch&&e instanceof AST_Throw)return 1}return y||v instanceof AST_PropAccess||pe(v)}if(e instanceof AST_Function)return _.option("ie")&&e.name&&b.has(e.name.name);if(e instanceof AST_ObjectIdentity)return Se(e);if(e instanceof AST_PropAccess){r=e.expression;if(_.option("unsafe")){if(Ee(r)&&qe[r.name])return;if(nn(r))return}return r instanceof AST_SymbolRef&&ge(r.definition())?1:y||!$||!h&&(me||!X)&&!e.optional&&r.may_throw_on_access(_)}return e instanceof AST_Spread||(e instanceof AST_SymbolRef?(!Ee(e)||!e.is_declared(_))&&(Se(e)?!Z(e,n):y&&pe(e)||(f=e.definition(),(me||f.scope.resolve()!==ve)&&!be(e))):e instanceof AST_Template?!e.is_expr_pure(_):e instanceof AST_VarDef?J(e.name)||(e.value||n instanceof AST_Let)&&e.name.match_symbol(function(e){return e instanceof AST_SymbolDeclaration&&(b.has(e.name)||y&&pe(e))},!0):e instanceof AST_Yield||(i=is_lhs(e.left,e))&&(i instanceof AST_PropAccess||J(i)||i.match_symbol(function(e){return e instanceof AST_PropAccess||(e instanceof AST_SymbolRef?b.has(e.name)||W&&_.exposed(e.definition()):void 0)},!0)));function c(e){return e.transform(l),D}}function B(t,e,i){return e instanceof AST_DefaultValue?t(e.value)||B(t,e.name,e.value)||!Ce(i)&&B(t,e.name,i):i?e instanceof AST_Destructured?!(!e.rest||!B(t,e.rest))||(e instanceof AST_DestructuredArray?i instanceof AST_Array?!all(e.elements,function(e,n){return!B(t,e,i[n])}):!i.is_string(_)||!all(e.elements,function(e){return!B(t,e)}):e instanceof AST_DestructuredObject?!!i.may_throw_on_access(_)||!all(e.properties,function(e){return!(e.key instanceof AST_Node&&t(e.key)||B(t,e.value))}):void 0):void 0:!(e instanceof AST_Symbol)}function P(e,n){var t,i;A.push(e),e instanceof AST_Array?e.elements.forEach(function(e){P(e,n)}):e instanceof AST_Assign?((i=e.left)instanceof AST_Destructured||p.push(A.slice()),P(i),P(e.right),i instanceof AST_SymbolRef&&"="==e.operator&&U.set(i.name,(U.get(i.name)||0)+1)):e instanceof AST_Await?P(e.expression,n):e instanceof AST_Binary?(i=Ne[e.operator],n&&i&&"??"!=e.operator&&e.right instanceof AST_Assign&&"="==e.right.operator&&!(e.right.left instanceof AST_Destructured)&&p.push(A.slice()),P(e.left,!i&&n),P(e.right,n)):e instanceof AST_Call?(P(e.expression),e.args.forEach(P)):e instanceof AST_Case?P(e.expression):e instanceof AST_Conditional?(P(e.condition),P(e.consequent,n),P(e.alternative,n)):e instanceof AST_Definitions?e.definitions.forEach(P):e instanceof AST_Dot?P(e.expression):e instanceof AST_DWLoop?(P(e.condition),e.body instanceof AST_Block||P(e.body)):e instanceof AST_Exit?e.value&&P(e.value):e instanceof AST_For?(e.init&&P(e.init,!0),e.condition&&P(e.condition),e.step&&P(e.step,!0),e.body instanceof AST_Block||P(e.body)):e instanceof AST_ForEnumeration?(P(e.object),e.body instanceof AST_Block||P(e.body)):e instanceof AST_If?(P(e.condition),e.body instanceof AST_Block||P(e.body),!e.alternative||e.alternative instanceof AST_Block||P(e.alternative)):e instanceof AST_Object?e.properties.forEach(function(e){A.push(e),e.key instanceof AST_Node&&P(e.key),e instanceof AST_ObjectKeyVal&&P(e.value,n),A.pop()}):e instanceof AST_Sequence?(t=e.expressions.length-(n?0:1),e.expressions.forEach(function(e,n){P(e,n<t)})):e instanceof AST_SimpleStatement?P(e.body,!0):e instanceof AST_Spread?P(e.expression):e instanceof AST_Sub?(P(e.expression),P(e.property)):e instanceof AST_Switch?(P(e.expression),e.body.forEach(P)):e instanceof AST_Unary?UNARY_POSTFIX[e.operator]?p.push(A.slice()):P(e.expression):e instanceof AST_VarDef?(e.name instanceof AST_SymbolVar&&(e.value?(i=e.name.definition()).references.length>i.replaced&&p.push(A.slice()):d.set(e.name.name,(d.get(e.name.name)||0)+1)),e.value&&P(e.value)):e instanceof AST_Yield&&e.expression&&P(e.expression),A.pop()}function te(e,n){var t=l.parent(n);return t instanceof AST_Array||t instanceof AST_Assign||t instanceof AST_Await||t instanceof AST_Binary||t instanceof AST_Call||t instanceof AST_Case||t instanceof AST_Conditional?e:t instanceof AST_Definitions?q(t,n+1):t instanceof AST_Exit||t instanceof AST_If||t instanceof AST_IterationStatement||t instanceof AST_ObjectProperty||t instanceof AST_PropAccess?e:t instanceof AST_Sequence?(t.tail_node()===e?te:q)(t,n+1):t instanceof AST_SimpleStatement?q(t,n+1):t instanceof AST_Spread||t instanceof AST_Switch||t instanceof AST_Unary||t instanceof AST_VarDef||t instanceof AST_Yield?e:null}function ie(e,n,t){for(var i;i=e,(e=l.parent(++t))instanceof AST_Assign&&e.operator.slice(0,-1)==n||e instanceof AST_Binary&&e.operator==n;);return i}function re(e,n,t,i,r){var o=C,a=(C=!1,u),s=m,f=l.stack;return l.stack=[i],e.transform(l),l.stack=f,m=s,u=a,C=o,D?(D=!1,t):n(i,r+1)}function F(e,n){var t,i=l.parent(n);return i instanceof AST_Array?F(i,n+1):i instanceof AST_Assign?H(i)||i.left.match_symbol(function(e){return e instanceof AST_SymbolRef&&(v.name==e.name||h.name==e.name)})?e:i.left!==e&&Ne[t=i.operator.slice(0,-1)]?ie(i,t,n):F(i,n+1):i instanceof AST_Await?F(i,n+1):i instanceof AST_Binary?i.left!==e&&Ne[t=i.operator]?ie(i,t,n):F(i,n+1):i instanceof AST_Call?i:i instanceof AST_Case?i.expression!==e?e:F(i,n+1):i instanceof AST_Conditional?i.condition!==e?e:F(i,n+1):i instanceof AST_Definitions?q(i,n+1):i instanceof AST_Do?e:i instanceof AST_Exit?q(i,n+1):i instanceof AST_For?i.init!==e&&i.condition!==e?e:F(i,n+1):i instanceof AST_ForEnumeration?i.init!==e?e:F(i,n+1):i instanceof AST_If?i.condition!==e?e:F(i,n+1):i instanceof AST_ObjectProperty?(t=l.parent(n+1),all(t.properties,function(e){return e instanceof AST_ObjectKeyVal})?F(t,n+2):t):i instanceof AST_PropAccess?i.expression===e?F(i,n+1):e:i instanceof AST_Sequence?(i.tail_node()===e?F:q)(i,n+1):i instanceof AST_SimpleStatement?q(i,n+1):i instanceof AST_Spread?F(i,n+1):i instanceof AST_Switch?i.expression!==e?e:F(i,n+1):i instanceof AST_Unary?"delete"==i.operator?e:F(i,n+1):i instanceof AST_VarDef?i.name.match_symbol(function(e){return e instanceof AST_SymbolDeclaration&&(v.name==e.name||h.name==e.name)})?e:F(i,n+1):i instanceof AST_While?i.condition!==e?e:F(i,n+1):i instanceof AST_Yield?F(i,n+1):null}function q(n,t){var e,i=l.parent(t);return ne(n,i)||ee(n,i)?n:i instanceof AST_Array?q(i,t+1):i instanceof AST_Assign?r(i.left):i instanceof AST_Await?n:i instanceof AST_Binary||i instanceof AST_Call||i instanceof AST_Case||i instanceof AST_Conditional||i instanceof AST_Definitions||i instanceof AST_Exit||i instanceof AST_If?q(i,t+1):i instanceof AST_IterationStatement?n:i instanceof AST_ObjectProperty?(e=l.parent(t+1),all(e.properties,function(e){return e instanceof AST_ObjectKeyVal})?q(e,t+2):e):i instanceof AST_PropAccess?(e=i.expression)===n?q(i,t+1):re(e,q,n,i,t):i instanceof AST_Sequence||i instanceof AST_SimpleStatement?q(i,t+1):i instanceof AST_Spread?n:i instanceof AST_Switch||i instanceof AST_Unary?q(i,t+1):i instanceof AST_VarDef?r(i.name):i instanceof AST_Yield?n:null;function r(e){return H(i)?n:e!==n&&e instanceof AST_Destructured?re(e,q,n,i,t):q(i,t+1)}}function oe(e){if(z)z=!1;else if(!(a<1)){var n=(e=e.tail_node())instanceof AST_Assign&&"="==e.operator?e.left:e;if(n instanceof AST_SymbolRef){var t=n.definition();if(!t.undeclared&&!ge(t)){if(n!==e){if(Pe(n,_))return;if(t.references.length-t.replaced<2)return;e=s.clone();e[e instanceof AST_Assign?"right":"value"]=n,0<=s.name_index&&(e.name_index=s.name_index,e.arg_index=s.arg_index),s=e}return h=t}}}}function ae(e){return e.references.length-e.replaced-(U.get(e.name)||0)}function se(e){var n;return e instanceof AST_Assign?e.right:e instanceof AST_Binary?((n=e.clone()).right=e.right.right,n):e instanceof AST_VarDef?e.value:void 0}function fe(t,i){return function(e,n){if(n.in_boolean_context()){if(t&&e.is_truthy()&&!e.has_side_effects(_))return!0;if(e.is_constant()){n=e.evaluate(_);if(!(n instanceof AST_Node))return!n==!t}}return i(e)}}function ce(e){for(;e.write_only&&(e.write_only=!1,e instanceof AST_Assign);)e=e.right}function le(e,n){var t=n instanceof AST_SymbolRef&&!n.defined,i=n.scope||xe(l)||de;e.walk(new TreeWalker(function(e){if(e instanceof AST_BlockScope)return!0;e instanceof AST_Symbol&&(t&&e instanceof AST_SymbolRef&&(e.defined=!1),e.scope=i)}))}function ue(s){var f=new Dictionary,c=(s instanceof AST_VarDef&&(s.name.definition().fixed||($=!1),f.add(s.name.name,v)),ve.uses_arguments&&!_.has_directive("use strict")),l=ve instanceof AST_Toplevel,u=new TreeWalker(function(n){var e,t,i;if(n instanceof AST_SymbolRef?(e=n.fixed_value())||(t=(e=n).definition(),i=n.fixed&&n.fixed.escaped||t.escaped,t.undeclared)||!t.assignments&&i&&!i.cross_scope||!Oe(t,n.scope,n,u.parent())&&Zn(t)||($=!1):n instanceof AST_ObjectIdentity&&(e=n),e)f.add(n.name,ye(_,u,n,e,0));else{if(n instanceof AST_Lambda){for(var r,o=0,a=n;r=u.parent(o++);a=r){if(r instanceof AST_Assign){if(r.left===a)break;if("="==r.operator)continue;if(Ne[r.operator.slice(0,-1)])continue;break}if(r instanceof AST_Binary){if(Ne[r.operator])continue;break}if(r instanceof AST_Call)return;if(r instanceof AST_Scope)return;if(r instanceof AST_Sequence){if(r.tail_node()===a)continue;break}if(r instanceof AST_Template){if(r.tag)return;break}}return n.enclosed.forEach(function(e){e.scope!==n&&G.set(e.name,!0)}),!0}c&&n instanceof AST_Sub&&(ve.each_argname(function(e){_.option("reduce_vars")&&!e.definition().assignments||(e.definition().fixed||($=!1),f.add(e.name,!0))}),c=!1)}l&&("Call"==n.TYPE?Y||(i=n.expression)instanceof AST_PropAccess||i instanceof AST_LambdaExpression&&!i.contains_this()||(Y=!0):n instanceof AST_PropAccess&&function e(n){return n instanceof AST_SymbolRef&&!(n=n.fixed_value())||(n instanceof AST_Assign?"="==n.operator&&e(n.right):n instanceof AST_PropAccess||n instanceof AST_ObjectIdentity)}(n.expression)&&(n!==v||s instanceof AST_Unary?W=!0:Y=!0))});return s.walk(u),f}function _e(e,n){if(e instanceof AST_Sequence)switch(e.expressions.length){case 0:return null;case 1:return De(n.parent(),e,e.expressions[0])}}function Se(e){e=b.get(e.name);if(e&&!all(e,function(e){return!e}))return e[0]!==v||void(g=!1)}function pe(e){e=e.definition();return!(1==e.orig.length&&e.orig[0]instanceof AST_SymbolDefun||e.scope.resolve()===ve&&(!Y||!_.exposed(e))&&all(e.references,function(e){return e.scope.resolve(!0)===ve}))}function t(e,n){if(e instanceof AST_Assign)return t(e.left,!0);if(e instanceof AST_Unary)return t(e.expression,!0);if(e instanceof AST_VarDef)return e.value&&t(e.value);if(n){if(e instanceof AST_Dot)return t(e.expression,!0);if(e instanceof AST_Sub)return t(e.expression,!0);if(e instanceof AST_SymbolRef)return e.definition().scope.resolve()!==ve}return!1}}(e,S)||(i=9)}while(i&&0<o--);return e;function O(e,n){var t,i,r=e.self(),o=0;do{r instanceof AST_Catch?r=e.parent(o++):r instanceof AST_LabeledStatement?r=r.body:r instanceof AST_SwitchBranch&&((i=e.parent(o)).body[i.body.length-1]!==r&&!function(e){for(var n=e.length;0<=--n;)if(e[n]instanceof AST_Break)return 1;return}(r.body)||(o++,r=i));do{if(n(t=r))return t}while((r=e.parent(o++))instanceof AST_If)}while(t&&(r instanceof AST_BlockStatement||r instanceof AST_Catch||r instanceof AST_Scope||r instanceof AST_SwitchBranch||r instanceof AST_Try)&&ze(r.body,t))}function p(e,n){if(!(e instanceof AST_BlockStatement))return e;for(var t=null,i=0;i<e.body.length;i++){var r=e.body[i];if(r instanceof AST_Var&&W(r))n.push(r);else{if(t||oe(r))return!1;t=r}}return t}function u(e){return e instanceof AST_Assign?[e]:e instanceof AST_Sequence?e.expressions.slice():void 0}function d(e,n,t){var i=u(n);if(i){for(var r=!1,o=i.length-(t=t||0);0<=--o;)if(l(f=i[o])){if(f.left instanceof AST_SymbolRef)a=i.slice(o+1);else{if(!(f.left instanceof AST_PropAccess&&l(f.left.expression)))continue;var a=i.slice(o+1),s=f.clone(),f=f.left.expression;s.left=s.left.clone(),s.left.expression=f.left.clone(),a.unshift(s)}0!=a.length&&T(f.left,f.right,a)&&(r=!0,i=i.slice(0,o).concat(f,a))}if(e instanceof AST_Definitions){for(o=e.definitions.length;0<=--o;){var c=e.definitions[o];if(c.value){T(c.name,c.value,i)&&(r=!0),!function(e,n,t){if(S.option("conditionals")&&!(e.name instanceof AST_Destructured)){for(var i=!1,r=e.name.definition();n.length>t;){var o=In(S,r,e.value,n[0]);if(!o)break;e.value=o,n.shift(),i=!0}return i}}(c,i,t)||(r=!0);break}}e instanceof AST_Var&&_(e.definitions,i,t)&&(r=!0)}return r&&i}function l(e){return e instanceof AST_Assign&&"="==e.operator}}function A(e,n){if(e instanceof AST_SimpleStatement&&!W(n)){e=u(e.body);if(e){var t=[];if(_(t,e.reverse(),0))return n.definitions=t.reverse().concat(n.definitions),e.reverse()}}}function _(e,n,t){for(var i=!1;n.length>t;){var r=n[0];if(!(r instanceof AST_Assign))break;if("="!=r.operator)break;var o=r.left;if(!(o instanceof AST_SymbolRef))break;if(Ee(o))break;if(o.scope.resolve()!==ve)break;var a=o.definition();if(a.scope!==ve)break;if(a.orig.length>a.eliminated+1)break;if("SymbolVar"!=a.orig[0].TYPE)break;o=ke(AST_SymbolVar,o);e.push(ke(AST_VarDef,r,{name:o,value:r.right})),a.orig.push(o),a.replaced++,n.shift(),i=!0}return i}function T(e,s,n){var f=new Dictionary;for(f.set(e.name,!0);s instanceof AST_Assign&&"="==s.operator;)s.left instanceof AST_SymbolRef&&f.set(s.left.name,!0),s=s.right;if(s instanceof AST_Array){var t=!1;do{if(!function e(n){if(!(n instanceof AST_Assign))return;if("="!=n.operator)return;if(!(n.left instanceof AST_PropAccess))return;var t=n.left.expression;if(!(t instanceof AST_SymbolRef))return;if(!f.has(t.name))return;if(!n.right.is_constant_expression(ve))return;var i=n.left.property;i instanceof AST_Node&&(i=(i=e(i)?n.left.property=i.right.clone():i).evaluate(S));if(i instanceof AST_Node)return;if(!y.test(""+i))return;i=+i;var r=s.elements;var o=r.length;if(o+4<i)return;for(var a=Math.min(o,i+1);0<=--a;)if(r[a]instanceof AST_Spread)return;if(i<o){t=r[i].drop_side_effect_free(S);r[i]=t?we(n,[t,n.right]):n.right}else{for(;o<i;)r[o++]=ke(AST_Hole,s);r[i]=n.right}return!0}(n[0]))break}while(n.shift(),t=!0,n.length);return t}if(s instanceof AST_Object){t=!1;do{if(!function e(n){if(!(n instanceof AST_Assign))return;if("="!=n.operator)return;if(!(n.left instanceof AST_PropAccess))return;var t=n.left.expression;if(!(t instanceof AST_SymbolRef))return;if(!f.has(t.name))return;if(!n.right.is_constant_expression(ve))return;var i=n.left.property;i instanceof AST_Node&&(i=(i=e(i)?n.left.property=i.right.clone():i).evaluate(S));if(i instanceof AST_Node)return;i=""+i;t="__proto__"==i||S.has_directive("use strict")?function(e){e=e.key;return"string"==typeof e&&e!=i&&"__proto__"!=e}:function(e){var n=e.key;return e instanceof AST_ObjectGetter||e instanceof AST_ObjectSetter?"string"==typeof n&&n!=i:"__proto__"!==n};if(!all(s.properties,t))return;s.properties.push(ke(AST_ObjectKeyVal,n,{key:i,value:n.right}));return!0}(n[0]))break}while(n.shift(),t=!0,n.length);return t}}}function C(i,r,o){var a,s=!1;function f(e){a?(a.push(e),ae(e)||(a.required=!0)):o.push(e)}r.walk(new TreeWalker(function(e,n){var t;return e instanceof AST_DefClass?(e.extends=null,e.properties=[],f(e),!0):e instanceof AST_Definitions?(e.remove_initializers(i,t=[])&&AST_Node.warn("Dropping initialization in unreachable code [{start}]",e),0<t.length&&(e.definitions=t,f(e)),!0):e instanceof AST_LambdaDefinition?(f(e),!0):e instanceof AST_Scope||(e instanceof AST_BlockScope?(t=a,a=[],n(),a.required?o.push(ke(AST_BlockStatement,r,{body:a})):a.length&&[].push.apply(o,a),a=t,!0):void(e instanceof AST_LoopControl||(s=!0)))})),s&&AST_Node.warn("Dropping unreachable code [{start}]",r)}function Ce(e,n){return null==e||e.is_undefined||e instanceof AST_Undefined||e instanceof AST_UnaryPrefix&&"void"==e.operator&&(!n||!e.expression.has_side_effects(n))}function ve(e,n,t){switch(e){case"-":return n.is_negative_zero()&&(!(t instanceof AST_Constant)||0==t.value);case"&&":case"||":return n.is_negative_zero()||t.is_negative_zero();case"*":case"/":case"%":case"**":return!0;default:return!1}}function je(e,n){return n||/strict/.test(e.option("pure_getters"))}function Le(e,n,t){switch(n){case"&&":return t.left.is_defined(e)&&t.right.is_defined(e);case"||":return t.left.is_truthy()||t.right.is_defined(e);case"??":return t.left.is_defined(e)||t.right.is_defined(e);default:return!0}}AST_SymbolRef.DEFMETHOD("is_declared",function(e){return this.defined||!this.definition().undeclared||e.option("unsafe")&&qe[this.name]}),(n=function(e,n){e.DEFMETHOD("in_strict_mode",n)})(AST_Class,return_true),n(AST_Scope,function(e){for(var n=this.body,t=0;t<n.length;t++){var i=n[t];if(!(i instanceof AST_Directive))break;if("use strict"==i.value)return!0}var r=this.parent_scope;return r?r.resolve(!0).in_strict_mode(e):e.option("module")}),(n=function(e,n){e.DEFMETHOD("is_truthy",n)})(AST_Node,return_false),n(AST_Array,return_true),n(AST_Assign,function(){return"="==this.operator&&this.right.is_truthy()}),n(AST_Lambda,return_true),n(AST_Object,return_true),n(AST_RegExp,return_true),n(AST_Sequence,function(){return this.tail_node().is_truthy()}),n(AST_SymbolRef,function(){var e=this.fixed_value();if(!e)return!1;this.is_truthy=return_false;e=e.is_truthy();return delete this.is_truthy,e}),(n=function(e,n){e.DEFMETHOD("is_negative_zero",n)})(AST_Node,return_true),n(AST_Array,return_false),n(AST_Assign,function(){var e=this.operator;return"="==e?this.right.is_negative_zero():ve(e.slice(0,-1),this.left,this.right)}),n(AST_Binary,function(){return ve(this.operator,this.left,this.right)}),n(AST_Constant,function(){return 0==this.value&&1/this.value<0}),n(AST_Lambda,return_false),n(AST_Object,return_false),n(AST_RegExp,return_false),n(AST_Sequence,function(){return this.tail_node().is_negative_zero()}),n(AST_SymbolRef,function(){var e=this.fixed_value();if(!e)return!0;this.is_negative_zero=return_true;e=e.is_negative_zero();return delete this.is_negative_zero,e}),n(AST_UnaryPrefix,function(){return"+"==this.operator&&this.expression.is_negative_zero()||"-"==this.operator}),n=function(e,n){e.DEFMETHOD("_dot_throw",n)},AST_Node.DEFMETHOD("may_throw_on_access",function(e,n){return!e.option("pure_getters")||this._dot_throw(e,n)}),n(AST_Node,je),n(AST_Array,return_false),n(AST_Assign,function(e){var n=this.operator,t=this.left,i=this.right;return"="!=n?Ne[n.slice(0,-1)]&&(t._dot_throw(e)||i._dot_throw(e)):!!i._dot_throw(e)&&(!(t instanceof AST_SymbolRef&&i instanceof AST_Binary&&"||"==i.operator&&t.name==i.left.name)||i.right._dot_throw(e))}),n(AST_Binary,function(e){return Ne[this.operator]&&(this.left._dot_throw(e)||this.right._dot_throw(e))}),n(AST_Class,function(e,n){return je(e,n)&&!all(this.properties,function(e){return!!e.private||!e.static||!(e instanceof AST_ClassGetter||e instanceof AST_ClassSetter)})}),n(AST_Conditional,function(e){return this.consequent._dot_throw(e)||this.alternative._dot_throw(e)}),n(AST_Constant,return_false),n(AST_Dot,function(e,n){return!(!je(e,n)||((e=this.expression)instanceof AST_SymbolRef&&(e=e.fixed_value()),"prototype"==this.property&&w(e)))}),n(AST_Lambda,return_false),n(AST_Null,return_true),n(AST_Object,function(n,t){return je(n,t)&&!all(this.properties,function(e){return!(e instanceof AST_ObjectGetter||e instanceof AST_ObjectSetter||"__proto__"===e.key&&e.value._dot_throw(n,t))})}),n(AST_ObjectIdentity,function(e,n){return je(e,n)&&!this.scope.resolve().new}),n(AST_Sequence,function(e){return this.tail_node()._dot_throw(e)}),n(AST_SymbolRef,function(e,n){if(!this.defined){if(this.is_undefined)return!0;if(je(e,n)&&!(Ee(this)&&this.is_declared(e)||this.is_immutable())){n=this.definition();if(ge(n)&&!n.scope.rest&&all(n.scope.argnames,function(e){return e instanceof AST_SymbolFunarg}))return 2<n.scope.uses_arguments;n=this.fixed_value(!0);if(!n)return!0;if(this._dot_throw=return_true,n._dot_throw(e))return delete this._dot_throw,!0;this._dot_throw=return_false}}return!1}),n(AST_UnaryPrefix,function(){return"void"==this.operator}),n(AST_UnaryPostfix,return_false),n(AST_Undefined,return_true),(n=function(e,n){e.DEFMETHOD("is_defined",n)})(AST_Node,return_false),n(AST_Array,return_true),n(AST_Assign,function(e){var n=this.operator;return"="==n?this.right.is_defined(e):Le(e,n.slice(0,-1),this)}),n(AST_Binary,function(e){return Le(e,this.operator,this)}),n(AST_Conditional,function(e){return this.consequent.is_defined(e)&&this.alternative.is_defined(e)}),n(AST_Constant,return_true),n(AST_Hole,return_false),n(AST_Lambda,return_true),n(AST_Object,return_true),n(AST_Sequence,function(e){return this.tail_node().is_defined(e)}),n(AST_SymbolRef,function(e){if(this.is_undefined)return!1;if(Ee(this)&&this.is_declared(e))return!0;if(this.is_immutable())return!0;var n=this.fixed_value();if(!n)return!1;this.is_defined=return_false;n=n.is_defined(e);return delete this.is_defined,n}),n(AST_UnaryPrefix,function(){return"void"!=this.operator}),n(AST_UnaryPostfix,return_true),n(AST_Undefined,return_false),(n=function(e,n){e.DEFMETHOD("is_boolean",n)})(AST_Node,return_false),n(AST_Assign,function(e){return"="==this.operator&&this.right.is_boolean(e)}),ue=makePredicate("in instanceof == != === !== < <= >= >"),n(AST_Binary,function(e){return ue[this.operator]||Ne[this.operator]&&this.left.is_boolean(e)&&this.right.is_boolean(e)}),n(AST_Boolean,return_true),_e=makePredicate("every hasOwnProperty isPrototypeOf propertyIsEnumerable some"),n(AST_Call,function(e){return!!e.option("unsafe")&&(e=this.expression)instanceof AST_Dot&&(_e[e.property]||"test"==e.property&&e.expression instanceof AST_RegExp)}),n(AST_Conditional,function(e){return this.consequent.is_boolean(e)&&this.alternative.is_boolean(e)}),n(AST_New,return_false),n(AST_Sequence,function(e){return this.tail_node().is_boolean(e)}),n(AST_SymbolRef,function(e){var n=this.fixed_value();if(!n)return!1;this.is_boolean=return_false;n=n.is_boolean(e);return delete this.is_boolean,n}),Se=makePredicate("! delete"),n(AST_UnaryPrefix,function(){return Se[this.operator]}),(n=function(e,n){e.DEFMETHOD("is_number",n)})(AST_Node,return_false),pe=makePredicate("- * / % ** & | ^ << >> >>>"),n(AST_Assign,function(e){return pe[this.operator.slice(0,-1)]||"="==this.operator&&this.right.is_number(e)}),n(AST_Binary,function(e){return!!pe[this.operator]||"+"==this.operator&&(this.left.is_boolean(e)||this.left.is_number(e))&&(this.right.is_boolean(e)||this.right.is_number(e))}),de=makePredicate(["charCodeAt","getDate","getDay","getFullYear","getHours","getMilliseconds","getMinutes","getMonth","getSeconds","getTime","getTimezoneOffset","getUTCDate","getUTCDay","getUTCFullYear","getUTCHours","getUTCMilliseconds","getUTCMinutes","getUTCMonth","getUTCSeconds","getYear","indexOf","lastIndexOf","localeCompare","push","search","setDate","setFullYear","setHours","setMilliseconds","setMinutes","setMonth","setSeconds","setTime","setUTCDate","setUTCFullYear","setUTCHours","setUTCMilliseconds","setUTCMinutes","setUTCMonth","setUTCSeconds","setYear"]),n(AST_Call,function(e){return!!e.option("unsafe")&&(e=this.expression)instanceof AST_Dot&&(de[e.property]||Ee(e.expression)&&"Math"==e.expression.name)}),n(AST_Conditional,function(e){return this.consequent.is_number(e)&&this.alternative.is_number(e)}),n(AST_New,return_false),n(AST_Number,return_true),n(AST_Sequence,function(e){return this.tail_node().is_number(e)}),n(AST_SymbolRef,function(e,n){var t=this.fixed_value();if(!t)return!1;if(n&&t instanceof AST_UnaryPrefix&&"+"==t.operator&&t.expression.equals(this))return!1;this.is_number=return_false;n=t.is_number(e);return delete this.is_number,n}),Ae=makePredicate("+ - ~ ++ --"),n(AST_Unary,function(){return Ae[this.operator]}),(n=function(e,n){e.DEFMETHOD("is_string",n)})(AST_Node,return_false),n(AST_Assign,function(e){switch(this.operator){case"+=":if(this.left.is_string(e))return!0;case"=":return this.right.is_string(e)}}),n(AST_Binary,function(e){return"+"==this.operator&&(this.left.is_string(e)||this.right.is_string(e))}),Te=makePredicate(["charAt","substr","substring","toExponential","toFixed","toLowerCase","toPrecision","toString","toUpperCase","trim"]),n(AST_Call,function(e){return!!e.option("unsafe")&&(e=this.expression)instanceof AST_Dot&&Te[e.property]}),n(AST_Conditional,function(e){return this.consequent.is_string(e)&&this.alternative.is_string(e)}),n(AST_Sequence,function(e){return this.tail_node().is_string(e)}),n(AST_String,return_true),n(AST_SymbolRef,function(e){var n=this.fixed_value();if(!n)return!1;this.is_string=return_false;n=n.is_string(e);return delete this.is_string,n}),n(AST_Template,function(e){return!this.tag||et(e,this.tag)}),n(AST_UnaryPrefix,function(){return"typeof"==this.operator});var Ne=makePredicate("&& || ??");function Ve(e){AST_Node.warn("global_defs {this} redefined [{start}]",e)}function Y(e,n,t){return n.print_to_string().length-e.print_to_string().length<(t||0)?n:e}function Ie(e,n,t){return Y(ke(AST_SimpleStatement,e,{body:e}),ke(AST_SimpleStatement,n,{body:n}),t).body}function Me(e,n,t,i){return(first_in_statement(e)?Ie:Y)(n,t,i)}function He(n){var t=Object.create(null);return Object.keys(n).forEach(function(e){t[e]=makePredicate(n[e])}),t}function We(e){for(var n=0;n<e.length;n++){var t=e[n];if(!(t instanceof AST_Directive))return t}}function Ye(){return this.value?ke(AST_Return,this.value,{value:this.value}):We(this.body)}function K(e,n){var t=n.evaluate(e);return t===n?n:Me(e,n,Z(t,n).optimize(e),e.eval_threshold)}n=function(e,n){e.DEFMETHOD("_find_defs",n)},AST_Toplevel.DEFMETHOD("resolve_defines",function(o){return o.option("global_defs")?(this.figure_out_scope({ie:o.option("ie")}),this.transform(new TreeTransformer(function(e){var n=e._find_defs(o,"");if(n){for(var t,i=0,r=e;(t=this.parent(i++))&&t instanceof AST_PropAccess&&t.expression===r;)r=t;if(!is_lhs(r,t))return n;Ve(e)}}))):this}),n(AST_Node,noop),n(AST_Dot,function(e,n){return this.expression._find_defs(e,"."+this.property+n)}),n(AST_SymbolDeclaration,function(e){this.definition().global&&HOP(e.option("global_defs"),this.name)&&Ve(this)}),n(AST_SymbolRef,function(e,n){if(this.definition().global)return e=e.option("global_defs"),n=this.name+n,HOP(e,n)?function n(e,t){if(e instanceof AST_Node)return e.clone(!0);if(Array.isArray(e))return ke(AST_Array,t,{elements:e.map(function(e){return n(e,t)})});if(e&&"object"==typeof e){var i,r=[];for(i in e)HOP(e,i)&&r.push(ke(AST_ObjectKeyVal,t,{key:i,value:n(e[i],t)}));return ke(AST_Object,t,{properties:r})}return Z(e,t)}(e[n],this):void 0}),AST_Arrow.DEFMETHOD("first_statement",Ye),AST_AsyncArrow.DEFMETHOD("first_statement",Ye),AST_Lambda.DEFMETHOD("first_statement",function(){return We(this.body)}),AST_Lambda.DEFMETHOD("length",function(){for(var e=this.argnames,n=0;n<e.length&&!(e[n]instanceof AST_DefaultValue);n++);return n});var Ke,Ge,$e,Xe,Je,Qe,Ze,n=["constructor","toString","valueOf"],T=He({Array:["indexOf","join","lastIndexOf","slice"].concat(n),Boolean:n,Function:n,Number:["toExponential","toFixed","toPrecision"].concat(n),Object:n,RegExp:["exec","test"].concat(n),String:["charAt","charCodeAt","concat","indexOf","italics","lastIndexOf","match","replace","search","slice","split","substr","substring","toLowerCase","toUpperCase","trim"].concat(n)}),en=He({Array:["isArray"],Math:["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan","atan2","pow","max","min"],Number:["isFinite","isNaN"],Object:["create","getOwnPropertyDescriptor","getOwnPropertyNames","getPrototypeOf","isExtensible","isFrozen","isSealed","keys"],String:["fromCharCode","raw"]});function nn(e){if(e instanceof AST_Dot){var n,t=e.expression;if(Ee(t))return(n=en[t.name])&&(n[e.property]||"Math"==t.name&&"random"==e.property)}}function f(e){e instanceof AST_DestructuredArray?e.elements.forEach(f):e instanceof AST_DestructuredObject?e.properties.forEach(function(e){f(e.value)}):e instanceof AST_PropAccess?f(e.expression):e instanceof AST_SymbolRef&&e.definition().references.forEach(function(e){delete e._eval})}function tn(e,n,t,i,r){for(var o=[],a=0;a<e.length;a++){var s=e[a],f=s._eval(n,t,i,r);if(s===f)return;o.push(f)}return o}function rn(e){return ke(AST_UnaryPrefix,e,{operator:"!",expression:e})}function on(e,n,t){e=rn(e);return t?Y(e,ke(AST_SimpleStatement,n,{body:n}))===e?e:n:Y(e,n)}(n=function(e,n){e.DEFMETHOD("is_constant",n)})(AST_Node,return_false),n(AST_Constant,return_true),n(AST_RegExp,return_false),Ke=makePredicate("! ~ - + void"),n(AST_UnaryPrefix,function(){return Ke[this.operator]&&this.expression instanceof AST_Constant}),n=function(e,n){e.DEFMETHOD("_eval",n)},AST_Node.DEFMETHOD("evaluate",function(e,n){var t;return!e.option("evaluate")||(t=this._eval(e,n,e=[],1),e.forEach(function(e){delete e._eval}),!n&&t&&!(t instanceof RegExp)&&("function"==typeof t||"object"==typeof t))?this:t}),Ge=new TreeWalker(function(e){e instanceof AST_Assign&&f(e.left),e instanceof AST_ForEnumeration&&f(e.init),e instanceof AST_Unary&&UNARY_POSTFIX[e.operator]&&f(e.expression)}),n(AST_Statement,function(){throw new Error(string_template("Cannot evaluate a statement [{start}]",this))}),n(AST_Accessor,return_this),n(AST_BigInt,return_this),n(AST_Class,return_this),n(AST_Node,return_this),n(AST_Constant,function(){return this.value}),n(AST_Assign,function(e,n,t,i){var r=this.left;if(!n){if(!(r instanceof AST_SymbolRef))return this;if(!HOP(r,"_eval")){if(!r.fixed)return this;var o=r.definition();if(!o.fixed)return this;if(o.undeclared)return this;if(o.last_ref!==r)return this;if("m"==o.single_use)return this;if(this.right.has_side_effects(e))return this}}o=this.operator,o=!HOP(r,"_eval")&&r instanceof AST_SymbolRef&&r.fixed&&r.definition().fixed?r:"="==o?this.right:ke(AST_Binary,this,{operator:o.slice(0,-1),left:r,right:this.right}),r.walk(Ge),o=o._eval(e,n,t,i);return"object"==typeof o?this:(f(r),o)}),n(AST_Sequence,function(e,n,t,i){if(!n)return this;for(var r=this.expressions,o=0,a=r.length-1;o<a;o++)r[o].walk(Ge);var s=r[a],e=s._eval(e,n,t,i);return e===s?this:e}),n(AST_Lambda,function(e){return e.option("unsafe")?((e=function(){}).node=this,e.toString=function(){return"function(){}"},e):this}),n(AST_Array,function(e,n,t,i){if(e.option("unsafe")){for(var r=[],o=0;o<this.elements.length;o++){var a=this.elements[o];if(a instanceof AST_Hole)return this;var s=a._eval(e,n,t,i);if(a===s)return this;r.push(s)}return r}return this}),n(AST_Object,function(e,n,t,i){if(e.option("unsafe")){for(var r={},o=0;o<this.properties.length;o++){var a=this.properties[o];if(!(a instanceof AST_ObjectKeyVal))return this;var s=a.key;if(s instanceof AST_Node&&(s=s._eval(e,n,t,i))===a.key)return this;switch(s){case"__proto__":case"toString":case"valueOf":return this}if(r[s]=a.value._eval(e,n,t,i),r[s]===a.value)return this}return r}return this}),$e=makePredicate("! typeof void"),n(AST_UnaryPrefix,function(e,n,t,i){var r=this.expression,o=this.operator;if(e.option("typeofs")&&"typeof"==o&&(r instanceof AST_Lambda||r instanceof AST_SymbolRef&&r.fixed_value()instanceof AST_Lambda))return"function";var a=r instanceof AST_SymbolRef&&r.definition(),s=($e[o]||a&&a.fixed||i++,r.walk(Ge),r._eval(e,n,t,i));if(s===r)return n&&"void"==o?void 0:this;switch(o){case"!":return!s;case"typeof":return s instanceof RegExp?this:typeof s;case"void":return;case"~":return~s;case"-":return-s;case"+":return+s;case"++":case"--":if(!a)return this;if(!n){if(a.undeclared)return this;if(a.last_ref!==r)return this}return HOP(r,"_eval")&&(s=+(o[0]+1)+ +s),f(r),s}return this}),n(AST_UnaryPostfix,function(e,n,t,i){var r=this.expression;if(r instanceof AST_SymbolRef){if(!HOP(r,"_eval")){if(!r.fixed)return this;if(!n){var o=r.definition();if(!o.fixed)return this;if(o.undeclared)return this;if(o.last_ref!==r)return this}}}else if(!n)return this;r instanceof AST_SymbolRef&&r.definition().fixed||i++,r.walk(Ge);o=r._eval(e,n,t,i);return o===r?this:(f(r),+o)}),Xe=makePredicate("&& || === !=="),n(AST_Binary,function(e,n,t,i){Xe[this.operator]||i++;var r=this.left._eval(e,n,t,i);if(r===this.left)return this;if(this.operator==(r?"||":"&&"))return r;var o,a=this.right._eval(e,n&&!(r&&"object"==typeof r),t,i);if(a===this.right)return this;switch(this.operator){case"&&":o=r&&a;break;case"||":o=r||a;break;case"??":o=null==r?a:r;break;case"|":o=r|a;break;case"&":o=r&a;break;case"^":o=r^a;break;case"+":o=r+a;break;case"-":o=r-a;break;case"*":o=r*a;break;case"/":o=r/a;break;case"%":o=r%a;break;case"<<":o=r<<a;break;case">>":o=r>>a;break;case">>>":o=r>>>a;break;case"==":o=r==a;break;case"===":o=r===a;break;case"!=":o=r!=a;break;case"!==":o=r!==a;break;case"<":o=r<a;break;case"<=":o=r<=a;break;case">":o=a<r;break;case">=":o=a<=r;break;case"**":o=Math.pow(r,a);break;case"in":if(a&&"object"==typeof a&&HOP(a,r)){o=!0;break}default:return this}if(isNaN(o))return e.find_parent(AST_With)?this:o;if(e.option("unsafe_math")&&!n&&o&&"number"==typeof o&&("+"==this.operator||"-"==this.operator)){t=Math.max(0,s(r),s(a));if(t<16)return+o.toFixed(t)}return o;function s(e){e=/(\.[0-9]*)?(e[^e]+)?$/.exec(+e);return(e[1]||".").length-1-(e[2]||"").slice(1)}}),n(AST_Conditional,function(e,n,t,i){var r=this.condition._eval(e,n,t,i);return r===this.condition||(e=(r=r?this.consequent:this.alternative)._eval(e,n,t,i))===r?this:e}),n(AST_SymbolRef,function(e,n,t,i){this._eval=return_this;try{var r,o=this.fixed_value();if(!o)return this;if(HOP(o,"_eval"))r=o._eval();else{if((r=o._eval(e,n,t,i))===o)return this;o._eval=function(){return r},t.push(o)}return r&&"object"==typeof r&&!function(n,e){var t=n.definition().escaped;switch(t.length){case 0:return 1;case 1:var i=!1;return t[0].walk(new TreeWalker(function(e){return!!i||(e===n?i=!0:e instanceof AST_Scope||void 0)})),i;default:return e<=t.depth}}(this,i)?this:r}finally{delete this._eval}}),Je={Array:Array,Math:Math,Number:Number,Object:Object,String:String},Qe=He({Math:["E","LN10","LN2","LOG2E","LOG10E","PI","SQRT1_2","SQRT2"],Number:["MAX_VALUE","MIN_VALUE","NaN","NEGATIVE_INFINITY","POSITIVE_INFINITY"]}),Ze=makePredicate("global ignoreCase multiline source"),n(AST_PropAccess,function(e,n,t,i){if(e.option("unsafe")){var r,o=this.expression;if(!Ee(o)&&(null==(r=o._eval(e,n,t,i+1))||r===o))return this;var a=this.property;if(a instanceof AST_Node&&(a=a._eval(e,n,t,i))===this.property)return this;if(void 0===r){e=Qe[o.name];if(!e||!e[a])return this;r=Je[o.name]}else if(r instanceof RegExp){if(!Ze[a])return this}else if("object"==typeof r){if(!HOP(r,a))return this}else if("function"==typeof r)switch(a){case"name":return r.node.name?r.node.name.name:"";case"length":return r.node.length();default:return this}return r[a]}return this}),n(AST_Call,function(i,r,o,a){var e=this.expression,n=e instanceof AST_SymbolRef?e.fixed_value():e;if(n instanceof AST_Arrow||n instanceof AST_Defun||n instanceof AST_Function){if(!n.evaluating&&!(n.name&&0<n.name.definition().recursive_refs||this.is_expr_pure(i))){var s=tn(this.args,i,r,o,a);if(all(n.argnames,function(e,n){if(e instanceof AST_DefaultValue){if(!s)return!1;if(void 0===s[n]){var t=e.value._eval(i,r,o,a);if(t===e.value)return!1;s[n]=t}e=e.name}return!(e instanceof AST_Destructured)})&&!(n.rest instanceof AST_Destructured)&&(s||r)){var f,t=n.first_statement();if(t instanceof AST_Return)return(l=t.value)?(f=[],s&&(!all(n.argnames,function(e,n){return _(e,s[n])})||n.rest&&!_(n.rest,s.slice(n.argnames.length)))&&!r||(r&&n.argnames.forEach(function(e){e instanceof AST_DefaultValue&&e.value.walk(Ge)}),n.evaluating=!0,l=l._eval(i,r,o,a),n.evaluating=!1),f.forEach(function(e){delete e._eval}),l===t.value?this:l):void 0;if(r){n.walk(Ge);var c=!1;if(n.evaluating=!0,walk_body(n,new TreeWalker(function(e){return!!c||(e instanceof AST_Return?(e.value&&void 0!==e.value._eval(i,!0,o,a)&&(c=!0),!0):e instanceof AST_Scope&&e!==n||void 0)})),n.evaluating=!1,!c)return}}}}else if(i.option("unsafe")&&e instanceof AST_PropAccess){var l,t=e.property;if(t instanceof AST_Node&&(t=t._eval(i,r,o,a))===e.property)return this;e=e.expression;if(Ee(e)){var u=en[e.name];if(!u||!u[t])return this;l=Je[e.name]}else{if(null==(l=e._eval(i,r,o,a+1))||l===e)return this;u=T[l.constructor.name];if(!u||!u[t])return this;if(l instanceof RegExp&&l.global&&!(e instanceof AST_RegExp))return this}if(!(s=tn(this.args,i,r,o,a)))return this;if("replace"==t&&"function"==typeof s[1])return this;try{return l[t].apply(l,s)}catch(e){AST_Node.warn("Error evaluating {this} [{start}]",this)}finally{l instanceof RegExp&&(l.lastIndex=0)}}return this;function _(e,n){var t,i=(e=e instanceof AST_DefaultValue?e.name:e).definition();return i.orig[i.orig.length-1]===e&&(t=n,i.references.forEach(function(e){e._eval=function(){return t},f.push(e)}),!0)}}),n(AST_New,return_this),n(AST_Template,function(e,n,t,i){if(e.option("templates")){if(this.tag){if(!et(e,this.tag))return this;f=function(e){return e}}var r=tn(this.expressions,e,n,t,i);if(r){for(var o=!1,a=f(this.strings[0]),s=0;s<r.length;s++)a+=r[s]+f(this.strings[s+1]);if(!o)return a;this._eval=return_this}}return this;function f(e){return"string"!=typeof(e=nt(e))&&(o=!0),e}}),(n=function(e,t){e.DEFMETHOD("negate",function(e,n){return t.call(this,e,n)})})(AST_Node,function(){return rn(this)}),n(AST_Statement,function(){throw new Error("Cannot negate a statement")}),n(AST_Binary,function(e,n){var t=this.clone(),i=this.operator;if(e.option("unsafe_comps"))switch(i){case"<=":return t.operator=">",t;case"<":return t.operator=">=",t;case">=":return t.operator="<",t;case">":return t.operator="<=",t}switch(i){case"==":return t.operator="!=",t;case"!=":return t.operator="==",t;case"===":return t.operator="!==",t;case"!==":return t.operator="===",t;case"&&":return t.operator="||",t.left=t.left.negate(e,n),t.right=t.right.negate(e),on(this,t,n);case"||":return t.operator="&&",t.left=t.left.negate(e,n),t.right=t.right.negate(e),on(this,t,n)}return rn(this)}),n(AST_ClassExpression,function(){return rn(this)}),n(AST_Conditional,function(e,n){var t=this.clone();return t.consequent=t.consequent.negate(e),t.alternative=t.alternative.negate(e),on(this,t,n)}),n(AST_LambdaExpression,function(){return rn(this)}),n(AST_Sequence,function(e){var n=this.expressions.slice();return n.push(n.pop().negate(e)),we(this,n)}),n(AST_UnaryPrefix,function(){return"!"==this.operator?this.expression:rn(this)});var an=makePredicate("Boolean decodeURI decodeURIComponent Date encodeURI encodeURIComponent Error escape EvalError isFinite isNaN Number Object parseFloat parseInt RangeError ReferenceError String SyntaxError TypeError unescape URIError"),sn=makePredicate("Map Set WeakMap WeakSet");function t(e,n,t){return!all(e,t?function(e){return e instanceof AST_Spread?!t(e,n):!e.has_side_effects(n)}:function(e){return!e.has_side_effects(n)})}function fn(e,n){e=e.expression;return!e.is_string(n)||e.has_side_effects(n)}function i(e,n){for(var t=e.length;0<=--t;)if(e[t].may_throw(n))return!0;return!1}function cn(e,n){return!!e.may_throw(n)||!((e=e instanceof AST_SymbolRef?e.fixed_value():e)instanceof AST_Lambda&&!i(e.argnames,n)&&!i(e.body,n))||is_arrow(e)&&e.value&&e.value.may_throw(n)}function ln(e,n){for(var t=e.length;0<=--t;)if(!e[t].is_constant_expression(n))return!1;return!0}function un(i,r){var o=!0,a=[];return i.walk(new TreeWalker(function(e,n){if(!o)return!0;if(e instanceof AST_BlockScope)return e===i?void 0:(a.push(e),n(),a.pop(),!0);if(e instanceof AST_SymbolRef){if(i.inlined||e.redef||e.in_arg)return!(o=!1);if(!i.variables||!i.variables.has(e.name)){n=e.definition();if(!member(n.scope,a)){if(r&&!n.redefined()){var t=r.find_variable(e.name);if(t?t===n:n.undeclared)return o="f",!0}o=!1}}return!0}return e instanceof AST_ObjectIdentity?(is_arrow(i)&&all(a,function(e){return!(e instanceof AST_Scope)||is_arrow(e)})&&(o=!1),!0):void 0})),o}function q(e){return e&&e.aborts()}function _n(){var e=this.body.length;return 0<e&&q(this.body[e-1])}AST_Call.DEFMETHOD("is_expr_pure",function(e){if(e.option("unsafe")){var n=this.expression;if(Ee(n)){if(an[n.name])return!0;if(this instanceof AST_New&&sn[n.name])return!0}if(nn(n))return!0}return e.option("annotations")&&this.pure||!e.pure_funcs(this)}),AST_Template.DEFMETHOD("is_expr_pure",function(e){var n,t=this.tag;if(!t)return!0;if(e.option("unsafe")){if(Ee(t)&&an[t.name])return!0;if(t instanceof AST_Dot&&Ee(t.expression))return(n=en[t.expression.name])&&(n[t.property]||"Math"==t.expression.name&&"random"==t.property)}return!e.pure_funcs(this)}),AST_Node.DEFMETHOD("is_call_pure",return_false),AST_Call.DEFMETHOD("is_call_pure",function(e){if(!e.option("unsafe"))return!1;var n=this.expression;if(!(n instanceof AST_Dot))return!1;var t,i=n.expression,r=n.property;if(i instanceof AST_Array)t=T.Array;else if(i.is_boolean(e))t=T.Boolean;else if(i.is_number(e))t=T.Number;else if(i instanceof AST_RegExp)t=T.RegExp;else if(i.is_string(e)){if(t=T.String,"replace"==r){i=this.args[1];if(i&&!i.is_string(e))return!1}}else n.may_throw_on_access(e)||(t=T.Object);return t&&t[r]}),(n=function(e,n){e.DEFMETHOD("safe_to_spread",n)})(AST_Node,return_false),n(AST_Array,return_true),n(AST_Assign,function(){switch(this.operator){case"=":return this.right.safe_to_spread();case"&&=":case"||=":case"??=":return this.left.safe_to_spread()&&this.right.safe_to_spread()}return!0}),n(AST_Binary,function(){return!Ne[this.operator]||this.left.safe_to_spread()&&this.right.safe_to_spread()}),n(AST_Constant,return_true),n(AST_Lambda,return_true),n(AST_Object,function(){return all(this.properties,function(e){return!(e instanceof AST_ObjectGetter||e instanceof AST_Spread)})}),n(AST_Sequence,function(){return this.tail_node().safe_to_spread()}),n(AST_SymbolRef,function(){var e=this.fixed_value();return e&&e.safe_to_spread()}),n(AST_Unary,return_true),(n=function(e,n){e.DEFMETHOD("has_side_effects",n)})(AST_Node,return_true),n(AST_Array,function(e){return t(this.elements,e,fn)}),n(AST_Assign,function(e){var n,t=this.left;return!(t instanceof AST_PropAccess)||!((n=t.expression)instanceof AST_ObjectIdentity)||!n.scope.resolve().new||t instanceof AST_Sub&&t.property.has_side_effects(e)||this.right.has_side_effects(e)}),n(AST_Binary,function(e){return this.left.has_side_effects(e)||this.right.has_side_effects(e)||!Gn(this,e)}),n(AST_Block,function(e){return t(this.body,e)}),n(AST_Call,function(e){return!(this.is_expr_pure(e)||this.is_call_pure(e)&&!this.expression.has_side_effects(e))||t(this.args,e,fn)}),n(AST_Case,function(e){return this.expression.has_side_effects(e)||t(this.body,e)}),n(AST_Class,function(e){var n=this.extends;return!(!n||Re(n=n instanceof AST_SymbolRef?n.fixed_value():n))||t(this.properties,e)}),n(AST_ClassProperty,function(e){return this.key instanceof AST_Node&&this.key.has_side_effects(e)||this.static&&this.value&&this.value.has_side_effects(e)}),n(AST_Conditional,function(e){return this.condition.has_side_effects(e)||this.consequent.has_side_effects(e)||this.alternative.has_side_effects(e)}),n(AST_Constant,return_false),n(AST_Definitions,function(e){return t(this.definitions,e)}),n(AST_DestructuredArray,function(e){return t(this.elements,e)}),n(AST_DestructuredKeyVal,function(e){return this.key instanceof AST_Node&&this.key.has_side_effects(e)||this.value.has_side_effects(e)}),n(AST_DestructuredObject,function(e){return t(this.properties,e)}),n(AST_Dot,function(e){return this.expression.may_throw_on_access(e)||this.expression.has_side_effects(e)}),n(AST_EmptyStatement,return_false),n(AST_If,function(e){return this.condition.has_side_effects(e)||this.body&&this.body.has_side_effects(e)||this.alternative&&this.alternative.has_side_effects(e)}),n(AST_LabeledStatement,function(e){return this.body.has_side_effects(e)}),n(AST_Lambda,return_false),n(AST_Object,function(e){return t(this.properties,e,function(e,n){e=e.expression;return!e.safe_to_spread()||e.has_side_effects(n)})}),n(AST_ObjectIdentity,return_false),n(AST_ObjectProperty,function(e){return this.key instanceof AST_Node&&this.key.has_side_effects(e)||this.value.has_side_effects(e)}),n(AST_Sequence,function(e){return t(this.expressions,e)}),n(AST_SimpleStatement,function(e){return this.body.has_side_effects(e)}),n(AST_Sub,function(e){return this.expression.may_throw_on_access(e)||this.expression.has_side_effects(e)||this.property.has_side_effects(e)}),n(AST_Switch,function(e){return this.expression.has_side_effects(e)||t(this.body,e)}),n(AST_SymbolDeclaration,return_false),n(AST_SymbolRef,function(e){return!this.is_declared(e)||!be(this,e)}),n(AST_Template,function(e){return!this.is_expr_pure(e)||t(this.expressions,e)}),n(AST_Try,function(e){return t(this.body,e)||this.bcatch&&this.bcatch.has_side_effects(e)||this.bfinally&&this.bfinally.has_side_effects(e)}),n(AST_Unary,function(e){return unary_side_effects[this.operator]||this.expression.has_side_effects(e)}),n(AST_VarDef,function(){return this.value}),(n=function(e,n){e.DEFMETHOD("may_throw",n)})(AST_Node,return_true),n(AST_Constant,return_false),n(AST_EmptyStatement,return_false),n(AST_Lambda,return_false),n(AST_ObjectIdentity,return_false),n(AST_SymbolDeclaration,return_false),n(AST_Array,function(e){return i(this.elements,e)}),n(AST_Assign,function(e){return!!this.right.may_throw(e)||!(!e.has_directive("use strict")&&"="==this.operator&&this.left instanceof AST_SymbolRef)&&this.left.may_throw(e)}),n(AST_Await,function(e){return this.expression.may_throw(e)}),n(AST_Binary,function(e){return this.left.may_throw(e)||this.right.may_throw(e)||!Gn(this,e)}),n(AST_Block,function(e){return i(this.body,e)}),n(AST_Call,function(e){if(i(this.args,e))return!0;if(this.is_expr_pure(e))return!1;this.may_throw=return_true;e=cn(this.expression,e);return delete this.may_throw,e}),n(AST_Case,function(e){return this.expression.may_throw(e)||i(this.body,e)}),n(AST_Conditional,function(e){return this.condition.may_throw(e)||this.consequent.may_throw(e)||this.alternative.may_throw(e)}),n(AST_DefaultValue,function(e){return this.name.may_throw(e)||this.value&&this.value.may_throw(e)}),n(AST_Definitions,function(e){return i(this.definitions,e)}),n(AST_Dot,function(e){return!this.optional&&this.expression.may_throw_on_access(e)||this.expression.may_throw(e)}),n(AST_ForEnumeration,function(e){var n;return!!this.init.may_throw(e)||!!(n=this.object).may_throw(e)||!((n=n.tail_node())instanceof AST_Array||n.is_string(e))||this.body.may_throw(e)}),n(AST_If,function(e){return this.condition.may_throw(e)||this.body&&this.body.may_throw(e)||this.alternative&&this.alternative.may_throw(e)}),n(AST_LabeledStatement,function(e){return this.body.may_throw(e)}),n(AST_Object,function(e){return i(this.properties,e)}),n(AST_ObjectProperty,function(e){return this.value.may_throw(e)||this.key instanceof AST_Node&&this.key.may_throw(e)}),n(AST_Return,function(e){return this.value&&this.value.may_throw(e)}),n(AST_Sequence,function(e){return i(this.expressions,e)}),n(AST_SimpleStatement,function(e){return this.body.may_throw(e)}),n(AST_Sub,function(e){return!this.optional&&this.expression.may_throw_on_access(e)||this.expression.may_throw(e)||this.property.may_throw(e)}),n(AST_Switch,function(e){return this.expression.may_throw(e)||i(this.body,e)}),n(AST_SymbolRef,function(e){return!this.is_declared(e)||!be(this,e)}),n(AST_Template,function(e){if(i(this.expressions,e))return!0;if(this.is_expr_pure(e))return!1;if(!this.tag)return!1;this.may_throw=return_true;e=cn(this.tag,e);return delete this.may_throw,e}),n(AST_Try,function(e){return(this.bcatch?this.bcatch.may_throw(e):i(this.body,e))||this.bfinally&&this.bfinally.may_throw(e)}),n(AST_Unary,function(e){return this.expression.may_throw(e)&&!("typeof"==this.operator&&this.expression instanceof AST_SymbolRef)}),n(AST_VarDef,function(e){return this.name.may_throw(e)||this.value&&this.value.may_throw(e)}),(n=function(e,n){e.DEFMETHOD("is_constant_expression",n)})(AST_Node,return_false),n(AST_Array,function(e){return ln(this.elements,e)}),n(AST_Binary,function(e){return this.left.is_constant_expression(e)&&this.right.is_constant_expression(e)&&Gn(this)}),n(AST_Class,function(e){var n=this.extends;return!(n&&!Re(n))&&ln(this.properties,e)}),n(AST_ClassProperty,function(e){var n;return"string"==typeof this.key&&(!(n=this.value)||(this.static?n.is_constant_expression(e):un(n,e)))}),n(AST_Constant,return_true),n(AST_Lambda,function(e){return un(this,e)}),n(AST_Object,function(e){return ln(this.properties,e)}),n(AST_ObjectIdentity,function(e){return this.scope.resolve()===e}),n(AST_ObjectProperty,function(e){return"string"==typeof this.key&&this.value.is_constant_expression(e)}),n(AST_Unary,function(e){return this.expression.is_constant_expression(e)}),(n=function(e,n){e.DEFMETHOD("aborts",n)})(AST_Statement,return_null),n(AST_Jump,return_this),n(AST_BlockStatement,_n),n(AST_SwitchBranch,_n),n(AST_If,function(){return this.alternative&&q(this.body)&&q(this.alternative)&&this});var Sn=makePredicate(["use asm","use strict"]);function pn(e,n,t){switch(e.body.length){case 0:return t?List.skip:ke(AST_EmptyStatement,e);case 1:var i=e.body[0];return ae(i)?n instanceof AST_IterationStatement&&i instanceof AST_LambdaDefinition?e:i:e}return e}function dn(e,n){!n.option("rests")||e.uses_arguments||e.rest instanceof AST_DestructuredArray&&n.drop_fargs(e,n.parent())&&(e.argnames=e.argnames.concat(e.rest.elements),e.rest=e.rest.rest)}function An(e,n){if(n.option("arrows")){dn(e,n),e.value&&(e.body=[e.first_statement()]);var t=me(e.body,n);switch(t.length){case 1:var i=t[0];if(i instanceof AST_Return){e.body.length=0,e.value=i.value;break}default:e.body=t,e.value=null}}return e}e(AST_Directive,function(e,n){return!n.option("directives")||Sn[e.value]&&n.has_directive(e.value)===e?e:ke(AST_EmptyStatement,e)}),e(AST_Debugger,function(e,n){return n.option("drop_debugger")?ke(AST_EmptyStatement,e):e}),e(AST_LabeledStatement,function(e,n){if(e.body instanceof AST_If||e.body instanceof AST_Break){var t=me([e.body],n);switch(t.length){case 0:e.body=ke(AST_EmptyStatement,e);break;case 1:e.body=t[0];break;default:e.body=ke(AST_BlockStatement,e,{body:t})}}return n.option("unused")&&0==e.label.references.length?e.body:e}),e(AST_LoopControl,function(e,n){var t,i;return n.option("dead_code")&&(t=e.label)&&(i=n.loopcontrol_target(e),e.label=null,n.loopcontrol_target(e)===i?remove(t.thedef.references,e):e.label=t),e}),e(AST_Block,function(e,n){return e.body=me(e.body,n),e}),e(AST_BlockStatement,function(e,n){return e.body=me(e.body,n),pn(e,n.parent())}),e(AST_Lambda,function(e,n){return dn(e,n),e.body=me(e.body,n),e}),e(AST_Arrow,An),e(AST_AsyncArrow,An),e(AST_Function,function(n,e){dn(n,e),n.body=me(n.body,e);var t=e.parent();if(e.option("inline"))for(var i=0;i<n.body.length;i++){var r=n.body[i];if(!(r instanceof AST_Directive)){if(r instanceof AST_Return){if(i!=n.body.length-1)break;var o=r.value;if(!o||"Call"!=o.TYPE)break;if(o.is_expr_pure(e))break;var a,r=o.expression;if(r instanceof AST_SymbolRef){if(n.name&&n.name.definition()===r.definition())break;a=r.fixed_value()}else a=r;if(!(a instanceof AST_Defun||a instanceof AST_Function))break;if(a.rest)break;if(a.uses_arguments)break;if(a===r){if(a.parent_scope!==n)break;if(!all(a.enclosed,function(e){return e.scope!==n}))break}if((a!==r||a.name)&&(t instanceof AST_ClassMethod||t instanceof AST_ObjectMethod)&&t.value===e.self())break;if(a.contains_this())break;var s=a.argnames.length;if(0<s&&e.option("inline")<2)break;if(s>n.argnames.length)break;if(!all(n.argnames,function(e){return e instanceof AST_SymbolFunarg}))break;if(!all(o.args,function(e){return!(e instanceof AST_Spread)}))break;for(var f=0;f<s;f++){var c=o.args[f];if(!(c instanceof AST_SymbolRef))break;if(c.definition()!==n.argnames[f].definition())break}if(f<s)break;for(;f<o.args.length&&!o.args[f].has_side_effects(e);f++);if(f<o.args.length)break;if(s<n.argnames.length&&!e.drop_fargs(n,t)){if(!e.drop_fargs(a,o))break;for(;a.argnames.push(a.make_var(AST_SymbolFunarg,a,"argument_"+s)),++s<n.argnames.length;);}return r}break}}return n});var Tn=makePredicate("arguments await yield");function hn(e,n){for(var t=n.length;0<=--t;)n[t]||(n[t]=ke(AST_Hole,e))}function mn(e,n){e=ke(AST_ClassExpression,e);return e.name&&(e.name=n?null:ke(AST_SymbolClass,e.name)),e}function vn(e,n){var t;switch(e.CTOR){case AST_AsyncDefun:t=AST_AsyncFunction;break;case AST_AsyncGeneratorDefun:t=AST_AsyncGeneratorFunction;break;case AST_Defun:t=AST_Function;break;case AST_GeneratorDefun:t=AST_GeneratorFunction}var i=ke(t,e);return i.name=n?null:ke(AST_SymbolLambda,e.name),i}function yn(n,t){n.walk(new TreeWalker(function(e){return e instanceof AST_Return?(t(e),!0):e instanceof AST_Scope&&e!==n||void 0}))}function gn(e){var n=Object.create(null);return yn(e,function(e){var e=e.value;(e=e&&e.tail_node())instanceof AST_SymbolRef&&(e=e.definition().id,n[e]=(n[e]||0)+1)}),n}function bn(e,n,t){if(t.exposed(e))return!1;switch(e.references.length-e.replaced-(n[e.id]||0)){case e.drop_return:return"d";case e.bool_return:return!0}}function xn(e,i){yn(e,function(e){e.in_bool=!0;var n,t=e.value;t&&((n=N(i,t))?n instanceof AST_Node||(t=t.drop_side_effect_free(i),e.value=t?we(e.value,[t,ke(AST_Number,e.value,{value:1})]):ke(AST_Number,e.value,{value:1})):(t=t.drop_side_effect_free(i),e.value=t?we(e.value,[t,ke(AST_Number,e.value,{value:0})]):null))})}function kn(e,n){return!e.name||!n.option("ie")||(e=e.name.definition(),!n.exposed(e)&&all(e.references,function(e){return!(e instanceof AST_SymbolRef)}))}function wn(o,n,e){if(n instanceof AST_Lambda){var t,i=is_arrow(n),r=is_async(n),a=!1,s=!1;if(i&&o.option("arrows")?n.value?r&&!h(o,n.value)||(t=n.value.drop_side_effect_free(o))!==n.value&&(a=!0,n.value=t):s=!0:is_generator(n)||(s=!(!e&&n.name)||(t=n.name.definition()).references.length==t.replaced),s&&(n.process_expression(!1,function(e){var n=e.value;if(n){if(r&&!h(o,n))return e;n=n.drop_side_effect_free(o,!0)}return a=!0,n?ke(AST_SimpleStatement,e,{body:n}):ke(AST_EmptyStatement,e)}),yn(n,function(e){var n,t=e.value;!t||r&&!h(o,t)||(n=t.drop_side_effect_free(o))!==t&&(a=!0,n&&r&&!h(o,n)&&(n=n.negate(o)),e.value=n)})),r&&o.option("awaits")){s&&n.process_expression("awaits",function(e){var n=e.body;if(n instanceof AST_Await){if(h(o,n.expression)){if(a=!0,!(n=n.expression.drop_side_effect_free(o,!0)))return ke(AST_EmptyStatement,e);e.body=n}}else if(n instanceof AST_Sequence){for(var t=n.expressions,i=t.length;0<=--i;){var r=t[i];if(!(r instanceof AST_Await))break;r=r.expression;if(!h(o,r))break;if(a=!0,t[i]=r.drop_side_effect_free(o))break}switch(i){case-1:return ke(AST_EmptyStatement,e);case 0:e.body=t[0];break;default:t.length=i+1}}return e});var f,c=!s&&n.name||i&&n.value&&!h(o,n.value),l=new TreeWalker(function(e){return!!c||(l.parent()===n&&e.may_throw(o)||e instanceof AST_Await||e instanceof AST_ForAwaitOf?c=!0:e instanceof AST_Return?e.value&&!h(o,e.value)?c=!0:void 0:e instanceof AST_Scope&&e!==n||void 0)});if(n.walk(l),!c){switch(n.CTOR){case AST_AsyncArrow:f=AST_Arrow;break;case AST_AsyncFunction:f=AST_Function;break;case AST_AsyncGeneratorFunction:f=AST_GeneratorFunction}return ke(f,n)}}return a&&n.clone()}}function _(e,n,t,i){for(var r=e.length,o=[],a=!1,s=0;s<r;s++){var f=e[s],c=i&&f instanceof AST_Spread?i(f,n,t):f.drop_side_effect_free(n,t);c!==f&&(a=!0),c&&(o.push(c),t=!1)}return o.length?a?o:e:null}function Dn(e,n,t){var i=e.expression;return i.is_string(n)?i.drop_side_effect_free(n,t):e}function En(e){return e instanceof AST_Spread?ke(AST_Array,e,{elements:[e]}):e}function Cn(n,e,t){t=t||AST_LoopControl;var i=!1,r=new TreeWalker(function(e){return!!(i||e instanceof AST_Scope)||(e instanceof t&&r.loopcontrol_target(e)===n?i=!0:void 0)});return e instanceof AST_LabeledStatement&&r.push(e),r.push(n),n.body.walk(r),i}function z(e,n,t){if((e=e instanceof AST_Sequence?e.tail_node():e)instanceof AST_Binary)if(e.left instanceof AST_String){if(e.right instanceof AST_UnaryPrefix&&"typeof"==e.right.operator){var i=e.right.expression;if(Ee(i)){var r,o,a,s,f,c,l,u="undefined"==e.left.value;switch(e.operator){case"==":r=u?t:n;break;case"!=":r=u?n:t;break;default:return}r&&(o=!1,a=i.definition(),f=[],c=[],l=new TreeWalker(function(e,n){if(o)return!0;if(e instanceof AST_Assign){var t=e.left;if(!(t instanceof AST_SymbolRef&&t.definition()===a))return;switch(e.right.walk(l),e.operator){case"=":case"&&=":o=!0}return!0}var i;return e instanceof AST_Call?(n(),(s=e.expression.tail_node())instanceof AST_SymbolRef&&(s=s.fixed_value(),i=f.length),s instanceof AST_Lambda?push_uniq(c,s)&&s.walk(l):o=!0,0<=i&&(f.length=i),!0):e instanceof AST_DWLoop?(i=f.length,n(),o&&(f.length=i),!0):e instanceof AST_For?(e.init&&e.init.walk(l),i=f.length,e.condition&&e.condition.walk(l),e.body.walk(l),e.step&&e.step.walk(l),o&&(f.length=i),!0):e instanceof AST_ForEnumeration?(e.object.walk(l),i=f.length,e.init.walk(l),e.body.walk(l),o&&(f.length=i),!0):e instanceof AST_Scope?e!==s||void 0:e instanceof AST_SymbolRef?(e.definition()===a&&f.push(e),!0):void 0}),r.walk(l),f.forEach(function(e){e.defined=!0}))}}}else switch(e.operator){case"&&":z(e.left,n),z(e.right,n);break;case"||":z(_(e.left),t),z(_(e.right),t)}function _(e){if(e instanceof AST_Binary)switch(e.operator){case"==":return(e=e.clone()).operator="!=",e;case"!=":return(e=e.clone()).operator="==",e}}}function N(e,n,t){return!!n.truthy||(Ce(n)?void 0:!(n.falsy&&!t)&&(!!n.is_truthy()||n.evaluate(e,!0)))}function Nn(e,n){var t,i=0,r=!1,o=e.self();if(!is_statement(o))for(;;){if(t=o,(o=e.parent(i++))instanceof AST_Binary)switch(t){case o.left:if(Ne[o.operator])continue;break;case o.right:if(s(o.left))switch(o.operator){case"&&":n[r?"falsy":"truthy"]=!0;break;case"||":case"??":n[r?"truthy":"falsy"]=!0}}else if(o instanceof AST_Conditional){var a=o.condition;if(a===t)continue;if(s(a))switch(t){case o.consequent:n[r?"falsy":"truthy"]=!0;break;case o.alternative:n[r?"truthy":"falsy"]=!0}}else{if(o instanceof AST_Exit)break;if(o instanceof AST_If)break;if(o instanceof AST_Sequence){if(o.expressions[0]===t)continue}else if(o instanceof AST_SimpleStatement)break}return}for(;;){if(t=o,(o=e.parent(i++))instanceof AST_BlockStatement){if(o.body[0]===t)continue}else if(o instanceof AST_If&&s(o.condition))switch(t){case o.body:n[r?"falsy":"truthy"]=!0;break;case o.alternative:n[r?"truthy":"falsy"]=!0}return}function s(e){return n.equals(e)||e instanceof AST_UnaryPrefix&&"!"==e.operator&&n.equals(e.expression)&&(r=!0)}}function Rn(r){return function(n,t){var i=!1;return this.definitions.forEach(function(e){e.value&&(i=!0),e.name.match_symbol(function(e){e instanceof AST_SymbolDeclaration&&t.push(ke(AST_VarDef,e,{name:e,value:r(n,e)}))},!0)}),i}}function On(e){return"arguments"!=e.name&&e.orig.length<(e.orig[0]instanceof AST_SymbolLambda?3:2)}function Bn(e,n){if(e.exposed(n))return!0;for(var t=n.scope.resolve(),i=n.scope;i!==t;)if((i=i.parent_scope).var_names().has(n.name))return!0}function Pn(e,r){return ke(AST_Let,e,{definitions:e.definitions.map(function(e){return ke(AST_VarDef,e,{name:e.name.convert_symbol(AST_SymbolLet,function(e,n){var t=e.definition();t.orig[t.orig.indexOf(n)]=e;for(var i=r;i!==t.scope&&(i=i.parent_scope);)remove(i.enclosed,t);(t.scope=r).variables.set(t.name,t)}),value:e.value})})})}function Fn(e,i){return ke(AST_Var,e,{definitions:e.definitions.map(function(e){return ke(AST_VarDef,e,{name:e.name.convert_symbol(AST_SymbolVar,function(e,n){var t=e.definition();t.orig[t.orig.indexOf(n)]=e,t.scope!==i&&((t.scope=i).variables.set(t.name,t),i.enclosed.push(t),i.var_names().set(t.name,!0))}),value:e.value})})})}function qn(e,n){n=n.definition();return(n.fixed||0===n.fixed)&&On(n)&&Zn(n)&&!Bn(e,n)}function zn(e,n){if(n.option("optional_chains")&&e.terminal)do{var t=e.expression;if(e.optional){var i=N(n,t,!0);if(null==i)return ke(AST_UnaryPrefix,e,{operator:"void",expression:t}).optimize(n);i instanceof AST_Node||(e.optional=!1)}}while(("Call"==(e=t).TYPE||e instanceof AST_PropAccess)&&!e.terminal)}function G(e){var n,t=e.expression;return t instanceof AST_Sequence?(t=t.expressions.slice(),(n=e.clone()).expression=t.pop(),t.push(n),we(e,t)):e}function Un(e,t,n){var i=e.expression,r=i instanceof AST_SymbolRef?i.fixed_value():i;if(r instanceof AST_Lambda&&!r.uses_arguments&&!(r.pinned()||n&&n.indexOf(r)<0)){var o=e.args;if(all(o,function(e){return!(e instanceof AST_Spread)})){var a=r.argnames,n=r===i&&!r.name;if(r.rest){if(!n||!t.option("rests"))return;for(var s=a.length,o=o.slice(0,s);o.length<s;)o.push(ke(AST_Undefined,e).optimize(t));o.push(ke(AST_Array,e,{elements:e.args.slice(s)})),a=a.concat(r.rest),r.rest=null}else o=o.slice(),a=a.slice();for(var f=0,c=0,l=n&&t.option("default_values"),u=n&&t.drop_fargs(r,e)?function(e,n){return!e||(e instanceof AST_DestructuredArray?0==e.elements.length&&!e.rest&&n instanceof AST_Array:e instanceof AST_DestructuredObject?0==e.properties.length&&!e.rest&&n&&!n.may_throw_on_access(t):e.unused)}:return_false,_=[],S=0;S<o.length;S++){var p=a[S];if(l&&p instanceof AST_DefaultValue&&o[S].is_defined(t)&&(a[S]=p=p.name),p&&void 0===p.unused){if(u(p,o[S])){d=o[S].drop_side_effect_free(t);a.splice(S,1),o.splice(S,1),d&&_.push(d),S--;continue}_.push(o[S]),o[f++]=we(e,_),_=[]}else{var d=o[S].drop_side_effect_free(t);if(u(p)){p&&a.splice(S,1),o.splice(S,1),d&&_.push(d),S--;continue}if(d)_.push(d),o[f++]=we(e,_),_=[];else if(p){if(!_.length){o[f++]=ke(AST_Number,o[S],{value:0});continue}o[f++]=we(e,_),_=[]}}c=f}for(;S<a.length;S++)u(a[S])&&a.splice(S--,1);r.argnames=a,o.length=c,e.args=o,_.length&&(i=we(e,_),o.push(o.length<a.length?ke(AST_UnaryPrefix,e,{operator:"void",expression:i}):i))}}}function jn(e,n){n=n||e.find_parent(AST_Scope);var t=[];return(is_async(n)||n instanceof AST_Toplevel&&e.option("module"))&&t.push("await"),is_generator(n)&&t.push("yield"),t.length&&makePredicate(t)}function Ln(t,i){var r,o;return!i||(r=!0,o=new TreeWalker(function(e){if(!r)return!0;if(e instanceof AST_Scope){if(e===t)return;if(is_arrow(e))for(var n=0;r&&n<e.argnames.length;n++)e.argnames[n].walk(o);else e instanceof AST_LambdaDefinition&&i[e.name.name]&&(r=!1);return!0}e instanceof AST_Symbol&&i[e.name]&&e!==t.name&&(r=!1)}),t.walk(o),r)}function Vn(e,n){return e.in_strict_mode(n)||!n.has_directive("use strict")}function In(t,i,e,n){if(n instanceof AST_Binary&&("&&"==n.operator||"||"==n.operator)&&n.right instanceof AST_Assign&&"="==n.right.operator&&n.right.left instanceof AST_SymbolRef&&n.right.left.definition()===i&&!e.has_side_effects(t)&&r(n.left)&&r(n.right.right))return i.replaced++,ke(AST_Conditional,n,"&&"==n.operator?{condition:n.left,consequent:n.right.right,alternative:e}:{condition:n.left,consequent:e,alternative:n.right.right});function r(e){var n;if(!e.has_side_effects(t))return n=!1,e.walk(new TreeWalker(function(e){return!!n||(e instanceof AST_SymbolRef&&e.definition()===i?n=!0:void 0)})),!n}}AST_Scope.DEFMETHOD("merge_variables",function(l){if(l.option("merge_vars")){for(var u,_,S=[],p={},d=this,s=[],f=[],c=0,A=new Dictionary,T=Object.create(null),h=Object.create(null),m=new TreeWalker(function(t,e){var n,i,r,o,a,s;return t instanceof AST_Assign?(a=t.left,o=t.right,a instanceof AST_Destructured?(o.walk(m),x(AST_SymbolRef,k,a),!0):Ne[t.operator.slice(0,-1)]?(a.walk(m),g(),o.walk(m),a instanceof AST_SymbolRef&&k(a),b(),!0):a instanceof AST_SymbolRef?("="!=t.operator&&k(a,!0),o.walk(m),k(a),!0):void 0):t instanceof AST_Binary?Ne[t.operator]?(c(t),!0):void 0:t instanceof AST_Break?((s=m.loopcontrol_target(t))instanceof AST_IterationStatement||w(s),!0):t instanceof AST_Call?((i=t.expression)instanceof AST_LambdaExpression?(t.args.forEach(function(e){e.walk(m)}),i.walk(m)):(e(),f(i)),!0):t instanceof AST_Class?(t.name&&t.name.walk(m),t.extends&&t.extends.walk(m),t.properties.filter(function(e){return e.key instanceof AST_Node&&e.key.walk(m),e.value}).forEach(function(e){e.static?e.value.walk(m):(g(),p.block=t,e.value.walk(m),b())}),!0):t instanceof AST_Conditional?(c(t.condition,t.consequent,t.alternative),!0):t instanceof AST_Continue?((s=m.loopcontrol_target(t))instanceof AST_Do&&w(s),!0):t instanceof AST_Do?(g(),p.block=t,p.loop=!0,r=p,t.body.walk(m),p.inserted===t&&(p=r),t.condition.walk(m),b(),!0):t instanceof AST_For?(t.init&&t.init.walk(m),g(),p.block=t,p.loop=!0,t.condition&&t.condition.walk(m),t.body.walk(m),t.step&&t.step.walk(m),b(),!0):t instanceof AST_ForEnumeration?(t.object.walk(m),g(),p.block=t,p.loop=!0,t.init.walk(m),t.body.walk(m),b(),!0):t instanceof AST_If?(c(t.condition,t.body,t.alternative),!0):t instanceof AST_LabeledStatement?(g(),p.block=t,r=p,t.body.walk(m),p.inserted===t&&(p=r),b(),!0):t instanceof AST_Scope?(g(),(p.block=t)===d&&(_=p),t instanceof AST_Lambda&&(t.name&&(T[t.name.definition().id]=!1),n=t.uses_arguments&&!m.has_directive("use strict")?function(e){T[e.definition().id]=!1}:function(e){k(e)},S.push(t),t.argnames.forEach(function(e){x(AST_SymbolFunarg,n,e)}),t.rest&&x(AST_SymbolFunarg,n,t.rest),S.pop()),walk_lambda(t,m),b(),!0):t instanceof AST_Sub?(i=t.expression,(t.optional?(i.walk(m),g(),t.property.walk(m),b):e)(),f(i),!0):t instanceof AST_Switch?(t.expression.walk(m),r=p,t.body.forEach(function(e){e instanceof AST_Default||(e.expression.walk(m),r===p&&g())}),p=r,t.body.forEach(function(e){g(),p.block=t;var n=p;walk_body(e,m),p.inserted===t&&(p=n),b()}),!0):t instanceof AST_SymbolDeclaration?!(T[t.definition().id]=!1):t instanceof AST_SymbolRef?(k(t,!0),!0):t instanceof AST_Try?(o=u,u=t,walk_body(t,m),t.bcatch&&(t.bcatch.argname&&t.bcatch.argname.mark_symbol(function(e){e instanceof AST_SymbolCatch&&(e=e.definition(),T[e.id]=!1,e=e.redefined())&&(T[e.id]=!1)},m),t.bfinally||(u=o)?walk_body(t.bcatch,m):(g(),walk_body(t.bcatch,m),b())),u=o,t.bfinally&&t.bfinally.walk(m),!0):t instanceof AST_Unary?UNARY_POSTFIX[t.operator]&&(a=t.expression)instanceof AST_SymbolRef?(k(a,!0),!0):void 0:t instanceof AST_VarDef?((s=t.value)?s.walk(m):s=p.block instanceof AST_ForEnumeration&&p.block.init===m.parent(),x(AST_SymbolDeclaration,s?function(e){e instanceof AST_SymbolVar?k(e):e.walk(m)}:function(e){var n,t;e instanceof AST_SymbolVar?(n=e.definition().id,(t=T[n])?t.push(e):n in T||A.add(n,e)):e.walk(m)},t.name),!0):t instanceof AST_While?(g(),p.block=t,p.loop=!0,e(),b(),!0):void 0;function f(e){l.option("ie")&&(e=root_expr(e))instanceof AST_SymbolRef&&e.walk(m)}function c(e,n,t){var i=p,e=function e(n,t,i,r){var o={consequent:{segment:p,level:n},alternative:{segment:p,level:n}};if(t instanceof AST_Binary)switch(t.operator){case"&&":o.consequent=e(n+1,t.left,t.right).consequent;break;case"||":o.alternative=e(n+1,t.left,null,t.right).alternative;break;case"??":o.alternative=e(n+1,t.left,t.right,t.right).alternative;break;default:t.walk(m)}else t instanceof AST_Conditional?e(n+1,t.condition,t.consequent,t.alternative):t.walk(m);i&&(p=o.consequent.segment,g(),i.walk(m),o.consequent.segment=p);r&&(p=o.alternative.segment,g(),r.walk(m),o.alternative.segment=p);return o}(1,e,n,t);if(n){p=e.consequent.segment;for(var r=e.consequent.level;0<=--r;)b();if(p!==i)return}if(t){p=e.alternative.segment;for(r=e.alternative.level;0<=--r;)b();if(p!==i)return}p=i}}),e=(m.directives=Object.create(l.directives),d.walk(m),!1),n=Object.create(null);s.length&&f.length;){var t=f.shift();if(t){var i=t.definition,r=T[i.id];if(r){for(r={end:r.end};i.id in n;)i=n[i.id];r.start=T[i.id].start;var o=[];do{var a=s.shift();if(!(t.index>a.index)){var v=a.definition;if(v.id in h){var y=T[v.id];if(y){if(y.start.block===r.start.block&&E(y,r)&&(!y.start.loop&&Zn(i)||E(r,y))&&(!l.option("webkit")||is_funarg(i)===is_funarg(v))&&!v.const_redefs&&all(y.scopes,function(e){return e.find_variable(i.name)===i})){y.forEach(function(e){e.thedef=i,e.name=i.name,e instanceof AST_SymbolRef?(i.references.push(e),v.replaced++):(i.orig.push(e),v.eliminated++)}),v.fixed||(i.fixed=!1),n[v.id]=i,e=!0;break}o.push(a)}}}}while(s.length);o.length&&(s=o.concat(s))}}}return e}function g(){p=Object.create(p)}function b(){p=Object.getPrototypeOf(p)}function x(n,t,e){var i=new TreeWalker(function(e){if(!(e instanceof AST_Destructured))return e instanceof AST_DefaultValue?(g(),e.value.walk(m),b(),e.name.walk(i)):e instanceof AST_DestructuredKeyVal?e.key instanceof AST_Node?e.value instanceof AST_PropAccess?(g(),(p.block=e).key.walk(m),e.value.walk(i),b()):(e.key.walk(m),e.value.walk(i)):e.value.walk(i):e instanceof n?t(e):e.walk(m),!0});e.walk(i)}function k(n,e){var t,i=n.definition();if(e&&!all(S,function(e){return!(t=e.variables.get(n.name))||!is_funarg(t)||t!==i&&!i.undeclared&&e.parent_scope.find_variable(n.name)!==i}))return T[i.id]=T[t.id]=!1;var r,o=p;if(u&&(g(),o=p,b()),i.id in T){if(!(r=T[i.id]))return;if(r.start.block!==o.block)return T[i.id]=!1;if(a(n),r.end=o,i.id in h)f[h[i.id]]=null;else if(!e)return}else{if((t=d.variables.get(i.name))!==i)return t&&_===o&&(T[t.id]=!1),T[i.id]=!1;if(l.exposed(i)||Tn[n.name])return T[i.id]=!1;if((r=A.get(i.id)||[]).scopes=[],a(n),T[i.id]=r,!e)return r.start=o,s.push({index:c++,definition:i});if(o.block!==d)return T[i.id]=!1;r.start=_}function a(e){r.push(e),push_uniq(r.scopes,e.scope);var n=xe(m);n!==e.scope&&push_uniq(r.scopes,n)}h[i.id]=f.length,f.push({index:c++,definition:i})}function w(e){for(var n=[];;){if(HOP(p,"block")){var t=p.block;if((t=t instanceof AST_LabeledStatement?t.body:t)===e)break}n.push(p),b()}for(p.inserted=p.block,g();n.length;){var i=n.pop();g(),HOP(i,"block")&&(p.block=i.block),HOP(i,"loop")&&(p.loop=i.loop)}}function D(e,n){return e===n||e.isPrototypeOf(n)}function E(e,n){return D(e.start,e.end)||D(e.start,n.start)}}),AST_Scope.DEFMETHOD("drop_unused",function(R){if(R.option("unused")){var O=this,B=!(O instanceof AST_Toplevel)||R.toplevel.funcs,P=!(O instanceof AST_Toplevel)||R.toplevel.vars,F=/keep_assign/.test(R.option("unused"))?return_false:function(e,n){var t,i=!1;if(e instanceof AST_Assign?!e.write_only&&"="!=e.operator||(t=r(e.left,n)):e instanceof AST_Unary&&e.write_only&&(t=r(e.expression,n)),t instanceof AST_SymbolRef){e=t.definition();if(!a[e.id]&&!R.exposed(e)&&be(t,R,i))return t}function r(e,n){if(e instanceof AST_PropAccess){var t=e.expression;if(!t.may_throw_on_access(R,!0))return i=!0,n&&e instanceof AST_Sub&&n.unshift(e.property),r(t,n)}else if(e instanceof AST_Assign&&"="==e.operator)return e.write_only="p",t=r(e.right),!n||(n.assign=e,t instanceof AST_SymbolRef)?t:e.left;return e}},q=Object.create(null),a=Object.create(null),l=function(e){return(l=function e(n,t,i){var r=R.parent(t);if(!r)return i;n=r instanceof AST_Lambda&&member(n,r.argnames);return e(r,t+1,n?function(e){var n=i(e);if(n)return n;if(n=r.variables.get(e)){e=n.orig[0];if(e instanceof AST_SymbolFunarg||e instanceof AST_SymbolLambda)return n}}:r.variables?function(e){return i(e)||r.variables.get(e)}:i)}(O,0,noop))(e)},z=Object.create(null),u=[],U=Object.create(null),_=Object.create(null),S=Object.create(null),p=Object.create(null),j=Object.create(null),d=(O instanceof AST_Toplevel&&R.top_retain&&O.variables.each(function(e){!R.top_retain(e)||e.id in U||(AST_Node.info("Retaining variable {name}",e),U[e.id]=!0,u.push(e))}),new Dictionary),A=new Dictionary,L=this,V=((T=new TreeWalker(function(s,e){if(s instanceof AST_Lambda&&s.uses_arguments&&!T.has_directive("use strict")&&s.each_argname(function(e){e=e.definition();e.id in U||(U[e.id]=!0,u.push(e))}),s!==O){if(L===O){var t,i,n,r;if(s instanceof AST_DefClass)return r=s.name.definition(),(n=B&&!r.exported)||r.id in U||(U[r.id]=!0,u.push(r)),(t=T.parent()instanceof AST_ExportDefault)?a[r.id]=!0:!n||r.id in _||(_[r.id]=1),s.extends&&s.extends.walk(T),i=[],s.properties.forEach(function(e){e.key instanceof AST_Node&&e.key.walk(T);var n=e.value;n&&(he(e)?(!t&&n.contains_this()&&(t=!0),o(n)):i.push(n))}),i.forEach(n&&t?o:function(e){A.add(r.id,e)}),!0;if(s instanceof AST_LambdaDefinition)return r=s.name.definition(),(n=B&&!r.exported)||r.id in U||(U[r.id]=!0,u.push(r)),A.add(r.id,s),T.parent()instanceof AST_ExportDefault?(a[r.id]=!0,f(s,e,!0)):(!n||r.id in _||(_[r.id]=1),!0);if(s instanceof AST_Definitions)return s.definitions.forEach(function(i){var r=i.value,o=r&&(i.name instanceof AST_Destructured||r.has_side_effects(R)),a=o&&"="==r.tail_node().operator;i.name.mark_symbol(function(e){var n,t;if(e instanceof AST_SymbolDeclaration)return n=e.definition(),j[n.id]=(j[n.id]||0)+1,s instanceof AST_Var&&n.orig[0]instanceof AST_SymbolCatch&&(t=n.redefined())&&(j[t.id]=(j[t.id]||0)+1),n.id in U||P&&!n.exported&&(s instanceof AST_Const?!n.redefined():!n.const_redefs)&&(s instanceof AST_Var||On(n))||(U[n.id]=!0,u.push(n)),r&&(o?a&&v(n,e,p[n.id]):A.add(n.id,r),d.add(n.id,i)),y(n),!0},T),o&&r.walk(T)}),!0;if(s instanceof AST_SymbolFunarg)return r=s.definition(),j[r.id]=(j[r.id]||0)+1,d.add(r.id,s),!0;if(s instanceof AST_SymbolImport)return(r=s.definition()).id in U||P&&On(r)||(U[r.id]=!0,u.push(r)),!0}return f(s,e,!0)}function o(e){var n=L;L=s,e.walk(T),L=n}})).directives=Object.create(R.directives),O.walk(T),R.option("keep_fnames")?return_false:R.option("ie")?function(e){return!R.exposed(e)&&e.references.length==e.replaced}:function(e){return!(e.id in U)||!(e.orig.length-e.eliminated<2)&&(e.orig[1]instanceof AST_SymbolFunarg||all(e.references,function(e){return!e.in_arg}))});R.option("ie")&&A.each(function(e,n){n in U||e.forEach(function(e){e.walk(new TreeWalker(function(e){return e instanceof AST_Function&&e.name&&!V(e.name.definition())?(e.walk(T),!0):e instanceof AST_Scope||void 0}))})});for(var T=new TreeWalker(f),e=0;e<u.length;e++){var n=A.get(u[e].id);n&&n.forEach(function(e){e.walk(T)})}Object.keys(q).forEach(function(e){var n,t=q[e];t&&(t=t.reduce(function(n,e){return e.forEach(function(e){push_uniq(n,e)}),n},[]),n=(d.get(e)||[]).filter(function(n){return find_if(n instanceof AST_Unary?function(e){return e===n}:function(e){return e===n||!(e instanceof AST_Unary)&&i(e)===i(n)},t)}),t.length==n.length)?q[e]=n:delete q[e]});var I=[],M=[],H=new TreeTransformer(function(t){if(t instanceof AST_DefaultValue)return E(H,t);if(t instanceof AST_Destructured&&t.rest&&(t.rest=t.rest.transform(H)),t instanceof AST_DestructuredArray){for(var e=!t.rest,n=t.elements.length;0<=--n;){var i=t.elements[n].transform(H);i?(t.elements[n]=i,e=!1):e?t.elements.pop():t.elements[n]=ke(AST_Hole,t.elements[n])}return t}var r;return t instanceof AST_DestructuredObject?(r=[],t.properties.forEach(function(e){var n=!1;e.key instanceof AST_Node&&(e.key=e.key.transform(W),n=e.key.has_side_effects(R)),(n||t.rest)&&((n=e.value)instanceof AST_DefaultValue?n.name:n)instanceof AST_SymbolDeclaration?(e.value=e.value.transform(W),r.push(e)):(n=!(n=e.value.transform(H))&&t.rest?e.value instanceof AST_DestructuredArray?ke(AST_DestructuredArray,e.value,{elements:[]}):ke(AST_DestructuredObject,e.value,{properties:[]}):n)&&(e.value=n,r.push(e))}),t.properties=r,t):t instanceof AST_SymbolDeclaration?$(t):void 0}),W=new TreeTransformer(function(S,n,e){var t,i,p=W.parent();if(P){var r,o,a=[],s=F(S,a);if(s){if(i=S,T=(t=s).definition(),r=!(o=U[T.id])||i[i instanceof AST_Assign?"left":"expression"]===t&&(o===t&&T.references.length-T.replaced==1||G(T,i)<0)?(r=S instanceof AST_Assign&&(r=Q(S),!0===S.write_only)?r.drop_side_effect_free(R):r)||ke(AST_Number,S,{value:0}):r)switch(a.assign&&(o=a.assign.drop_side_effect_free(R))&&(o.write_only=!0,a.unshift(o)),p instanceof AST_Sequence&&p.tail_node()!==S&&!r.has_side_effects(R)||a.push(r),a.length){case 0:return List.skip;case 1:return De(p,S,a[0].transform(W));default:return we(S,a.map(function(e){return e.transform(W)}))}}else if(S instanceof AST_UnaryPostfix&&S.expression instanceof AST_SymbolRef&&G(S.expression.definition(),S)<0)return ke(AST_UnaryPrefix,S,{operator:"+",expression:S.expression})}if(S instanceof AST_Binary&&"instanceof"==S.operator)return!((s=S.right)instanceof AST_SymbolRef)||s.definition().id in U?void 0:(t=S.left.drop_side_effect_free(R),r=ke(AST_False,S).optimize(R),t?we(S,[t,r]):r);if(S instanceof AST_Call)return I.push(S),S.args=S.args.map(function(e){return e.transform(W)}),S.expression=S.expression.transform(W),S;if(L===O){if(B&&S!==O&&S instanceof AST_DefClass)if(!((u=S.name.definition()).id in U))return Y(S.name,"Dropping unused class {name}"),u.eliminated++,n(S,W),_=mn(S,!0),p instanceof AST_ExportDefault?_:(_=_.drop_side_effect_free(R,!0))?ke(AST_SimpleStatement,S,{body:_}):e?List.skip:ke(AST_EmptyStatement,S);if(S instanceof AST_ClassExpression&&S.name&&V(S.name.definition())&&(S.name=null),S instanceof AST_Lambda){if(B&&S!==O&&S instanceof AST_LambdaDefinition)if(!((u=S.name.definition()).id in U))return Y(S.name,"Dropping unused function {name}"),u.eliminated++,p instanceof AST_ExportDefault?(N(),vn(S,!0)):e?List.skip:ke(AST_EmptyStatement,S);if(N(),S instanceof AST_LambdaExpression&&S.name&&V(S.name.definition())&&(S.name=null),!(S instanceof AST_Accessor)){var f,c,l=R.drop_fargs(S,p);if(l&&p instanceof AST_Call&&p.expression===S)for(f=p.args,c=0;c<f.length&&!(f[c]instanceof AST_Spread);c++);for(var u,_,d,A=S.argnames,T=S.rest,h=!1,m=!1,v=(T&&(m=!0,!f||c<A.length||T instanceof AST_SymbolFunarg?T=T.transform(H):(T=(_=X(T,ke(AST_Array,p,{elements:f.slice(A.length)}),$,!S.uses_arguments,T)).name,f.length=A.length,_.value.elements.length&&[].push.apply(f,_.value.elements)),T instanceof AST_Destructured&&!T.rest&&(T instanceof AST_DestructuredArray?0==T.elements.length&&(T=null):0==T.properties.length&&(T=null)),S.rest=T)&&(h=!(l=!1)),l?-1:S.length()),y=f&&!S.uses_arguments&&p!==R.parent(),g=A.length;0<=--g;)(s=A[g])instanceof AST_SymbolFunarg?(u=s.definition()).id in U?(l=!1,G(u,s)<0&&(s.unused=null)):(l&&(Y(s,"Dropping unused function argument {name}"),A.pop(),u.eliminated++),s.unused=!0):(m=!0,!f||c<g?d=s.transform(H):(d=(_=X(s,f[g],$,y,s)).name,_.value&&(f[g]=_.value)),d?(l=!1,A[g]=d,h=h||!(d instanceof AST_SymbolFunarg)):l?(K(s,"Dropping unused default argument {name}"),A.pop()):v<g?(K(s,"Dropping unused default argument assignment {name}"),s.name instanceof AST_SymbolFunarg?s.name.unused=!0:h=!0,A[g]=s.name):(K(s,"Dropping unused default argument value {name}"),A[g]=s=s.clone(),s.value=ke(AST_Number,s,{value:0}),h=!0));m&&!h&&S.uses_arguments&&!W.has_directive("use strict")&&(S.rest=ke(AST_DestructuredArray,S,{elements:[]})),M.push(S)}return S}if(S instanceof AST_Catch&&S.argname instanceof AST_Destructured&&S.argname.transform(H),!(S instanceof AST_Definitions)||p instanceof AST_ForEnumeration&&p.init===S)return S instanceof AST_Assign?(n(S,W),S.left instanceof AST_Destructured?(_=X(S.left,S.right,function(e){return e},!0===S.write_only)).name?ke(AST_Assign,S,{operator:S.operator,left:_.name,right:_.value}):_.value||(p instanceof AST_Sequence&&p.tail_node()!==S?List.skip:ke(AST_Number,S,{value:0})):S):S instanceof AST_LabeledStatement&&S.body instanceof AST_For?(n(S,W),S.body instanceof AST_BlockStatement?(S.body=(i=S.body).body.pop(),i.body.push(S),e?List.splice(i.body):i):S):S instanceof AST_Scope?(N(),S):S instanceof AST_SymbolImport?!R.option("imports")||S.definition().id in U?S:e?List.skip:null:void 0;var b=[],x=[],k=[],w=[],D=0,E=S instanceof AST_Var;switch(S.definitions.forEach(function(e){e.value&&(e.value=e.value.transform(W));var n=e.value;if(e.name instanceof AST_Destructured)(f=X(e.name,n,function(e){return!P||e.definition().id in U||u(e)||E&&!be(e)?e:null},!0)).name?(e=ke(AST_VarDef,e,{name:f.name,value:n=f.value}),_()):f.value&&w.push(f.value);else{var t,i,r,o,a,s=e.name.definition(),f=E?be(e.name):On(s);if(!f||!P||s.id in U)if(n&&((o=G(s,e))<0||(a=n.tail_node())instanceof AST_SymbolRef&&a.definition()===s)&&(e=e.clone(),(n=n.drop_side_effect_free(R))&&AST_Node.warn("Side effects in definition of variable {name} [{start}]",e.name),S instanceof AST_Const?e.value=n||ke(AST_Number,e,{value:0}):(e.value=null,n&&w.push(n)),n=null,0<=o)&&(q[s.id][o]=e),n||S instanceof AST_Let)if(R.option("functions")&&!R.option("ie")&&f&&n&&1==j[s.id]&&0==s.assignments&&(a=n.tail_node())instanceof AST_LambdaExpression&&!ge(s)&&!is_arrow(a)&&(r=a,0==(o=s.references).length?r===e.name.fixed_value():all(o,function(e){return r===e.fixed_value()}))&&(i=a,E&&!R.has_directive("use strict")&&i instanceof AST_Function?p instanceof AST_Block||p instanceof AST_For&&p.init===S||p instanceof AST_If:p instanceof AST_Scope)&&!1!==(i=function(t,i){if(!t.name)return null;var r,e=t.name.definition();if(1<e.orig.length)return null;if(0<e.assignments)return!1;if(e.name==i)return e;if(R.option("keep_fnames"))return!1;switch(i){case"await":r=is_async;break;case"yield":r=is_generator}return all(e.references,function(e){var n=e.scope;if(n.find_variable(i)!==s)return!1;if(r)do{if(n=n.resolve(),r(n))return!1}while(n!==t&&(n=n.parent_scope));return!0})&&e}(a,e.name.name))){switch(AST_Node.warn("Declaring {name} as function [{start}]",e.name),a.CTOR){case AST_AsyncFunction:t=AST_AsyncDefun;break;case AST_AsyncGeneratorFunction:t=AST_AsyncGeneratorDefun;break;case AST_Function:t=AST_Defun;break;case AST_GeneratorFunction:t=AST_GeneratorDefun}var c=ke(t,a),l=(c.name=ke(AST_SymbolDefun,e.name),e.name.scope.resolve().def_function(c.name));i&&i.forEach(function(e){e.name=l.name,e.thedef=l,e.reference()}),b.push(c),n!==a&&[].push.apply(w,n.expressions.slice(0,-1)),s.eliminated++}else f&&1<j[s.id]&&!(p instanceof AST_ExportDeclaration)&&s.orig.indexOf(e.name)>s.eliminated&&(j[s.id]--,D++),_();else p instanceof AST_ExportDeclaration?_():f&&1<j[s.id]?(AST_Node.info("Dropping declaration of variable {name} [{start}]",e.name),j[s.id]--,s.eliminated++):x.push(e);else u(e.name)?((n=n&&n.drop_side_effect_free(R))&&w.push(n),1<j[s.id]?(AST_Node.warn("Dropping duplicated declaration of variable {name} [{start}]",e.name),j[s.id]--,s.eliminated++):(e.value=null,x.push(e))):((n=n&&n.drop_side_effect_free(R))?(AST_Node.warn("Side effects in initialization of unused variable {name} [{start}]",e.name),w.push(n)):Y(e.name,"Dropping unused variable {name}"),s.eliminated++)}function u(e){var n=e.definition();return n.orig[0]instanceof AST_SymbolCatch&&n.scope.resolve()===e.scope.resolve()}function _(){0<w.length&&(0==k.length?b.push(ke(AST_SimpleStatement,S,{body:we(S,w)})):n?(w.push(n),e.value=we(n,w)):e.value=ke(AST_UnaryPrefix,e,{operator:"void",expression:we(e,w)}),w=[]),k.push(e)}}),x.length){case 0:if(0==k.length)break;if(k.length==D){[].unshift.apply(w,k.map(function(e){AST_Node.info("Dropping duplicated definition of variable {name} [{start}]",e.name);var n=e.name.definition(),t=ke(AST_SymbolRef,e.name),t=(n.references.push(t),ke(AST_Assign,e,{operator:"=",left:t,right:e.value})),e=G(n,e);return 0<=e&&(q[n.id][e]=t),n.assignments++,n.eliminated++,t}));break}case 1:if(0==k.length){var C=x[0].name.definition().id;if(C in z){S.definitions=x,z[C].init=S;break}}default:0<k.length&&(C=k[0].value)instanceof AST_Sequence&&(k[0].value=C.tail_node(),b.push(ke(AST_SimpleStatement,S,{body:we(C,C.expressions.slice(0,-1))}))),S.definitions=x.concat(k),b.push(S)}return 0<w.length&&b.push(ke(AST_SimpleStatement,S,{body:we(S,w)})),J(b,S,e)}function N(){var e=L;n(L=S,W),L=e}},function(e,n){if(e instanceof AST_BlockStatement)return pn(e,W.parent(),n);if(e instanceof AST_ExportDeclaration)return(t=e.body)instanceof AST_BlockStatement?(e.body=t.body.pop(),t.body.push(e),n?List.splice(t.body):t):void 0;if(e instanceof AST_For)return Ue(e,n);if(e instanceof AST_ForIn){if(!P||!R.option("loops"))return;if(!ee(e.body))return;var t=g(e);if(!t)return;var i=t.definition();if(i.id in U)return;Y(t,"Dropping unused loop variable {name}"),z[i.id]===e&&delete z[i.id];var t=[],r=e.object.drop_side_effect_free(R);return r&&(AST_Node.warn("Side effects in object of for-in loop [{start}]",r),t.push(ke(AST_SimpleStatement,e,{body:r}))),e.init instanceof AST_Definitions&&i.orig[0]instanceof AST_SymbolCatch&&t.push(e.init),J(t,e,n)}return e instanceof AST_Import?(e.properties&&0==e.properties.length&&(e.properties=null),e):e instanceof AST_Sequence&&!(1<e.expressions.length)?De(W.parent(),e,e.expressions[0]):void 0});W.push(R.parent()),W.directives=Object.create(R.directives),O.transform(W),O instanceof AST_Lambda&&1==O.body.length&&O.body[0]instanceof AST_Directive&&"use strict"==O.body[0].value&&(O.body.length=0),I.forEach(function(e){Un(e,R,M)})}function Y(e,n){AST_Node[0<e.definition().references.length?"info":"warn"](n+" [{start}]",e)}function K(e,n){e.name instanceof AST_SymbolFunarg?Y(e.name,n):AST_Node.info(n+" [{start}]",e)}function i(e){return e[e instanceof AST_Assign?"right":"value"]}function J(e,n,t){switch(e.length){case 0:return t?List.skip:ke(AST_EmptyStatement,n);case 1:return e[0];default:return t?List.splice(e):ke(AST_BlockStatement,n,{body:e})}}function h(e,n){return e.scope.resolve()===O&&(e.fixed&&n.fixed||(q[e.id]=!1),!1!==q[e.id])}function m(e,n){q[e.id]||(q[e.id]=[]),n.fixed.assigns&&push_uniq(q[e.id],n.fixed.assigns)}function G(e,n){e=q[e.id];return e&&e.indexOf(n)}function y(e){1<_[e.id]&&!(e.id in U)&&(U[e.id]=!0,u.push(e)),_[e.id]=0}function v(e,n,t){e.id in U||(n&&t?(U[e.id]=n,u.push(e)):(S[e.id]=n,p[e.id]=t))}function Q(e){var n=e.right;return!e.write_only||!(n instanceof AST_Binary&&Ne[n.operator])||!(n.left instanceof AST_SymbolRef)||!(e.left instanceof AST_SymbolRef)||(e=e.left.definition(),n.left.definition()!==e)||n.right.has_side_effects(R)?n:(h(e,n.left)&&m(e,n.left),n.right)}function g(e){var n=e.init;if(n instanceof AST_Definitions)return(n=n.definitions[0].name)instanceof AST_SymbolDeclaration&&n;for(;n instanceof AST_PropAccess;)n=n.expression.tail_node();return n instanceof AST_SymbolRef?n:void 0}function f(e,n,t){e instanceof AST_Assign&&e.left instanceof AST_SymbolRef&&(o=e.left.definition()).scope.resolve()===O&&d.add(o.id,e),e instanceof AST_SymbolRef&&e.in_arg&&(j[e.definition().id]=0),e instanceof AST_Unary&&e.expression instanceof AST_SymbolRef&&(o=e.expression.definition()).scope.resolve()===O&&d.add(o.id,e);var i,r,o,a,s,f=[],c=F(e,f);if(c)return(a=c.definition()).scope.resolve()!==O&&O.variables.get(c.name)!==a||ge(a)&&!all(O.argnames,function(e){return!e.match_symbol(function(e){if(e instanceof AST_SymbolFunarg)return(e=e.definition()).references.length>e.replaced},!0)})||"p"===e.write_only&&e.right.may_throw_on_access(R,!0)?void 0:((i=f.assign)&&(i.write_only=!0,i.walk(T)),f.forEach(function(e){e.walk(T)}),e instanceof AST_Assign&&(i=c.fixed_value(),f=Q(e),i=i&&i.is_constant(),s=!1,t&&!0===e.write_only&&(i||e.left===c||f.equals(c))&&!f.has_side_effects(R)?A.add(a.id,f):(f.walk(T),s="="==f.tail_node().operator),e.left===c?e.write_only&&!s||v(a,c,p[a.id]):i||v(a,S[a.id],!0)),h(a,c)&&is_lhs(c,e)!==c&&m(a,c),y(a),!0);if(e instanceof AST_Binary)return"instanceof"==e.operator&&(c=e.right)instanceof AST_SymbolRef&&(r=c.definition().id,_[r])?(e.left.walk(T),_[r]++,!0):void 0;if(e instanceof AST_ForIn){if(e.init instanceof AST_SymbolRef&&L===O&&((r=e.init.definition().id)in z||(z[r]=e)),!P||!R.option("loops"))return;if(!ee(e.body))return;if(e.init.has_side_effects(R))return;if(!(c=g(e)))return;if((o=c.definition()).scope.resolve()!==O){t=l(c.name);if(t===o||t&&t.redefined()===o)return}return e.object.walk(T),!0}return e instanceof AST_SymbolRef?((a=e.definition()).id in U||(U[a.id]=!0,u.push(a)),!b(a.scope,e.scope)||!(f=a.redefined())||f.id in U||(U[f.id]=!0,u.push(f)),h(a,e)&&m(a,e),!0):e instanceof AST_Scope?(s=L,L=e,n(),L=s,!0):void 0}function $(e){return e.definition().id in U?e:(e instanceof AST_SymbolFunarg&&(e.unused=!0),null)}function E(e,n){if(n.value=n.value.transform(W),!n.name.transform(e)){if(n.name instanceof AST_Destructured)return null;e=n.value.drop_side_effect_free(R);if(!e)return null;Y(n.name,"Side effects in default value of unused variable {name}"),(n=n.clone()).name.unused=null,n.value=e}return n}function X(e,v,y,g,b){var x=!0,k=new TreeTransformer(function(r){if(r instanceof AST_DefaultValue){if(!(R.option("default_values")&&v&&v.is_defined(R)))return n=g,g=!1,i=E(k,r),g=n,!i&&g&&(v=v&&v.drop_side_effect_free(R)),i;r===b?b=r=r.name:r=r.name}if(r instanceof AST_DestructuredArray){var e,n=g,o=x,t=v;if(v instanceof AST_SymbolRef&&(g=!1,v=v.fixed_value()),v instanceof AST_Array){if(e=!0,d=v.elements,o)for(_=d.length;0<=--_&&!d[_].has_side_effects(R););}else e=v&&v.is_string(R),d=!1,_=r.elements.length;var i,a=[],s=g&&[],f=0;if(r.elements.forEach(function(e,n){o&&(x=_<=n),(v=d&&d[n])instanceof AST_Hole?v=null:v instanceof AST_Spread&&(g&&(s.length=f,hn(t,s),[].push.apply(s,d.slice(n)),t.elements=s),v=d=!1),(e=e.transform(k))&&(a[f]=e),g&&v&&(s[f]=v),!e&&!v&&g&&d||f++}),v=d&&ke(AST_Array,t,{elements:d.slice(r.elements.length)}),r.rest&&(i=g,g=!1,r.rest=r.rest.transform(R.option("rests")?k:W),g=i,r.rest)&&(a.length=f),g&&(v=(v=v&&!r.rest?v.drop_side_effect_free(R):v)instanceof AST_Array?v.elements:v instanceof AST_Sequence?v.expressions:v&&[v])&&v.length&&(s.length=f,[].push.apply(s,v)),v=t,x=o,g=n,d&&s&&(hn(v,s),(v=v.clone()).elements=s),e){if(!r.rest)e:switch(a.length){case 0:if(r===b)break;return g&&(v=v.drop_side_effect_free(R)),null;default:if(!g)break;if(!x)break;if(r===b)break;for(var c,f=a.length;0<=--f;){var l=a[f];if(l){c=l;break}}if(f<0)break;for(var u=f;0<=--u;)if(a[u])break e;if(c.has_side_effects(R))break;if(v.has_side_effects(R)&&c.match_symbol(function(e){return e instanceof AST_PropAccess}))break;return v=ke(AST_Sub,r,{expression:v,property:ke(AST_Number,r,{value:f})}),c}}else a.length=r.elements.length;hn(r,a),r.elements=a}else if(r instanceof AST_DestructuredObject){var _,S,p,d,n=g,o=x,t=v,A=(v instanceof AST_SymbolRef&&(g=!1,v=v.fixed_value()),v instanceof AST_Object?(_=-1,S=[],p=new Dictionary,d=v.properties.map(function(e,n){var t;return o&&e.has_side_effects(R)&&(_=n),(e=e.clone())instanceof AST_Spread?p=!1:((t=(t=e.key)instanceof AST_Node?t.evaluate(R,!0):t)instanceof AST_Node?p=!1:!p||e instanceof AST_ObjectSetter||p.set(t,e),S[n]=t),e})):_=r.properties.length,r.rest&&(v=!1,r.rest=r.rest.transform(R.option("rests")?k:W)),new Dictionary),T=g&&new Dictionary,h=[];if(r.properties.map(function(e){var n=e.key;return n instanceof AST_Node&&(e.key=n=n.transform(W),n=n.evaluate(R,!0)),n instanceof AST_Node?T=!1:A.set(n,!A.has(n)),n}).forEach(function(e,n){var t,i=r.properties[n];o&&(x=_<=n),e instanceof AST_Node?(v=g=!1,t=i.value.transform(k)||D(i.value)):(g=T&&A.get(e),(!(n=p&&p.get(e))||(v=n.value)instanceof AST_Accessor)&&(v=!1),(t=i.value.transform(k))?T&&T.set(e,!1):((r.rest||w(i))&&(t=D(i.value)),T&&!T.has(e)&&(n?(T.set(e,n),null===v&&p.set(e,w(n)&&ke(AST_ObjectKeyVal,n,{key:n.key,value:ke(AST_Number,n,{value:0})}))):T.set(e,!0))),v&&(n.value=v)),t&&(i.value=t,h.push(i))}),v=t,x=o,g=n,T&&S&&((v=v.clone()).properties=List(d,function(e,n){if(e instanceof AST_Spread)return e;n=S[n];if(n instanceof AST_Node)return e;if("__proto__"===n)return e;if(T.has(n)){var t=T.get(n);if(!t)return e;if(t===e)return p.get(n)||List.skip}else if(r.rest)return e;t=e.value.drop_side_effect_free(R);return t?(e.value=t,e):w(e)?ke(AST_ObjectKeyVal,e,{key:e.key,value:ke(AST_Number,e,{value:0})}):List.skip})),v&&!r.rest)switch(h.length){case 0:if(r===b)break;if(v.may_throw_on_access(R,!0))break;return g&&(v=v.drop_side_effect_free(R)),null;case 1:if(!g)break;if(!x)break;if(r===b)break;var m=h[0];if(m.key instanceof AST_Node)break;if(m.value.has_side_effects(R))break;if(v.has_side_effects(R)&&m.value.match_symbol(function(e){return e instanceof AST_PropAccess}))break;return v=is_identifier_string(m.key)?ke(AST_Dot,r,{expression:v,property:m.key}):ke(AST_Sub,r,{expression:v,property:Z(m.key,m)}),m.value}r.properties=h}else!(r=r instanceof AST_Hole?null:y(r))&&g&&(v=v&&v.drop_side_effect_free(R));return r});return{name:e.transform(k),value:v};function w(e){return e.key instanceof AST_Node&&e.key.has_side_effects(R)}function D(e){return e instanceof AST_DefaultValue?D(e.name):e instanceof AST_Destructured?(null===v?v=ke(AST_Number,e,{value:0}):v&&(v.may_throw_on_access(R,!0)?v=ke(AST_Array,e,{elements:v instanceof AST_Sequence?v.expressions:[v]}):function e(n){n instanceof AST_Assign?(n.write_only=!1,e(n.right)):n instanceof AST_Binary?Ne[n.operator]&&(e(n.left),e(n.right)):n instanceof AST_Conditional?(e(n.consequent),e(n.alternative)):n instanceof AST_Sequence?e(n.tail_node()):n instanceof AST_Unary&&(n.write_only=!1)}(v)),ke(AST_DestructuredObject,e,{properties:[]})):(e.unused=null,e)}}}),AST_Scope.DEFMETHOD("hoist_declarations",function(a){var s,f,c,n,l,u,_,S,p,i;!a.has_directive("use asm")&&(s=a.option("hoist_funs"),f=a.option("hoist_vars"),c=this,f&&(n=0,c.walk(new TreeWalker(function(e){return 1<n||e instanceof AST_ExportDeclaration||e instanceof AST_Scope&&e!==c||(e instanceof AST_Var?(n++,!0):void 0)})),n<=1)&&(f=!1),s||f)&&(l=new Dictionary,u=[],_=[],S=new Dictionary,p=new TreeTransformer(function(e,n,t){if(e!==c){if(e instanceof AST_Directive)return u.push(e),t?List.skip:ke(AST_EmptyStatement,e);var i;if(e instanceof AST_LambdaDefinition)return!s||(i=p.parent())instanceof AST_ExportDeclaration||i instanceof AST_ExportDefault||i!==c&&a.has_directive("use strict")?e:(_.push(e),t?List.skip:ke(AST_EmptyStatement,e));if(e instanceof AST_Var){if(!f)return e;if((i=p.parent())instanceof AST_ExportDeclaration)return e;if(!all(e.definitions,function(e){e=e.name;return e instanceof AST_SymbolVar&&!l.has(e.name)&&c.find_variable(e.name)===e.definition()}))return e;e.definitions.forEach(function(e){var n=e.name.name;S.has(n)||S.set(n,e)});var r,o=e.to_assignments();return i instanceof AST_ForEnumeration&&i.init===e?o||(r=e.definitions[0].name,ke(AST_SymbolRef,r)):i instanceof AST_For&&i.init===e?o:o?ke(AST_SimpleStatement,e,{body:o}):t?List.skip:ke(AST_EmptyStatement,e)}return e instanceof AST_Scope?e:e instanceof AST_SymbolConst?(l.set(e.name,!0),e):void 0}}),c.transform(p),0<S.size()&&(i=[],c instanceof AST_Lambda&&c.each_argname(function(e){all(e.definition().references,function(e){return!e.in_arg})&&S.del(e.name)}),S.each(function(e){var n=e.name,t=((e=e.clone()).name=n.clone(),e.value=null,i.push(e),n.definition().orig);t.splice(t.indexOf(n),0,e.name)}),0<i.length)&&_.push(ke(AST_Var,c,{definitions:i})),c.body=u.concat(_,c.body))}),AST_Scope.DEFMETHOD("process_returns",noop),AST_Defun.DEFMETHOD("process_returns",function(e){if(e.option("booleans")&&!(e.parent()instanceof AST_ExportDefault))switch(bn(this.name.definition(),gn(this),e)){case"d":wn(e,this,!0);break;case!0:xn(this,e)}}),AST_Function.DEFMETHOD("process_returns",function(n){if(n.option("booleans")){var t=!0,i=gn(this);if(!this.name||c(this.name.definition())){var e=n.parent();if(e instanceof AST_Assign){if("="!=e.operator)return;if(!((o=e.left)instanceof AST_SymbolRef))return;if(!c(o.definition()))return}else if(e instanceof AST_Call&&e.expression!==this){var r=e.expression;if(!((r=r instanceof AST_SymbolRef?r.fixed_value():r)instanceof AST_Lambda))return;if(r.uses_arguments||r.pinned())return;for(var o,a=e.args,s=0;s<a.length;s++){var f=a[s];if(f===this){if(!(o=r.argnames[s])&&r.rest)return;break}if(f instanceof AST_Spread)return}if((o=o instanceof AST_DefaultValue?o.name:o)instanceof AST_SymbolFunarg&&!c(o.definition()))return}else{if("Call"!=e.TYPE)return;n.pop();e=n.in_boolean_context();switch(n.push(this),e){case!0:t=!1;case"d":break;default:return}}t?wn(n,this,!0):xn(this,n)}}function c(e){switch(bn(e,i,n)){case!0:t=!1;case"d":return 1}}}),AST_BlockScope.DEFMETHOD("var_names",function(){var t=this._var_names;return t||(this._var_names=t=new Dictionary,this.enclosed.forEach(function(e){t.set(e.name,!0)}),this.variables.each(function(e,n){t.set(n,!0)})),t}),AST_Scope.DEFMETHOD("make_var",function(e,n,t){for(var i=[this],r=(n instanceof AST_SymbolDeclaration&&n.definition().references.forEach(function(e){var n=e.scope;do{if(!push_uniq(i,n))return}while((n=n.parent_scope)&&n!==this)}),t=t.replace(/^[^a-z_$]|[^a-z0-9_$]/gi,"_")),o=0;!all(i,function(e){return!e.var_names().has(r)});o++)r=t+"$"+o;var e=ke(e,n,{name:r,scope:this}),a=this.def_variable(e);return i.forEach(function(e){e.enclosed.push(a),e.var_names().set(r,!0)}),e}),AST_Scope.DEFMETHOD("hoist_properties",function(r){var f,o,c,l;function u(e,n,t){var i;return!(e instanceof AST_Symbol)||(i=e.definition()).assignments!=t||i.references.length-i.replaced==t||i.single_use||f.find_variable(e.name)!==i||o(i)||e.fixed_value()!==n||(t=e.fixed||i.fixed).direct_access?void 0:(!t.escaped||1!=t.escaped.depth)&&n instanceof AST_Object&&0<n.properties.length&&be(e,r)&&all(n.properties,function(e){return st(e)&&"__proto__"!==e.key})}!r.option("hoist_props")||r.has_directive("use asm")||(f=this,is_arrow(f)&&f.value)||(o=f instanceof AST_Toplevel&&r.top_retain||return_false,c=Object.create(null),l=new TreeTransformer(function(t,e){if(t instanceof AST_Assign){if("="!=t.operator)return;if(!t.write_only)return;if(!u(t.left,t.right,1))return;e(t,l);var i=new Dictionary,r=[],o=[];return t.right.properties.forEach(function(e){var n=s(AST_SymbolVar,t.left,e.key),n=(o.push(ke(AST_VarDef,t,{name:n,value:null})),ke(AST_SymbolRef,t,{name:n.name,scope:f,thedef:n.definition()}));n.reference(),r.push(ke(AST_Assign,t,{operator:"=",left:n,right:e.value}))}),i.value=t.right,c[t.left.definition().id]=i,f.body.splice(f.body.indexOf(l.stack[1])+1,0,ke(AST_Var,t,{definitions:o})),we(t,r)}var n,a;if(t instanceof AST_Scope)return t===f||"Call"==(a=l.parent()).TYPE&&a.expression===t?void 0:t;if(t instanceof AST_VarDef&&u(t.name,t.value,0))return e(t,l),i=new Dictionary,n=[],(a=t.clone()).value=t.name instanceof AST_SymbolConst?ke(AST_Number,t,{value:0}):null,n.push(a),t.value.properties.forEach(function(e){n.push(ke(AST_VarDef,t,{name:s(t.name.CTOR,t.name,e.key),value:e.value}))}),i.value=t.value,c[t.name.definition().id]=i,List.splice(n);function s(e,n,t){e=f.make_var(e,n,n.name+"_"+t);return i.set(t,e.definition()),e}}),f.transform(l),f.transform(new TreeTransformer(function(e,n){var t;if(e instanceof AST_PropAccess)return!(e.expression instanceof AST_SymbolRef&&(i=c[e.expression.definition().id])&&e.expression.fixed_value()===i.value)?void 0:(t=i.get(e.get_property()),(t=ke(AST_SymbolRef,e,{name:t.name,scope:e.expression.scope,thedef:t})).reference(),t);if(e instanceof AST_SymbolRef){var i=c[e.definition().id];if(i&&e.fixed_value()===i.value)return ke(AST_Object,e,{properties:[]})}})))}),(n=function(e,n){e.DEFMETHOD("drop_side_effect_free",n)})(AST_Node,return_this),n(AST_Accessor,return_null),n(AST_Array,function(e,n){e=_(this.elements,e,n,Dn);return e?e===this.elements&&all(e,function(e){return e instanceof AST_Spread})?this:we(this,e.map(En)):null}),n(AST_Assign,function(e){var n=this.left;if(n instanceof AST_PropAccess){var t=n.expression;if(t.may_throw_on_access(e,!0))return this;if(e.has_directive("use strict")&&t.is_constant())return this}return!n.has_side_effects(e)&&!Ne[this.operator.slice(0,-1)]&&(this.write_only=!0,root_expr(n).is_constant_expression(e.find_parent(AST_Scope)))?this.right.drop_side_effect_free(e):this}),n(AST_Await,function(e){if(!e.option("awaits"))return this;var n=this.expression;if(!h(e,n))return this;var t=(n=n instanceof AST_UnaryPrefix&&"!"==n.operator?n.expression:n).drop_side_effect_free(e);if(t===n)return this;t?h(e,t)||(t=t.negate(e)):t=ke(AST_Number,n,{value:0});e=this.clone();return e.expression=t,e}),n(AST_Binary,function(e,n){var t,i,r,o,a=this.left,s=this.right,f=this.operator;return Gn(this,e)?(t=s.drop_side_effect_free(e,n))?Ne[f]&&t.has_side_effects(e)?(i=this,t!==s&&((i=i.clone()).right=t.drop_side_effect_free(e)),"??"==f?i:((s=i.clone()).operator="&&"==f?"||":"&&",s.left=a.negate(e,n),(r=s.right.tail_node())instanceof AST_Binary&&s.operator==r.operator&&Jn(s),r=n?Ie:Y,"&&"==f?r(i,s):r(s,i))):(o=a.drop_side_effect_free(e,n))?(t=t.drop_side_effect_free(e))?we(this,[o,t]):o:t:a.drop_side_effect_free(e,n):(o=a.drop_side_effect_free(e,n))===a?this:(i=this.clone(),o?i.left=o:"instanceof"!=f||a.is_constant()?i.left=ke(AST_Number,a,{value:0}):i.left=ke(AST_Array,a,{elements:[]}),i)}),n(AST_Call,function(e,n){var t=this;if(t.is_expr_pure(e))return t.pure&&AST_Node.warn("Dropping __PURE__ call [{start}]",t),(i=_(t.args,e,n,Dn))&&we(t,i.map(En));var i=t.expression;if(t.is_call_pure(e))return(f=t.args.slice()).unshift(i.expression),(f=_(f,e,n,Dn))&&we(t,f.map(En));if(e.option("yields")&&is_generator(i)&&kn(i,e))return(s=t.clone()).expression=ke(AST_Function,i),s.expression.body=[],s;var r,o,a,s=wn(e,i);if(s&&((t=t.clone()).expression=s,i._squeezed)&&(t.expression._squeezed=!0),t instanceof AST_New){var f,s=i;if((s=s instanceof AST_SymbolRef?s.fixed_value():s)instanceof AST_Lambda){if(o=e,(r=s).new=!0,a=all(r.body,function(e){return!e.has_side_effects(o)})&&all(r.argnames,function(e){return!e.match_symbol(return_false)})&&!(r.rest&&r.rest.match_symbol(return_false)),r.new=!1,a)return(f=t.args.slice()).unshift(i),(f=_(f,e,n,Dn))&&we(t,f.map(En));s.contains_this()||((t=ke(AST_Call,t)).expression=t.expression.clone(),t.args=t.args.slice())}}return t.call_only=!0,t}),n(AST_ClassExpression,function(e,n){for(var t=this,i=[],r=[],o=0,a=t.properties,s=0;s<a.length;s++){var f=a[s];if(f.key instanceof AST_Node&&i.push(f.key),he(f)){var c=f.value;if(c.has_side_effects(e)){if(c.contains_this())return t;f instanceof AST_ClassInit?(o++,r.push(f)):r.push(c)}}}var l=t.extends;if(!l||(l=!Re(l=l instanceof AST_SymbolRef?l.fixed_value():l))||i.unshift(t.extends),i=_(i,e,n),r=_(r,e,n=i?!1:n),!i){if(!l&&!r&&!t.name)return null;i=[]}return l||t.name||!e.has_directive("use strict")?(n=mn(t),l||(n.extends=null),n.properties=[],r?r.length==o?(i.length&&r.unshift(ke(AST_ClassField,t,{key:we(t,i),value:null})),n.properties=r):n.properties.push(ke(AST_ClassField,t,{static:!0,key:i.length?we(t,i):"c",value:u()})):i.length&&n.properties.push(ke(AST_ClassMethod,t,{key:we(t,i),value:ke(AST_Function,t,{argnames:[],body:[]}).init_vars(n)})),n):(r&&i.push(ke(AST_Call,t,{expression:ke(AST_Arrow,t,{argnames:[],body:[],value:u()}).init_vars(t.parent_scope,t),args:[]})),we(t,i));function u(){return we(t,r.map(function(e){var n;return e instanceof AST_ClassInit?((n=ke(AST_Arrow,e.value)).argnames=[],ke(AST_Call,e,{expression:n,args:[]})):e}))}}),n(AST_Conditional,function(e){var n,t,i=this.consequent.drop_side_effect_free(e),r=this.alternative.drop_side_effect_free(e);return i===this.consequent&&r===this.alternative?this:(e.option("ie")&&(n=[],i instanceof AST_Function&&(n.push(i),i=null),r instanceof AST_Function)&&(n.push(r),r=null),i?r?((t=this.clone()).consequent=i,t.alternative=r):t=ke(AST_Binary,this,{operator:"&&",left:this.condition,right:i}):t=r?ke(AST_Binary,this,{operator:"||",left:this.condition,right:r}):this.condition.drop_side_effect_free(e),n?(t&&n.push(t),0==n.length?null:we(this,n)):t)}),n(AST_Constant,return_null),n(AST_Dot,function(e,n){var t=this.expression;return t.may_throw_on_access(e)?this:t.drop_side_effect_free(e,n)}),n(AST_Function,function(e){return kn(this,e)?null:this}),n(AST_LambdaExpression,return_null),n(AST_Object,function(e,n){var t=[],e=(this.properties.forEach(function(e){e instanceof AST_Spread?t.push(e):(e.key instanceof AST_Node&&t.push(e.key),t.push(e.value))}),_(t,e,n,function(e,n,t){var i=e.expression;return i.safe_to_spread()?i.drop_side_effect_free(n,t):e}));return e?e!==t||all(e,function(e){return!(e instanceof AST_Spread)})?we(this,e.map(function(e){return e instanceof AST_Spread?ke(AST_Object,e,{properties:[e]}):e})):this:null}),n(AST_ObjectIdentity,return_null),n(AST_Sequence,function(e,n){var t,i,r,o=_(this.expressions,e,n);return o?(t=o[r=o.length-1],e.option("awaits")&&0<r&&t instanceof AST_Await&&t.expression.is_constant()&&(i=(o=o.slice(0,-1))[--r],t.expression=h(e,i)?i:i.negate(e),o[r]=t),e.option("conditionals")&&0<r&&(i=o[r-1])instanceof AST_Assign&&"="==i.operator&&(r=i.left)instanceof AST_SymbolRef&&(r=In(e,r.definition(),i.right,t))&&((i=i.clone()).right=r,(o=o.slice(0,-2)).push(i.drop_side_effect_free(e,n))),o===this.expressions?this:we(this,o)):null}),n(AST_Sub,function(e,n){var t,i=this.expression;return i.may_throw_on_access(e)?this:(t=this.property,(i=i.drop_side_effect_free(e,n))?(t=t.drop_side_effect_free(e))?we(this,[i,t]):i:t.drop_side_effect_free(e,n))}),n(AST_SymbolRef,function(e){return this.is_declared(e)&&be(this,e)?null:this}),n(AST_Template,function(e,n){var t,i=this;return i.is_expr_pure(e)?0==(t=i.expressions).length?null:we(i,t).drop_side_effect_free(e,n):((n=wn(e,t=i.tag))&&((i=i.clone()).tag=n,t._squeezed)&&(i.tag._squeezed=!0),i)}),n(AST_Unary,function(e,n){var t,i=this.expression;return unary_side_effects[this.operator]?(this.write_only=!i.has_side_effects(e),this):"typeof"==this.operator&&i instanceof AST_SymbolRef&&be(i,e)?null:(t=i.drop_side_effect_free(e,n),n&&t&&le(t)?t===i&&"!"==this.operator?this:t.negate(e,n):t)}),e(AST_SimpleStatement,function(e,n){if(n.option("side_effects")){var t=e.body,n=t.drop_side_effect_free(n,!0);if(!n)return AST_Node.warn("Dropping side-effect-free statement [{start}]",e),ke(AST_EmptyStatement,e);if(n!==t)return ke(AST_SimpleStatement,e,{body:n})}return e}),e(AST_While,function(e,n){return n.option("loops")?ke(AST_For,e).optimize(n):e}),e(AST_Do,function(t,e){if(!e.option("loops"))return t;var n=N(e,t.condition);if(!(n instanceof AST_Node)){if(n&&!Cn(t,e.parent(),AST_Continue))return ke(AST_For,t,{body:ke(AST_BlockStatement,t.body,{body:[t.body,ke(AST_SimpleStatement,t.condition,{body:t.condition})]})}).optimize(e);if(!Cn(t,e.parent()))return ke(AST_BlockStatement,t.body,{body:[t.body,ke(AST_SimpleStatement,t.condition,{body:t.condition})]}).optimize(e)}if(t.body instanceof AST_BlockStatement&&!Cn(t,e.parent(),AST_Continue)){for(var i=t.body.body,r=i.length;0<=--r;){var o=i[r];if(o instanceof AST_If&&!o.alternative&&o.body instanceof AST_Break&&e.loopcontrol_target(o.body)===t){if(a(o.condition))break;t.condition=ke(AST_Binary,t,{operator:"&&",left:o.condition.negate(e),right:t.condition}),i.splice(r,1)}else if(o instanceof AST_SimpleStatement){if(a(o.body))break;t.condition=we(t,[o.body,t.condition]),i.splice(r,1)}else if(!F(o,!0))break}t.body=pn(t.body,e.parent())}return t.body instanceof AST_EmptyStatement?ke(AST_For,t).optimize(e):t.body instanceof AST_SimpleStatement?ke(AST_For,t,{condition:we(t.condition,[t.body.body,t.condition]),body:ke(AST_EmptyStatement,t)}).optimize(e):t;function a(e){var n=!1;return e.walk(new TreeWalker(function(e){return!!n||(e instanceof AST_SymbolRef?(member(e.definition(),t.enclosed)||(n=!0),!0):void 0)})),n}}),e(AST_For,function(e,n){if(!n.option("loops"))return e;if(n.option("side_effects")&&(e.init&&(e.init=e.init.drop_side_effect_free(n)),e.step)&&(e.step=e.step.drop_side_effect_free(n)),e.condition){var t=N(n,e.condition);if(t)t instanceof AST_Node||(e.body=ke(AST_BlockStatement,e.body,{body:[ke(AST_SimpleStatement,e.condition,{body:e.condition}),e.body]}),e.condition=null);else if(n.option("dead_code"))return t=[],is_statement(e.init)?t.push(e.init):e.init&&t.push(ke(AST_SimpleStatement,e.init,{body:e.init})),t.push(ke(AST_SimpleStatement,e.condition,{body:e.condition})),C(n,e.body,t),ke(AST_BlockStatement,e,{body:t}).optimize(n)}return function n(t,i){var e=a(t.body);if(i.option("dead_code")&&(e instanceof AST_Break||e instanceof AST_Continue&&s(e)||e instanceof AST_Exit))return r=[],is_statement(t.init)?r.push(t.init):t.init&&r.push(ke(AST_SimpleStatement,t.init,{body:t.init})),o=s(e)||e instanceof AST_Exit,t.condition&&o?r.push(ke(AST_If,t,{condition:t.condition,body:e,alternative:null})):t.condition?r.push(ke(AST_SimpleStatement,t.condition,{body:t.condition})):o&&r.push(e),C(i,t.body,r),ke(AST_BlockStatement,t,{body:r});if(e instanceof AST_If){var r,o=a(e.body);if(o instanceof AST_Break&&!s(o))return t.condition?t.condition=ke(AST_Binary,t.condition,{left:t.condition,operator:"&&",right:e.condition.negate(i)}):t.condition=e.condition.negate(i),r=se(e.alternative),C(i,e.body,r),f(r);if((o=a(e.alternative))instanceof AST_Break&&!s(o))return t.condition?t.condition=ke(AST_Binary,t.condition,{left:t.condition,operator:"&&",right:e.condition}):t.condition=e.condition,r=se(e.body),C(i,e.alternative,r),f(r)}return t;function a(e){return e instanceof AST_BlockStatement?e.body[0]:e}function s(e){return i.loopcontrol_target(e)!==i.self()}function f(e){return t.body instanceof AST_BlockStatement?(t.body=t.body.clone(),t.body.body=e.concat(t.body.body.slice(1)),t.body=t.body.transform(i)):t.body=ke(AST_BlockStatement,t.body,{body:e}).transform(i),n(t,i)}}(e,n)}),e(AST_ForEnumeration,function(e,n){var t;return n.option("varify")&&oe(e.init)&&(t=e.init.definitions[0].name,(n.option("module")||t instanceof AST_Destructured||t instanceof AST_SymbolLet)&&!t.match_symbol(function(e){if(e instanceof AST_SymbolDeclaration)return!Zn(e=e.definition())||Bn(n,e)},!0)?e.init=Fn(e.init,e.resolve()):e.init.can_letify(n,!0)&&(e.init=Pn(e.init,e))),e}),e(AST_If,function(e,c){if(ee(e.alternative)&&(e.alternative=null),c.option("conditionals")){if(c.option("booleans")&&!e.condition.has_side_effects(c)&&Nn(c,e.condition),c.option("dead_code")){var n=N(c,e.condition);if(!n)return AST_Node.warn("Condition always false [{start}]",e.condition),p=[ke(AST_SimpleStatement,e.condition,{body:e.condition}).transform(c)],C(c,e.body,p),e.alternative&&p.push(e.alternative),ke(AST_BlockStatement,e,{body:p}).optimize(c);if(!(n instanceof AST_Node))return AST_Node.warn("Condition always true [{start}]",e.condition),p=[ke(AST_SimpleStatement,e.condition,{body:e.condition}).transform(c),e.body],e.alternative&&C(c,e.alternative,p),ke(AST_BlockStatement,e,{body:p}).optimize(c)}var n=e.condition.negate(c),t=e.condition.print_to_string().length,i=n.print_to_string().length,r=i<t,o=(e.alternative&&r&&(r=!1,e.condition=n,o=e.body,e.body=e.alternative,e.alternative=ee(o)?null:o),[]),a=[],s=[],f=E(e.body,o,a,s),l=[],u=[],_=[],S=E(e.alternative,l,u,_);if(f instanceof AST_BlockStatement||S instanceof AST_BlockStatement){var p=[],d=[];if(f&&([].push.apply(p,o),[].push.apply(d,a),f instanceof AST_BlockStatement?e.body=f:0==f.length?e.body=ke(AST_EmptyStatement,e.body):e.body=ke(AST_SimpleStatement,e.body,{body:we(e.body,f)}),s.forEach(X)),S&&([].push.apply(p,l),[].push.apply(d,u),S instanceof AST_BlockStatement?e.alternative=S:0==S.length?e.alternative=null:e.alternative=ke(AST_SimpleStatement,e.alternative,{body:we(e.alternative,S)}),_.forEach(X)),0<d.length&&p.push(ke(AST_Var,e,{definitions:d})),0<p.length)return p.push(e.transform(c)),ke(AST_BlockStatement,e,{body:p}).optimize(c)}else if(f&&S)return p=o.concat(l),(0<a.length||0<u.length)&&p.push(ke(AST_Var,e,{definitions:a.concat(u)})),0==f.length?p.push(ke(AST_SimpleStatement,e.condition,{body:0<S.length?ke(AST_Binary,e,{operator:"||",left:e.condition,right:we(e.alternative,S)}).transform(c):e.condition.clone()}).optimize(c)):0==S.length?(t===i&&!r&&e.condition instanceof AST_Binary&&"||"==e.condition.operator&&(r=!0),p.push(ke(AST_SimpleStatement,e,{body:ke(AST_Binary,e,{operator:r?"||":"&&",left:r?n:e.condition,right:we(e.body,f)}).transform(c)}).optimize(c))):p.push(ke(AST_SimpleStatement,e,{body:ke(AST_Conditional,e,{condition:e.condition,consequent:we(e.body,f),alternative:we(e.alternative,S)})}).optimize(c)),s.forEach(X),_.forEach(X),ke(AST_BlockStatement,e,{body:p}).optimize(c);if((e=ee(e.body)?ke(AST_If,e,{condition:n,body:e.alternative,alternative:null}):e).alternative instanceof AST_Exit&&e.body.TYPE==e.alternative.TYPE){d=e.body.value,o=e.alternative.value;if(!d&&!o)return ke(AST_BlockStatement,e,{body:[ke(AST_SimpleStatement,e,{body:e.condition}),e.body]}).optimize(c);if(d&&o||!function(){var e=!1,n=0,t=c.self();do{if(t instanceof AST_Catch)c.parent(n).bfinally&&(e=!0),n++;else if(t instanceof AST_Finally)n++;else{if(t instanceof AST_Scope)return e&&B(t);t instanceof AST_Try&&t.bfinally&&(e=!0)}}while(t=c.parent(n++))}())return(l=ke(e.body.CTOR,e,{value:ke(AST_Conditional,e,{condition:e.condition,consequent:d||ke(AST_Undefined,e.body).transform(c),alternative:o||ke(AST_Undefined,e.alternative).transform(c)})}))instanceof AST_Return&&(l.in_bool=e.body.in_bool||e.alternative.in_bool),l}if(q((e=e.body instanceof AST_If&&!e.body.alternative&&!e.alternative?ke(AST_If,e,{condition:ke(AST_Binary,e.condition,{operator:"&&",left:e.condition,right:e.body.condition}),body:e.body.body,alternative:null}):e).body)&&e.alternative)return a=e.alternative,e.alternative=null,ke(AST_BlockStatement,e,{body:[e,a]}).optimize(c);if(q(e.alternative))return p=e.body,e.body=e.alternative,e.condition=r?n:e.condition.negate(c),e.alternative=null,ke(AST_BlockStatement,e,{body:[e,p]}).optimize(c);if(e.alternative){for(var A=k(e.body),T=w(A),h=k(e.alternative),m=w(h),v=[];0<=T&&0<=m;){var y=A[T],g=h[m];if(y.equals(g))A.splice(T--,1),h.splice(m--,1),v.unshift(P(y,g));else{if(!(y instanceof AST_SimpleStatement))break;if(!(g instanceof AST_SimpleStatement))break;var b=y.body.tail_node(),x=g.body.tail_node();if(!b.equals(x))break;T=D(A,y.body,T),m=D(h,g.body,m),v.unshift(ke(AST_SimpleStatement,b,{body:P(b,x)}))}}if(0<v.length)return e.body=0<A.length?ke(AST_BlockStatement,e,{body:A}):ke(AST_EmptyStatement,e),e.alternative=0<h.length?ke(AST_BlockStatement,e,{body:h}):null,v.unshift(e),ke(AST_BlockStatement,e,{body:v}).optimize(c)}c.option("typeofs")&&z(e.condition,e.body,e.alternative)}return e;function k(e){return e instanceof AST_BlockStatement?e.body:[e]}function w(e){for(var n=e.length;0<=--n&&F(e[n],!0););return n}function D(e,n,t){return n instanceof AST_Sequence?e[t]=ke(AST_SimpleStatement,n,{body:we(n,n.expressions.slice(0,-1))}):e.splice(t--,1),t}function E(e,n,t,i){if(null==e)return[];if(e instanceof AST_BlockStatement){for(var r=[],o=0;o<e.body.length;o++){var a=e.body[o];if(!(a instanceof AST_EmptyStatement)){if(a instanceof AST_Exit){if(0==o)return;0<r.length&&(a=a.clone(),r.push(a.value||ke(AST_Undefined,a).transform(c)),a.value=we(e,r));var s=e.clone();return s.body=s.body.slice(o+1),s.body.unshift(a),s}if(a instanceof AST_LambdaDefinition)n.push(a);else if(a instanceof AST_SimpleStatement){if(!c.option("sequences")&&0<r.length)return;r.push(a.body)}else{if(!(a instanceof AST_Var))return;if(!c.option("sequences")&&0<r.length)return;a.remove_initializers(c,t),a.definitions.forEach(f)}}}return r}return e instanceof AST_LambdaDefinition?(n.push(e),[]):e instanceof AST_EmptyStatement?[]:e instanceof AST_SimpleStatement?[e.body]:e instanceof AST_Var?(r=[],e.remove_initializers(c,t),e.definitions.forEach(f),r):void 0;function f(e){e.value&&r.push(ke(AST_Assign,e,{operator:"=",left:e.name.convert_symbol(AST_SymbolRef,function(e){i.push(e)}),right:e.value}))}}}),e(AST_Switch,function(i,t){if(t.option("switches")&&t.option("dead_code")){for(var e,n,r,o=[],a=[],s=[],f=0,c=i.body.length;f<c;f++){if((e=i.body[f])instanceof AST_Default){var l=o[o.length-1];if(n||v(e.body[0],t)&&(!l||q(l))){g(e,l);continue}n=e}else{var u=e.expression,_=ke(AST_Binary,i,{operator:"===",left:i.expression,right:u}).evaluate(t,!0);if(!_){u.has_side_effects(t)&&s.push(u),g(e,o[o.length-1]);continue}if(!(_ instanceof AST_Node))for(n&&(_=o.indexOf(n),o.splice(_,1),g(n,o[_-1]),n=null),u.has_side_effects(t)?r=e:n=e=ke(AST_Default,e);++f<c;)g(i.body[f],e)}if(c<=f+1||q(e)){var S,l=o[o.length-1],p=e.body;if(q(l))switch(l.body.length-p.length){case 1:if(!v(S=l.body[l.body.length-1],t))break;p=p.concat(S);case 0:var d=ke(AST_BlockStatement,l),A=ke(AST_BlockStatement,e,{body:p});d.equals(A)&&(l.body=[])}}s.length&&(e instanceof AST_Default?o.push(ke(AST_Case,i,{expression:we(i,s),body:[]})):(s.push(e.expression),e.expression=we(i,s)),s=[]),o.push(e)}for(s.length&&!r&&o.push(ke(AST_Case,i,{expression:we(i,s),body:[]}));e=o[o.length-1];){if(v(S=e.body[e.body.length-1],t)&&e.body.pop(),e===n){if(!fe(e))break}else{if(e.expression.has_side_effects(t))break;if(n){if(!fe(n))break;if(o[o.length-2]!==n)break;n.body=n.body.concat(e.body),e.body=[]}else if(!fe(e))break}g(e),o.pop()===n&&(n=null)}if(!e)return a.push(ke(AST_SimpleStatement,i.expression,{body:i.expression})),s.length&&a.push(ke(AST_SimpleStatement,i,{body:we(i,s)})),ke(AST_BlockStatement,i,{body:a}).optimize(t);if(e===n)for(;(e=o[o.length-2])&&!(e instanceof AST_Default)&&fe(e);){if((u=e.expression).has_side_effects(t)){if((l=o[o.length-3])&&!q(l))break;n.body.unshift(ke(AST_SimpleStatement,i,{body:u}))}g(e),o.splice(-2,1)}if(o[0].body=a.concat(o[0].body),i.body=o,t.option("conditionals"))switch(o.length){case 1:if(y(o[0]))return u=o[0].expression,p=o[0].body.slice(),(o[0]!==n&&o[0]!==r?ke(AST_If,i,{condition:ke(AST_Binary,i,{operator:"===",left:i.expression,right:u}),body:ke(AST_BlockStatement,i,{body:p}),alternative:null}):(u&&p.unshift(ke(AST_SimpleStatement,u,{body:u})),p.unshift(ke(AST_SimpleStatement,i.expression,{body:i.expression})),ke(AST_BlockStatement,i,{body:p}))).optimize(t);break;case 2:if(member(n,o)&&y(o[1])){var T,h,m=(p=o[0].body.slice()).length&&v(p[p.length-1],t);if(m&&p.pop(),all(p,y))return T=o[1].body.length&&ke(AST_BlockStatement,o[1]),h=ke(AST_If,i,{condition:ke(AST_Binary,i,o[0]===n?{operator:"!==",left:i.expression,right:o[1].expression}:{operator:"===",left:i.expression,right:o[0].expression}),body:ke(AST_BlockStatement,o[0],{body:p}),alternative:m&&T||null}),(h=!m&&T?ke(AST_BlockStatement,i,{body:[h,T]}):h).optimize(t)}}}return i;function v(e,n){return e instanceof AST_Break&&n.loopcontrol_target(e)===i}function y(e){var n=!1,t=new TreeWalker(function(e){if(n||e instanceof AST_Lambda||e instanceof AST_SimpleStatement)return!0;v(e,t)&&(n=!0)});return t.push(i),e.walk(t),!n}function g(e,n){n&&!q(n)?n.body=n.body.concat(e.body):C(t,e,a)}}),e(AST_Try,function(e,n){if(e.body=me(e.body,n),n.option("dead_code")){if(fe(e)&&!(e.bcatch&&e.bcatch.argname&&e.bcatch.argname.match_symbol(function(e){return e instanceof AST_SymbolCatch&&!be(e)},!0)))return t=[],e.bcatch&&(C(n,e.bcatch,t),t.forEach(function(e){e instanceof AST_Var&&e.definitions.forEach(function(e){var n=e.name.definition().redefined();n&&(e.name=e.name.clone(),e.name.thedef=n)})})),t.unshift(ke(AST_BlockStatement,e).optimize(n)),e.bfinally&&t.push(ke(AST_BlockStatement,e.bfinally).optimize(n)),ke(AST_BlockStatement,e,{body:t}).optimize(n);if(e.bfinally&&fe(e.bfinally)){var t=ke(AST_BlockStatement,e.bfinally).optimize(n);if(t=e.body.concat(t),!e.bcatch)return ke(AST_BlockStatement,e,{body:t}).optimize(n);e.body=t,e.bfinally=null}}return e}),AST_Const.DEFMETHOD("remove_initializers",Rn(function(e,n){return ke(AST_Undefined,n).optimize(e)})),AST_Let.DEFMETHOD("remove_initializers",Rn(return_null)),AST_Var.DEFMETHOD("remove_initializers",Rn(return_null)),AST_Definitions.DEFMETHOD("to_assignments",function(){var e=this.definitions.reduce(function(e,t){var n,i,r,o=t.name.definition(),a=t.value;return a&&(a instanceof AST_Sequence&&(a=a.clone()),n=ke(AST_SymbolRef,t.name),i=ke(AST_Assign,t,{operator:"=",left:n,right:a}),e.push(i),(r=function(){return i.right}).assigns=[i],r.direct_access=o.direct_access,r.escaped=o.escaped,n.fixed=r,o.references.forEach(function(e){var n;e.fixed&&(n=e.fixed.assigns)&&n[0]===t&&(1<n.length||e.fixed.to_binary||e.fixed.to_prefix?n[0]=i:(e.fixed=r,o.fixed===e.fixed&&(o.fixed=r)))}),o.references.push(n),o.assignments++),o.eliminated++,e},[]);return 0==e.length?null:we(this,e)}),(n=function(e,n){e.DEFMETHOD("can_letify",n)})(AST_Node,return_false),n(AST_Const,function(e,n){n=n?1:0;var t=this.definitions;return!(!e.option("module")&&all(t,function(e){return e.name instanceof AST_SymbolConst}))&&all(t,function(e){return!e.name.match_symbol(function(e){if(e instanceof AST_SymbolDeclaration)return e.definition().assignments!=n},!0)})}),n(AST_Var,function(i){return all(this.definitions,function(e){return!e.name.match_symbol(function(e){var n,t;return e instanceof AST_SymbolDeclaration&&((n=e.definition()).first_decl!==e||!qn(i,e)||!((t=e.scope)instanceof AST_Scope||all(n.references,function(e){var n=e.scope;do{if(n===t)return!0}while(n=n.parent_scope);return!1})))},!0)})}),AST_Definitions.DEFMETHOD("can_varify",function(n){return all(this.definitions,function(e){return!e.name.match_symbol(function(e){if(e instanceof AST_SymbolDeclaration)return!qn(n,e)},!0)})}),e(AST_Const,function(e,n){return n.option("varify")?e.can_varify(n)?Fn(e,n.find_parent(AST_Scope)):e.can_letify(n)?Pn(e,xe(n)):e:e}),e(AST_Let,function(e,n){return n.option("varify")&&e.can_varify(n)?Fn(e,n.find_parent(AST_Scope)):e}),e(AST_Call,function(_,c){var o=_.expression,e=zn(_,c);if(e)return e;if(c.option("sequences"))if(o instanceof AST_PropAccess){if((m=G(o))!==o)return(v=_.clone()).expression=m.expressions.pop(),m.expressions.push(v),m.optimize(c)}else if(!ie(o.tail_node()))if((m=G(_))!==_)return m.optimize(c);if(c.option("unused")&&Un(_,c),c.option("unsafe"))if(Ee(o))switch(o.name){case"Array":if(1==_.args.length){if((s=_.args[0])instanceof AST_Number)try{var n=s.value;if(6<n)break;for(var t=Array(n),i=0;i<n;i++)t[i]=ke(AST_Hole,_);return ke(AST_Array,_,{elements:t})}catch(e){AST_Node.warn("Invalid array length: {length} [{start}]",{length:n,start:_.start});break}if(!s.is_boolean(c)&&!s.is_string(c))break}return ke(AST_Array,_,{elements:_.args});case"Object":if(0==_.args.length)return ke(AST_Object,_,{properties:[]});break;case"String":if(0==_.args.length)return ke(AST_String,_,{value:""});if(1==_.args.length)return ke(AST_Binary,_,{operator:"+",left:ke(AST_String,_,{value:""}),right:_.args[0]}).optimize(c);break;case"Number":if(0==_.args.length)return ke(AST_Number,_,{value:0});if(1==_.args.length)return ke(AST_UnaryPrefix,_,{operator:"+",expression:ke(AST_Binary,_,{operator:"+",left:ke(AST_String,_,{value:""}),right:_.args[0]})}).optimize(c);break;case"Boolean":if(0==_.args.length)return ke(AST_False,_).optimize(c);if(1==_.args.length)return ke(AST_UnaryPrefix,_,{operator:"!",expression:ke(AST_UnaryPrefix,_,{operator:"!",expression:_.args[0]})}).optimize(c);break;case"RegExp":var q=[];if(all(_.args,function(e){var n=e.evaluate(c);return q.unshift(n),e!==n}))try{return Me(c,_,ke(AST_RegExp,_,{value:RegExp.apply(RegExp,q)}))}catch(e){AST_Node.warn("Error converting {this} [{start}]",_)}}else if(o instanceof AST_Dot)switch(o.property){case"toString":var r=o.expression;if(0!=_.args.length||r.may_throw_on_access(c)||r instanceof AST_Super)break;return ke(AST_Binary,_,{operator:"+",left:ke(AST_String,_,{value:""}),right:r}).optimize(c);case"join":if(o.expression instanceof AST_Array&&_.args.length<2)e:{var a=_.args[0];if(0==o.expression.elements.length&&!(a instanceof AST_Spread))return a?we(_,[a,ke(AST_String,_,{value:""})]).optimize(c):ke(AST_String,_,{value:""});if(!(a&&(a=a.evaluate(c))instanceof AST_Node)){for(var s,t=[],f=[],i=0;i<o.expression.elements.length;i++){var l=o.expression.elements[i];if((x=l.evaluate(c))!==l)f.push(x);else{if(l instanceof AST_Spread)break e;0<f.length&&(t.push(ke(AST_String,_,{value:f.join(a)})),f.length=0),t.push(l)}}return(0<f.length&&t.push(ke(AST_String,_,{value:f.join(a)})),1==t.length)?t[0].is_string(c)?t[0]:ke(AST_Binary,t[0],{operator:"+",left:ke(AST_String,_,{value:""}),right:t[0]}):""==a?(s=t[0].is_string(c)||t[1].is_string(c)?t.shift():ke(AST_String,_,{value:""}),t.reduce(function(e,n){return ke(AST_Binary,n,{operator:"+",left:e,right:n})},s).optimize(c)):((B=_.clone()).expression=B.expression.clone(),B.expression.expression=B.expression.expression.clone(),B.expression.expression.elements=t,Me(c,_,B))}}break;case"charAt":if(_.args.length<2)return(B=ke(AST_Binary,_,{operator:"||",left:ke(AST_Sub,_,{expression:o.expression,property:_.args.length?ke(AST_Binary,_.args[0],{operator:"|",left:ke(AST_Number,_,{value:0}),right:_.args[0]}):ke(AST_Number,_,{value:0})}).optimize(c),right:ke(AST_String,_,{value:""})})).is_string=return_true,B.optimize(c);break;case"apply":if(2==_.args.length&&_.args[1]instanceof AST_Array)return(R=_.args[1].elements.slice()).unshift(_.args[0]),ke(AST_Call,_,{expression:ke(AST_Dot,o,{expression:o.expression,property:"call"}),args:R}).optimize(c);break;case"call":r=o.expression;if((r=r instanceof AST_SymbolRef?r.fixed_value():r)instanceof AST_Lambda&&!r.contains_this())return(_.args.length?we(_,[_.args[0],ke(AST_Call,_,{expression:o.expression,args:_.args.slice(1)})]):ke(AST_Call,_,{expression:o.expression,args:[]})).optimize(c)}else if(c.option("side_effects")&&o instanceof AST_Call&&1==o.args.length&&Ee(o.expression)&&"Object"==o.expression.name)return(v=_.clone()).expression=De(_,o,o.args[0]),v.optimize(c);if(c.option("unsafe_Function")&&Ee(o)&&"Function"==o.name){if(0==_.args.length)return ke(AST_Function,_,{argnames:[],body:[]}).init_vars(o.scope);if(all(_.args,function(e){return e instanceof AST_String}))try{var u,S="n(function("+_.args.slice(0,-1).map(function(e){return e.value}).join()+"){"+_.args[_.args.length-1].value+"})",p=parse(S),d={ie:c.option("ie")},A=(p.figure_out_scope(d),new Compressor(c.options)),S=((p=p.transform(A)).figure_out_scope(d),p.compute_char_frequency(d),p.mangle_names(d),p.walk(new TreeWalker(function(e){return!!u||(e instanceof AST_Lambda?(u=e,!0):void 0)})),OutputStream());return AST_BlockStatement.prototype._codegen.call(u,S),_.args=[ke(AST_String,_,{value:u.argnames.map(function(e){return e.print_to_string()}).join()}),ke(AST_String,_.args[_.args.length-1],{value:S.get().replace(/^\{|\}$/g,"")})],_}catch(e){if(!(e instanceof JS_Parse_Error))throw e;AST_Node.warn("Error parsing code passed to new Function [{start}]",_.args[_.args.length-1]),AST_Node.warn(e.toString())}}var T=o instanceof AST_SymbolRef?o.fixed_value():o,e=c.parent(),h=c.self(),m=T instanceof AST_Lambda&&(!is_async(T)||c.option("awaits")&&e instanceof AST_Await)&&(!is_generator(T)||c.option("yields")&&h instanceof AST_Yield&&h.nested),v=m&&T.first_statement(),y=0,g=!1,b=!all(_.args,function(e){return!(e instanceof AST_Spread)}),A=m&&all(T.argnames,function(e,n){if(1==y&&_.args[n]instanceof AST_Spread&&(y=2),e instanceof AST_DefaultValue){if(Ce(1==(y=y||1)&&_.args[n])||(y=2),ct(T,e.value))return!1;e=e.name}return!(e instanceof AST_Destructured&&(g=!0,ct(T,e)))})&&!(T.rest instanceof AST_Destructured&&ct(T,T.rest)),d=A&&c.option("inline")&&!_.is_expr_pure(c)&&(o===T||Vn(T,c));if(d&&v instanceof AST_Return){var x=v.value;if(o===T&&!T.name&&(!x||x.is_constant_expression())&&Ln(T,jn(c)))return we(_,L(x)).optimize(c)}if(m&&!T.contains_this()){var k,w=!1;if(d&&!T.uses_arguments&&!T.pinned()&&!(T.name&&T instanceof AST_LambdaExpression)&&(o===T||!Qn(c,k=o.definition(),T)&&T.is_constant_expression(xe(c)))&&(x=function(e){var n=T.body.length;if(n<2&&(e=I(e)))return e;if(c.option("inline")<3)return!1;e=null;for(var t=0;t<n;t++){var i=T.body[t];if(i instanceof AST_Var){if(w){if(e){if(!(e instanceof AST_SimpleStatement))return!1;W(i)||(e=null)}}else if(!W(i)){if(e&&!(e instanceof AST_SimpleStatement))return!1;w=!(e=null)}}else if(!(i instanceof AST_AsyncDefun||i instanceof AST_Defun||i instanceof AST_EmptyStatement)){if(e)return!1;e=i}}return I(e)}(v))){var D,z,E,C,N=o===T||k.single_use&&k.references.length-k.replaced==1;if(function(){if(!(y||g||b||w||T.rest)&&!(c.option("inline")<2&&T.argnames.length)&&T.variables.all(function(e){return e.references.length-e.replaced<2&&e.orig[0]instanceof AST_SymbolFunarg})){var i,n=c.find_parent(AST_Scope),r=!1,o=jn(c,n),a=[],s=!1,f=new TreeWalker(function(e,n){var t;return!!r||(e instanceof AST_Binary&&Ne[e.operator]||e instanceof AST_Conditional?void(a=null):e instanceof AST_Class?r=!0:e instanceof AST_Destructured?void(s=!0):e instanceof AST_Scope||o&&e instanceof AST_Symbol&&o[e.name]?r=!0:e instanceof AST_SymbolRef?(t=e.definition(),T.variables.get(e.name)!==t?void(a=null):t.init instanceof AST_LambdaDefinition||is_lhs(e,f.parent())?r=!0:(t=M(t),i<t||(i=t),a?void(s?a=null:a.push(T.argnames[t])):void 0)):s?void 0:e instanceof AST_Assign&&e.left instanceof AST_PropAccess?(e.left.expression.walk(f),e.left instanceof AST_Sub&&e.left.property.walk(f),e.right.walk(f),s=!0):e.has_side_effects(c)?(n(),s=!0):void 0)});if(x.walk(f),!r){var e=_.args.length;if(a&&T.argnames.length>=e){for(e=T.argnames.length;e-- >i&&T.argnames[e]===a.pop(););e++}return e<=i||all(_.args.slice(i,e),s&&!a?function(e){return e.is_constant_expression(n)}:function(e){return!e.has_side_effects(c)})}}}()){_._optimized=!0;var p=x.optimize(c).clone(!0),R=_.args.slice(),O=[],p=p.transform(new TreeTransformer(function(e){if(e instanceof AST_SymbolRef){var n=e.definition();if(T.variables.get(e.name)!==n)return O.push(e),e;var n=M(n),t=R[n];if(!t)return ke(AST_Undefined,_);R[n]=null;n=this.parent();return n?De(n,e,t):t}})),S=T.inlined,U=(o!==T&&(T.inlined=!0),[]),B=(R.forEach(function(e){e&&((e=e.clone(!0)).walk(new TreeWalker(function(e){e instanceof AST_SymbolRef&&O.push(e)})),U.push(e))},[]),U.push(p),we(_,U).optimize(c));if(T.inlined=S,B=De(e,h,B),N||Y(B,_)===B)return O.forEach(function(e){e.scope=o===T?T.parent_scope:o.scope,e.reference();e=e.definition();N&&e.replaced++,e.single_use=!1}),B;B.has_side_effects(c)||(_.drop_side_effect_free=function(e,n){var t=this.args.slice();return t.unshift(this.expression),we(this,t).drop_side_effect_free(e,n)})}if(N&&function(){var e,n=new Dictionary,t=0;C=h;do{if(C.variables&&C.variables.each(function(e){n.set(e.name,!0)}),e=C,(C=c.parent(t++))instanceof AST_ClassField){if(!C.static)return}else C instanceof AST_DWLoop?E=[]:C instanceof AST_For?C.init!==e&&(E=[]):C instanceof AST_ForEnumeration&&C.init!==e&&C.object!==e&&(E=[])}while(!(C instanceof AST_Scope));if(!(z=C.body.indexOf(e)+1))return;if(!Ln(T,jn(c,C)))return;var i=(o!==T||T.parent_scope.resolve()===C)&&!C.pinned();C instanceof AST_Toplevel&&(c.toplevel.vars?n.set("arguments",!0):i=!1);D=new Dictionary;var r=c.option("inline");return function(n,t){var i=!1;return T.each_argname(function(e){if(!i&&!e.unused){if(!t||H(n,e.name))return i=!0;D.set(e.name,!0),E&&E.push(e.definition())}}),!i}(n,2<=r&&i)&&!(!function(n,e){for(var t=0;t<T.body.length;t++){var i=T.body[t];if(i instanceof AST_LambdaDefinition){var r=i.name;if(!e)return;if(D.has(r.name))return;if(H(n,r.name))return;if(!all(i.enclosed,function(e){return e.scope===C||e.scope===i||!n.has(e.name)}))return;E&&E.push(r.definition())}else if(i instanceof AST_Var){if(!e)return;for(var o=i.definitions.length;0<=--o;){r=i.definitions[o].name;if(H(n,r.name))return;E&&E.push(r.definition())}}}return 1}(n,3<=r&&i)||E&&0!=E.length&&it(T,E))}())return T._squeezed=!0,o!==T&&(T.parent_scope=o.scope),B=we(_,function(){var e=[],n=[];(1<y||g||b||T.rest?function(i,r){function n(e,n){if(n.unused)return j(n);var t=n.definition(),e=(t.assignments++,t.references.push(e),ke(AST_SymbolVar,n));t.orig.push(e),t.eliminated++,F(i,r,e)}r.push(ke(AST_Assign,_,{operator:"=",left:ke(AST_DestructuredArray,_,{elements:T.argnames.map(function(e){return e.unused?ke(AST_Hole,e):e.convert_symbol(AST_SymbolRef,n)}),rest:T.rest&&T.rest.convert_symbol(AST_SymbolRef,n)}),right:ke(AST_Array,_,{elements:_.args.slice()})}))}:function(e,n){for(var t=T.argnames.length,i=_.args.length;--i>=t;)n.push(_.args[i]);var r,o=[];for(i=t;0<=--i;){var a,s,f=T.argnames[i],c=(r=f instanceof AST_DefaultValue?(o.push(f),f.name):f,_.args[i]);r.unused||C.var_names().has(r.name)?c&&n.push(c):(a=ke(AST_SymbolVar,r),(s=r.definition()).orig.push(a),s.eliminated++,void 0!==r.unused?(F(e,n,a),c&&n.push(c)):(!c&&f===r&&(E||"arguments"==r.name&&!is_arrow(T)&&is_arrow(C))&&(c=ke(AST_Undefined,_)),F(e,n,a,c)))}for(e.reverse(),n.reverse(),i=o.length;0<=--i;){var l,u=o[i];void 0!==u.name.unused?n.push(u.value):(l=ke(AST_SymbolRef,u.name),u.name.definition().references.push(l),n.push(ke(AST_Assign,u,{operator:"=",left:l,right:u.value})))}})(e,n);var t=function(i,e){var t=[z,0],o=[],r=[],a=[],s=[],f=[];return T.body.filter(E?function(e){var n,t;return!(e instanceof AST_LambdaDefinition&&((t=(n=ke(AST_SymbolVar,ft(e.name))).definition()).fixed=!1,t.orig.push(n),t.eliminated++,F(i,r,n,vn(e,!0)),1))}:function(e){var n;return!(e instanceof AST_LambdaDefinition&&(n=e.name.definition(),C.functions.set(n.name,n),C.variables.set(n.name,n),C.enclosed.push(n),C.var_names().set(n.name,!0),t.push(e),1))}).forEach(function(e){if(e instanceof AST_Var)for(var n=0;n<e.definitions.length;n++){var t=e.definitions[n],i=ft(t.name),r=t.value;r&&0<f.length&&(f.push(r),r=we(t,f),f=[]),F(o,a,i,r),!E||D.has(i.name)||1==i.definition().orig.length&&T.functions.has(i.name)||s.push(ut(c,i))}else e instanceof AST_SimpleStatement&&f.push(e.body)}),[].push.apply(i,o),[].push.apply(e,s),[].push.apply(e,r),[].push.apply(e,a),t}(e,n);n.push(x),e.length&&t.push(ke(AST_Var,T,{definitions:e}));return[].splice.apply(C.body,t),T.enclosed.forEach(function(e){C.var_names().has(e.name)||(C.enclosed.push(e),C.var_names().set(e.name,!0))}),n}()).optimize(c),De(e,h,B)}if(c.option("side_effects")&&A&&all(T.body,ee)&&(T===o?kn(T,c):!y&&!g&&!T.rest)&&(!is_arrow(T)||!T.value)&&Ln(T,jn(c)))return we(_,L()).optimize(c)}if(c.option("drop_console")&&o instanceof AST_PropAccess){for(var P=o.expression;P.expression;)P=P.expression;if(Ee(P)&&"console"==P.name)return ke(AST_Undefined,_).optimize(c)}return c.option("negate_iife")&&e instanceof AST_SimpleStatement&&le(h)?_.negate(c,!0):K(c,_);function j(e){return ke(AST_Sub,e,{expression:ke(AST_Array,e,{elements:[]}),property:ke(AST_Number,e,{value:0})})}function L(e){var a,t,n=_.args.slice(),i=1<y||g||T.rest;return(i||b)&&(n=[ke(AST_Array,_,{elements:n})]),i?(a=new TreeTransformer(function(i,e){var t,r,o;return i instanceof AST_DefaultValue?ke(AST_DefaultValue,i,{name:i.name.transform(a)||j(i),value:i.value}):i instanceof AST_DestructuredArray?(t=[],i.elements.forEach(function(e,n){(e=e.transform(a))&&(t[n]=e)}),hn(i,t),ke(AST_DestructuredArray,i,{elements:t})):i instanceof AST_DestructuredObject?(r=[],o=[],i.properties.forEach(function(e){var n=e.key,t=e.value.transform(a);t?(o.length&&(n instanceof AST_Node||(n=Z(n,e)),o.push(n),n=we(i,o),o=[]),r.push(ke(AST_DestructuredKeyVal,e,{key:n,value:t}))):n instanceof AST_Node&&o.push(n)}),o.length&&r.push(ke(AST_DestructuredKeyVal,i,{key:we(i,o),value:j(i)})),ke(AST_DestructuredObject,i,{properties:r})):i instanceof AST_SymbolFunarg?null:void 0}),t=[],T.argnames.forEach(function(e,n){(e=e.transform(a))&&(t[n]=e)}),(i=T.rest&&T.rest.transform(a))&&(t.length=T.argnames.length),hn(T,t),n[0]=ke(AST_Assign,_,{operator:"=",left:ke(AST_DestructuredArray,T,{elements:t,rest:i}),right:n[0]})):T.argnames.forEach(function(e){e instanceof AST_DefaultValue&&n.push(e.value)}),n.push(e||ke(AST_Undefined,_)),n}function V(){return _.call_only?ke(AST_Number,_,{value:0}):ke(AST_Undefined,_)}function I(e){return e?e instanceof AST_Return?e.value||V():e instanceof AST_SimpleStatement?_.call_only?e.body:ke(AST_UnaryPrefix,e,{operator:"void",expression:e.body}):void 0:V()}function M(e){for(var n=T.argnames.length;0<=--n;)if(T.argnames[n].definition()===e)return n}function H(e,n){return e.has(n)||te[n]||C.var_names().has(n)}function F(e,n,t,i){var r=t.definition();C.var_names().has(t.name)||(r.first_decl=null,C.var_names().set(t.name,!0),e.push(ke(AST_VarDef,t,{name:t,value:null}))),C.variables.set(t.name,r),C.enclosed.push(r),i&&(e=ke(AST_SymbolRef,t),r.assignments++,r.references.push(e),n.push(ke(AST_Assign,_,{operator:"=",left:e,right:i})))}}),e(AST_New,function(e,n){if(n.option("unsafe")){var t=e.expression;if(Ee(t))switch(t.name){case"Array":case"Error":case"Function":case"Object":case"RegExp":return ke(AST_Call,e).transform(n)}}if(n.option("sequences")){t=G(e);if(t!==e)return t.optimize(n)}return n.option("unused")&&Un(e,n),e}),e(AST_Sequence,function(e,t){for(var i,r,o,n=t.option("side_effects")?(i=[],r=first_in_statement(t),o=e.expressions.length-1,e.expressions.forEach(function(e,n){(e=n<o?e.drop_side_effect_free(t,r):e)&&(re(i,e),r=!1)}),i):e.expressions,a=n.length-1,s=1;s<a;s++){var f=n[s-1],c=_(f);if(c){var l=n[s];if(t.option("conditionals")){var u=In(t,c,f.right,l);if(u){f.right=u,n.splice(s--,1),a--;continue}}t.option("dead_code")&&_(l)===c&&l.right.is_constant_expression(c.scope.resolve())&&(n[--s]=f.right)}}if(t.option("side_effects")){for(;0<a&&Ce(n[a],t);)a--;a<n.length-1&&(n[a]=ke(AST_UnaryPrefix,e,{operator:"void",expression:n[a]}),n.length=a+1)}return 0==a?(e=De(t.parent(),t.self(),n[0]))instanceof AST_Sequence?e:e.optimize(t):(e.expressions=n,e);function _(e){return e instanceof AST_Assign&&"="==e.operator&&e.left instanceof AST_SymbolRef&&e.left.definition()}}),e(AST_UnaryPostfix,function(e,n){if(n.option("sequences")){var t=G(e);if(t!==e)return t.optimize(n)}return K(n,e)});var Mn=makePredicate("+ -"),Hn=makePredicate("* / %"),Wn=(e(AST_UnaryPrefix,function(e,n){var t=e.operator,i=e.expression;if(n.option("sequences")&&function(){switch(t){case"delete":return!a(i.tail_node());case"typeof":return!Ee(i.tail_node());default:return 1}}()){var r=G(e);if(r!==e)return r.optimize(n)}switch(t){case"+":if(!n.option("evaluate"))break;if(!i.is_number(n,!0))break;var o=n.parent();if(o instanceof AST_UnaryPrefix&&"delete"==o.operator)break;return i;case"-":if((i=i instanceof AST_Infinity?i.transform(n):i)instanceof AST_Number||i instanceof AST_Infinity)return e;break;case"!":if(n.option("booleans")){if(i.is_truthy())return we(e,[i,ke(AST_False,e)]).optimize(n);if(n.in_boolean_context()){if(i instanceof AST_UnaryPrefix&&"!"==i.operator)return i.expression;i instanceof AST_Binary&&(e=((o=first_in_statement(n))?Ie:Y)(e,i.negate(n,o)))}}break;case"delete":if(!n.option("evaluate"))break;if(a(i))break;return we(e,[i,ke(AST_True,e)]).optimize(n);case"typeof":if(!n.option("booleans"))break;if(!n.in_boolean_context())break;AST_Node.warn("Boolean expression always true [{start}]",e);o=[ke(AST_True,e)];return i instanceof AST_SymbolRef&&be(i,n)||o.unshift(i),we(e,o).optimize(n);case"void":if(n.option("side_effects"))return(i=i.drop_side_effect_free(n))?(e.expression=i,e):ke(AST_Undefined,e).optimize(n)}return n.option("evaluate")&&i instanceof AST_Binary&&Mn[t]&&Hn[i.operator]&&(i.left.is_constant()||!i.right.has_side_effects(n))?ke(AST_Binary,e,{operator:i.operator,left:ke(AST_UnaryPrefix,i.left,{operator:t,expression:i.left}),right:i.right}):K(n,e);function a(e){return e instanceof AST_Infinity||e instanceof AST_NaN||e instanceof AST_NewTarget||e instanceof AST_PropAccess||e instanceof AST_SymbolRef||e instanceof AST_Undefined}}),e(AST_Await,function(e,n){if(n.option("awaits")){if(n.option("sequences")){var t=G(e);if(t!==e)return t.optimize(n)}if(n.option("side_effects")){var i=e.expression;if(i instanceof AST_Await)return i.optimize(n);if(i instanceof AST_UnaryPrefix&&i.expression instanceof AST_Await)return i.optimize(n);for(var r,o=0,a=e;r=n.parent(o++);a=r){if(is_arrow(r)){if(r.value===a)return i.optimize(n)}else if(r instanceof AST_Return){var s=!0;do{if(a=r,(r=n.parent(o++))instanceof AST_Try&&(r.bfinally||r.bcatch)!==a){s=!1;break}}while(r&&!(r instanceof AST_Scope));if(s)return i.optimize(n)}else if(r instanceof AST_Sequence&&r.tail_node()===a)continue;break}}}return e}),e(AST_Yield,function(e,n){if(n.option("yields")){if(n.option("sequences")){var t=G(e);if(t!==e)return t.optimize(n)}t=e.expression;if(e.nested&&"Call"==t.TYPE){t=t.clone().optimize(n);if("Call"!=t.TYPE)return t}}return e}),AST_Binary.DEFMETHOD("lift_sequences",function(e){if(this.left instanceof AST_PropAccess)return this.left.expression instanceof AST_Sequence?(n=this.left.expression.expressions.slice(),(t=this.clone()).left=t.left.clone(),t.left.expression=n.pop(),n.push(t),we(this,n)):this;if(this.left instanceof AST_Sequence)return n=this.left.expressions.slice(),(t=this.clone()).left=n.pop(),n.push(t),we(this,n);if(this.right instanceof AST_Sequence){if(this.left.has_side_effects(e))return this;for(var n,t,i="="==this.operator&&this.left instanceof AST_SymbolRef,r=(n=this.right.expressions).length-1,o=0;o<r&&(i||!n[o].has_side_effects(e));o++);if(o==r)return n=n.slice(),(t=this.clone()).right=n.pop(),n.push(t),we(this,n);if(0<o)return(t=this.clone()).right=we(this.right,n.slice(o)),(n=n.slice(0,o)).push(t),we(this,n)}return this}),makePredicate("indexOf lastIndexOf")),Yn=makePredicate("== === != !== * & | ^");function Kn(e,n){return e instanceof AST_Assign?!n&&"="==e.operator&&Kn(e.right):e instanceof AST_New?!n:e instanceof AST_Sequence?Kn(e.tail_node(),n):e instanceof AST_SymbolRef?!n&&Kn(e.fixed_value()):e instanceof AST_Array||e instanceof AST_Class||e instanceof AST_Lambda||e instanceof AST_Object}function Gn(e,n){var t=e.right;switch(e.operator){case"in":return Kn(t)||n&&n.option("unsafe_comps");case"instanceof":return(t=t instanceof AST_SymbolRef?t.fixed_value():t)instanceof AST_Defun||t instanceof AST_Function||is_generator(t)?!0:!(!w(t)||!e.left.is_constant())||n&&n.option("unsafe_comps");default:return!0}}function h(e,n){var t,i;return!!n.is_constant()||(n instanceof AST_Assign?"="!=n.operator||h(e,n.right):n instanceof AST_Binary?!Ne[n.operator]||h(e,n.left)&&h(e,n.right):n instanceof AST_Call?!!is_async(n.expression)&&(t=!1,walk_body(n.expression,new TreeWalker(function(e){return!!t||(e instanceof AST_Await?t=!0:e!==n&&e instanceof AST_Scope||void 0)})),!t):n instanceof AST_Conditional?h(e,n.consequent)&&h(e,n.alternative):n instanceof AST_Sequence?h(e,n.tail_node()):n instanceof AST_SymbolRef?(i=n.fixed_value())&&h(e,i):n instanceof AST_Template?!n.tag||et(e,n.tag):n instanceof AST_Unary||void 0)}function $n(e,n){return e instanceof AST_Assign?Pe(e.left,n)?e:e.left:e instanceof AST_Sequence?$n(e.tail_node(),n):!(e instanceof AST_UnaryPrefix&&UNARY_POSTFIX[e.operator])||Pe(e.expression,n)?e:e.expression}function Xn(e,n){return n instanceof AST_Dot?Xn(e,n.expression):n instanceof AST_Sub?Xn(e,n.expression)&&Xn(e,n.property):n instanceof AST_Symbol||!n.has_side_effects(e)}function Jn(e,n){var t,i=e.right.tail_node();if(i!==e.right&&((t=e.right.expressions.slice(0,-1)).push(i.left),(i=i.clone()).left=we(e.right,t),e.right=i),e.left=ke(AST_Binary,e,{operator:e.operator,left:e.left,right:i.left,start:e.left.start,end:i.left.end}),e.right=i.right,n)return(t=e.left.transform(n))!==e.left&&((e=e.clone()).left=t),e;e.operator==i.left.operator&&Jn(e.left)}function Qn(e,n,t){var i=0,r=e.self();do{if(r===t)return r;if(w(r)&&r.name&&r.name.definition()===n)return r}while(r=e.parent(i++))}function Zn(e){var n=e.scope.resolve();return all(e.references,function(e){return n===e.scope.resolve()})}function et(e,n){return e.option("unsafe")&&n instanceof AST_Dot&&"raw"==n.property&&Ee(n.expression)&&"String"==n.expression.name}function nt(e){var t=!1;if(e=e.replace(/\\(u\{[^{}]*\}?|u[\s\S]{0,4}|x[\s\S]{0,2}|[0-9]+|[\s\S])/g,function(e,n){n=decode_escape_sequence(n);if("string"==typeof n)return n;t=!0}),!t)return e}function tt(e,n){return e instanceof AST_SymbolRef||e.TYPE===n.TYPE}function it(t,n){var i=!1,r=new TreeWalker(function(e){return!!i||(e instanceof AST_SymbolRef&&member(e.definition(),n)?i=!0:void 0)}),o=new TreeWalker(function(e){if(i)return!0;if(e instanceof AST_Lambda&&e!==t){if(!(e.name||is_async(e)||is_generator(e))){var n=o.parent();if(n instanceof AST_Call&&n.expression===e)return}return e.walk(r),!0}});return t.walk(o),i}e(AST_Binary,function(t,r){if(!Yn[t.operator]||!t.right.is_constant()||t.left.is_constant()||t.left instanceof AST_Binary&&PRECEDENCE[t.left.operator]>=PRECEDENCE[t.operator]||k(),r.option("sequences")){var e=t.lift_sequences(r);if(e!==t)return e.optimize(r)}if(r.option("assignments")&&Ne[t.operator]){var n,i=$n(t.left,r),e=t.right;if(i instanceof AST_SymbolRef&&e instanceof AST_Assign&&"="==e.operator&&i.equals(e.left))return i=i.clone(),n=ke(AST_Assign,t,{operator:"=",left:i,right:ke(AST_Binary,t,{operator:t.operator,left:t.left,right:e.right})}),i.fixed&&(i.fixed=function(){return n.right},i.fixed.assigns=[n]),(e=i.definition()).references.push(i),e.replaced++,n.optimize(r)}if(r.option("comparisons"))switch(t.operator){case"===":case"!==":if(Ce(t.left,r)&&t.right.is_defined(r))return AST_Node.warn("Expression always defined [{start}]",t),we(t,[t.right,ke("==="==t.operator?AST_False:AST_True,t)]).optimize(r);var o=!0;(t.left.is_string(r)&&t.right.is_string(r)||t.left.is_number(r)&&t.right.is_number(r)||t.left.is_boolean(r)&&t.right.is_boolean(r)||Xn(r,t.left)&&t.left.equals(t.right))&&(t.operator=t.operator.slice(0,2));case"==":case"!=":if(!o&&Ce(t.left,r))t.left=ke(AST_Null,t.left);else if(r.option("typeofs")&&t.left instanceof AST_String&&"undefined"==t.left.value&&t.right instanceof AST_UnaryPrefix&&"typeof"==t.right.operator)((a=t.right.expression)instanceof AST_SymbolRef?!a.is_declared(r):a instanceof AST_PropAccess&&r.option("ie"))||(t.right=a,t.left=ke(AST_Undefined,t.left).optimize(r),2==t.operator.length&&(t.operator+="="));else if(t.left instanceof AST_SymbolRef&&t.right instanceof AST_SymbolRef&&t.left.definition()===t.right.definition()&&Kn(t.left))return ke("="==t.operator[0]?AST_True:AST_False,t).optimize(r);break;case"&&":case"||":var a,o=t.left;if(o instanceof AST_Binary&&(o.operator==("&&"==t.operator?"!==":"===")&&t.right instanceof AST_Binary&&o.operator==t.right.operator&&(Ce(o.left,r)&&t.right.left instanceof AST_Null||o.left instanceof AST_Null&&Ce(t.right.left,r)))){if((a=(a=o.right)instanceof AST_Assign&&"="==a.operator?a.left:a).has_side_effects(r))break;if(a.equals(t.right.right))return o.operator=o.operator.slice(0,-1),o.left=ke(AST_Null,t),o}}var s,f,c=!1,l=r.parent();if(r.option("booleans")){i=$n(t.left,r);if(Ne[t.operator]&&!i.has_side_effects(r)){if(i.equals(t.right))return De(l,r.self(),t.left).optimize(r);Nn(r,i)}c=r.in_boolean_context()}if(c)switch(t.operator){case"+":var u=t.left.evaluate(r,!0);if(u&&"string"==typeof u||(u=t.right.evaluate(r,!0))&&"string"==typeof u){AST_Node.warn("+ in boolean context always true [{start}]",t);var _=[];switch(t.left.evaluate(r)instanceof AST_Node&&_.push(t.left),t.right.evaluate(r)instanceof AST_Node&&_.push(t.right),_.length){case 0:return ke(AST_True,t).optimize(r);case 1:return _[0]=_[0].clone(),_.push(ke(AST_True,t)),we(t,_).optimize(r)}t.truthy=!0}break;case"==":if(t.left instanceof AST_String&&""==t.left.value&&t.right.is_string(r))return ke(AST_UnaryPrefix,t,{operator:"!",expression:t.right}).optimize(r);break;case"!=":if(t.left instanceof AST_String&&""==t.left.value&&t.right.is_string(r))return t.right.optimize(r)}if(r.option("comparisons")&&t.is_boolean(r)){if("Binary"!=l.TYPE){e=ke(AST_UnaryPrefix,t,{operator:"!",expression:t.negate(r)});if(Me(r,t,e)===e)return e}switch(t.operator){case">":k("<");break;case">=":k("<=")}}if(r.option("conditionals")&&Ne[t.operator]&&(t.left instanceof AST_Binary&&t.operator==t.left.operator&&(s=(e=ke(AST_Binary,t,{operator:t.operator,left:t.left.right,right:t.right})).transform(r),e!==s)&&(t.left=t.left.left,t.right=s),(S=t.right.tail_node())instanceof AST_Binary)&&t.operator==S.operator&&(t=Jn(t,r)),r.option("strings")&&"+"==t.operator){if(t.right instanceof AST_String&&""==t.right.value&&t.left.is_string(r))return t.left.optimize(r);if(t.left instanceof AST_String&&""==t.left.value&&t.right.is_string(r))return t.right.optimize(r);if(t.left instanceof AST_Binary&&"+"==t.left.operator&&t.left.left instanceof AST_String&&""==t.left.left.value&&t.right.is_string(r)&&(t.left.right.is_constant()||!t.right.has_side_effects(r)))return t.left=t.left.right,t.optimize(r);(S=t.right.tail_node())instanceof AST_Binary&&t.operator==S.operator&&(t.left.is_string(r)&&S.is_string(r)||S.left.is_string(r)&&(t.left.is_constant()||!S.right.has_side_effects(r)))&&(t=Jn(t,r))}if(r.option("evaluate")){var S,p=!0;switch(t.operator){case"&&":if(!(T=N(r,t.left)))return AST_Node.warn("Condition left of && always false [{start}]",t),De(l,r.self(),t.left).optimize(r);if(!(T instanceof AST_Node))return AST_Node.warn("Condition left of && always true [{start}]",t),we(t,[t.left,t.right]).optimize(r);if(t.right.evaluate(r,!0)){if((c||"&&"==l.operator&&l.left===r.self())&&!(t.right.evaluate(r)instanceof AST_Node))return AST_Node.warn("Dropping side-effect-free && [{start}]",t),t.left.optimize(r)}else{if(c&&!(t.right.evaluate(r)instanceof AST_Node))return AST_Node.warn("Boolean && always false [{start}]",t),we(t,[t.left,ke(AST_False,t)]).optimize(r);t.falsy=!0}if("||"==t.left.operator)if(!(A=N(r,t.left.right)))return ke(AST_Conditional,t,{condition:t.left.left,consequent:t.right,alternative:t.left.right}).optimize(r);break;case"??":var d=!0;case"||":var A,T=N(r,t.left,d);if(d?null==T:!T)return AST_Node.warn("Condition left of {operator} always {value} [{start}]",{operator:t.operator,value:d?"nullish":"false",start:t.start}),we(t,[t.left,t.right]).optimize(r);if(!(T instanceof AST_Node))return AST_Node.warn("Condition left of {operator} always {value} [{start}]",{operator:t.operator,value:d?"defined":"true",start:t.start}),De(l,r.self(),t.left).optimize(r);if(d||!(T=t.right.evaluate(r,!0))||T instanceof AST_Node){if((c||"||"==l.operator&&l.left===r.self())&&!t.right.evaluate(r))return AST_Node.warn("Dropping side-effect-free {operator} [{start}]",t),t.left.optimize(r)}else{if(c&&!(t.right.evaluate(r)instanceof AST_Node))return AST_Node.warn("Boolean || always true [{start}]",t),we(t,[t.left,ke(AST_True,t)]).optimize(r);t.truthy=!0}if(!d&&"&&"==t.left.operator)if((A=N(r,t.left.right))&&!(A instanceof AST_Node))return ke(AST_Conditional,t,{condition:t.left.left,consequent:t.left.right,alternative:t.right}).optimize(r);break;case"+":if((t=(t=t.left instanceof AST_Constant&&t.right instanceof AST_Binary&&"+"==t.right.operator&&t.right.left instanceof AST_Constant&&t.right.is_string(r)?ke(AST_Binary,t,{operator:"+",left:ke(AST_String,t.left,{value:""+t.left.value+t.right.left.value,start:t.left.start,end:t.right.left.end}),right:t.right.right}):t).right instanceof AST_Constant&&t.left instanceof AST_Binary&&"+"==t.left.operator&&t.left.right instanceof AST_Constant&&t.left.is_string(r)?ke(AST_Binary,t,{operator:"+",left:t.left.left,right:ke(AST_String,t.right,{value:""+t.left.right.value+t.right.value,start:t.left.right.start,end:t.right.end})}):t).right instanceof AST_UnaryPrefix&&"-"==t.right.operator&&t.left.is_number(r)){t=ke(AST_Binary,t,{operator:"-",left:t.left,right:t.right.expression});break}if(t.left instanceof AST_UnaryPrefix&&"-"==t.left.operator&&x()&&t.right.is_number(r)){t=ke(AST_Binary,t,{operator:"-",left:t.right,right:t.left.expression});break}if(r.option("unsafe_math")&&t.left instanceof AST_Binary&&PRECEDENCE[t.left.operator]==PRECEDENCE[t.operator]&&t.right.is_constant()&&(t.right.is_boolean(r)||t.right.is_number(r))&&t.left.is_number(r)&&!t.left.right.is_constant()&&(t.left.left.is_boolean(r)||t.left.left.is_number(r))){t=ke(AST_Binary,t,{operator:t.left.operator,left:ke(AST_Binary,t,{operator:t.operator,left:t.right,right:t.left.left}),right:t.left.right});break}case"-":if(t.right instanceof AST_UnaryPrefix&&"-"==t.right.operator&&t.left.is_number(r)&&t.right.expression.is_number(r)){t=ke(AST_Binary,t,{operator:"+",left:t.left,right:t.right.expression});break}case"*":case"/":p=r.option("unsafe_math"),"+"!=t.operator&&["left","right"].forEach(function(e){var n=t[e];n instanceof AST_UnaryPrefix&&"+"==n.operator&&((n=n.expression).is_boolean(r)||n.is_number(r)||n.is_string(r))&&(t[e]=n)});case"&":case"|":case"^":"-"==t.operator||"/"==t.operator||!t.left.is_boolean(r)&&!t.left.is_number(r)||!t.right.is_boolean(r)&&!t.right.is_number(r)||!x()||t.left instanceof AST_Binary&&t.left.operator!=t.operator&&PRECEDENCE[t.left.operator]>=PRECEDENCE[t.operator]||(t=Me(r,t,ke(AST_Binary,t,{operator:t.operator,left:t.right,right:t.left}),t.right instanceof AST_Constant&&!(t.left instanceof AST_Constant))),p&&t.is_number(r)&&(!(t.right instanceof AST_Binary&&"%"!=t.right.operator&&PRECEDENCE[t.right.operator]==PRECEDENCE[t.operator]&&t.right.is_number(r)&&("+"!=t.operator||t.right.left.is_boolean(r)||t.right.left.is_number(r)))||"-"==t.operator&&t.left.is_negative_zero()||!t.right.left.is_constant_expression()&&t.right.right.has_side_effects(r)||(T=t.right.right,f=!1,T.walk(new TreeWalker(function(e){if(f)return!0;if(e instanceof AST_Assign){if(e.left instanceof AST_PropAccess)return f=!0}else if(e instanceof AST_Unary&&unary_side_effects[e.operator]&&e.expression instanceof AST_PropAccess)return f=!0})),f)||("+"!=(t=ke(AST_Binary,t,{operator:y(t.operator,t.right.operator),left:ke(AST_Binary,t.left,{operator:t.operator,left:t.left,right:t.right.left,start:t.left.start,end:t.right.left.end}),right:t.right.right})).operator||t.right.is_boolean(r)||t.right.is_number(r)||(t.right=ke(AST_UnaryPrefix,t.right,{operator:"+",expression:t.right}))),t.right instanceof AST_Constant)&&t.left instanceof AST_Binary&&"%"!=t.left.operator&&PRECEDENCE[t.left.operator]==PRECEDENCE[t.operator]&&t.left.is_number(r)&&(t.left.left instanceof AST_Constant?(i=g(t.operator,t.left.left,t.right,{start:t.left.left.start,end:t.right.end}),t=g(t.left.operator,K(r,i),t.left.right,t)):t.left.right instanceof AST_Constant&&(d=y(t.left.operator,t.operator),!(S=K(r,g(d,t.left.right,t.right,t.left))).is_constant()||"-"==t.left.operator&&0!=t.right.value&&0==+S.value&&t.left.left.is_negative_zero()||(t=g(t.left.operator,t.left.left,S,t))));break;case"instanceof":if(Gn(t,r)&&w(t.right))return we(t,[t.left,t.right,ke(AST_False,t)]).optimize(r)}if(!(l instanceof AST_UnaryPrefix&&"delete"==l.operator)){if(t.left instanceof AST_Number&&!t.right.is_constant())switch(t.operator){case"+":if(0==t.left.value){if(t.right.is_boolean(r))return ke(AST_UnaryPrefix,t,{operator:"+",expression:t.right}).optimize(r);if(t.right.is_number(r)&&!t.right.is_negative_zero())return t.right}break;case"*":if(1==t.left.value)return ke(AST_UnaryPrefix,t,{operator:"+",expression:t.right}).optimize(r)}if(t.right instanceof AST_Number&&!t.left.is_constant())switch(t.operator){case"+":if(0==t.right.value){if(t.left.is_boolean(r))return ke(AST_UnaryPrefix,t,{operator:"+",expression:t.left}).optimize(r);if(t.left.is_number(r)&&!t.left.is_negative_zero())return t.left}break;case"-":if(0==t.right.value)return ke(AST_UnaryPrefix,t,{operator:"+",expression:t.left}).optimize(r);break;case"/":if(1==t.right.value)return ke(AST_UnaryPrefix,t,{operator:"+",expression:t.left}).optimize(r)}}}if(r.option("typeofs"))switch(t.operator){case"&&":z(t.left,t.right,null);break;case"||":z(t.left,null,t.right)}if(r.option("unsafe")){var h=b(t.right);if(c&&h&&("=="==t.operator||"!="==t.operator)&&t.left instanceof AST_Number&&0==t.left.value)return("=="==t.operator?ke(AST_UnaryPrefix,t,{operator:"!",expression:t.right}):t.right).optimize(r);var m=b(t.left);if(r.option("comparisons")&&function(){switch(t.operator){case"<=":return h&&t.left instanceof AST_Number&&0==t.left.value;case"<":if(m&&t.right instanceof AST_Number&&0==t.right.value)return 1;case"==":case"!=":return h?t.left instanceof AST_Number&&-1==t.left.value||t.left instanceof AST_UnaryPrefix&&"-"==t.left.operator&&t.left.expression instanceof AST_Number&&1==t.left.expression.value:void 0}}()){var v=ke(AST_UnaryPrefix,t,{operator:"!",expression:ke(AST_UnaryPrefix,t,{operator:"~",expression:m?t.left:t.right})});switch(t.operator){case"<":if(m)break;case"<=":case"!=":v=ke(AST_UnaryPrefix,t,{operator:"!",expression:v})}return v.optimize(r)}}return K(r,t);function y(e,n){switch(e){case"-":return"+"==n?"-":"+";case"/":return"*"==n?"/":"*";default:return n}}function g(e,n,t,i){return"+"==e&&(n.is_boolean(r)||n.is_number(r)||(n=ke(AST_UnaryPrefix,n,{operator:"+",expression:n})),t.is_boolean(r)||t.is_number(r)||(t=ke(AST_UnaryPrefix,t,{operator:"+",expression:t}))),ke(AST_Binary,i,{operator:e,left:n,right:t})}function b(e){return"Call"==e.TYPE&&e.expression instanceof AST_Dot&&Wn[e.expression.property]}function x(){return t.left.is_constant()||t.right.is_constant()||!t.left.has_side_effects(r)&&!t.right.has_side_effects(r)}function k(e){x()&&(e&&(t.operator=e),e=t.left,t.left=t.right,t.right=e)}}),e(AST_SymbolExport,function(e){return e}),e(AST_SymbolRef,function(t,e){if(!e.option("ie")&&Ee(t)&&(!t.scope.resolve().uses_with||!e.find_parent(AST_With)))switch(t.name){case"undefined":return ke(AST_Undefined,t).optimize(e);case"NaN":return ke(AST_NaN,t).optimize(e);case"Infinity":return ke(AST_Infinity,t).optimize(e)}var n=e.parent();if(e.option("reduce_vars")&&is_lhs(e.self(),n)!==e.self()){var i,r,o,a,s,f,c,l,u,_=t.definition(),S=t.fixed_value(),n=_.single_use&&!(n instanceof AST_Call&&n.is_expr_pure(e));if(n)if(w(S)){if(_.scope===t.scope.resolve(!0)&&!_.in_loop||e.option("reduce_funcs")&&1!=_.escaped.depth&&!S.inlined)if(_.redefined())n=!1;else if(Qn(e,_,S))n=!1;else if(S.name&&S.name.definition()!==_)n=!1;else if(S.parent_scope!==t.scope||is_funarg(_))if(Vn(S,e)){if("f"==(n=S.is_constant_expression(t.scope)))for(var p=t.scope;(p instanceof AST_LambdaDefinition||p instanceof AST_LambdaExpression)&&(p.inlined=!0),p=p.parent_scope;);}else n=!1;else(S.name&&("await"==S.name.name&&is_async(S)||"yield"==S.name.name&&is_generator(S))||S.has_side_effects(e)||S instanceof AST_Class&&(e.option("ie")||!S.is_constant_expression(t.scope)))&&(n=!1);else n=!1;n&&(S.parent_scope=t.scope)}else(!S||0<_.recursive_refs||!S.is_constant_expression()||S.drop_side_effect_free(e))&&(n=!1);if(n){if(_.single_use=!1,S._squeezed=!0,S.single_use=!0,w(S=(S=S instanceof AST_DefClass?mn(S):S)instanceof AST_LambdaDefinition?vn(S):S)){var d=[],p=t.scope;do{if(d.push(p),p===_.scope)break}while(p=p.parent_scope);S.enclosed.forEach(function(e){if(!S.variables.has(e.name))for(var n=0;n<d.length;n++){var t=d[n];if(!push_uniq(t.enclosed,e))return;t.var_names().set(e.name,!0)}})}return 0<_.recursive_refs?(i=(u=S.clone(!0)).name.definition(),r=u.variables.get(u.name.name),o=r&&r.orig[0],n=u instanceof AST_Class?(a="def_function",AST_SymbolClass):(a="def_variable",AST_SymbolLambda),o instanceof n||(((o=ke(n,u.name)).scope=u).name=o,(r=u[a](o)).recursive_refs=_.recursive_refs),u.walk(new TreeWalker(function(e){var n,t;e instanceof AST_SymbolDeclaration?e!==o&&((n=e.definition()).orig.push(e),n.eliminated++):e instanceof AST_SymbolRef&&((n=e.definition())===i?e.thedef=n=r:(n.single_use=!1,w(t=e.fixed_value())&&t.name&&t.name.definition()===n&&n.scope===t.name.scope&&S.variables.get(t.name.name)===n&&(t.name=t.name.clone(),e.thedef=n=u.variables.get(t.name.name)||u[a](t.name))),n.references.push(e))}))):(S instanceof AST_Scope?(e.push(S),u=S.optimize(e),e.pop()):u=S.optimize(e),u=u.transform(new TreeTransformer(function(e,n){return e instanceof AST_Scope||n(e=e.clone(),this),e}))),_.replaced++,u}if(S&&!1!==(s=t.fixed||_.fixed).should_replace)if(S instanceof AST_This?is_funarg(_)||!Zn(_)||function(e){var n=t.scope;for(;n!==e.scope;){if(n instanceof AST_Class)return 1;n=n.parent_scope}}(_)||(f=S):(n=S.evaluate(e,!0))!==S&&"function"!=typeof n&&(null===n||"object"!=typeof n||e.option("unsafe_regexp")&&n instanceof RegExp&&!_.cross_loop&&Zn(_))&&(f=Z(n,S)),f)if(void 0===s.should_replace&&(n=f.optimize(e).print_to_string().length,A(S)||(n=Math.min(n,S.print_to_string().length)),c=_.name.length,e.option("unused")&&!e.exposed(_)&&(l=_.references.length-_.replaced-_.assignments,l=Math.min(l,_.references.filter(function(e){return e.fixed===s}).length),c+=(c+2+n)/Math.max(1,l)),s.should_replace=n-Math.floor(c)<e.eval_threshold),s.should_replace)return A(S)?(u=f.optimize(e))===f&&(u=u.clone(!0)):(u=Y(f.optimize(e),S))!==f&&u!==S||(u=u.clone(!0)),_.replaced++,u}return t;function A(e){var n;return e.walk(new TreeWalker(function(e){if(n=e instanceof AST_SymbolRef?!0:n)return!0})),n}}),e(AST_Template,function(e,t){if(!t.option("templates"))return e;var i=e.tag;if(!i||et(t,i)){for(var n,r=[],o=[],a=0;a<e.strings.length;a++){var s,f=e.strings[a];if(i||(s=nt(f))&&(f=S(s)),0<a){var c=e.expressions[a-1],l=function(e){var n=e.evaluate(t);if(n!==e&&!(i&&/\r|\\|`/.test(n)||(n=S(""+n)).length>e.print_to_string().length+"${}".length))return n}(c);if(l){var u,l=o[o.length-1]+l+f;if(i||typeof(u=nt(l))==n){o[o.length-1]=u?S(u):l;continue}}r.push(c)}o.push(f),i||(n=typeof s)}if(!i&&1<o.length){if(""==o[o.length-1])return ke(AST_Binary,e,{operator:"+",left:ke(AST_Template,e,{expressions:r.slice(0,-1),strings:o.slice(0,-1)}).transform(t),right:r[r.length-1]}).optimize(t);if(""==o[0]){for(var _=ke(AST_Binary,e,{operator:"+",left:ke(AST_String,e,{value:""}),right:r[0]}),a=1;""==o[a]&&a<r.length;a++)_=ke(AST_Binary,e,{operator:"+",left:_,right:r[a]});return Me(t,e,ke(AST_Binary,e,{operator:"+",left:_.transform(t),right:ke(AST_Template,e,{expressions:r.slice(a),strings:o.slice(a)}).transform(t)}).optimize(t))}}e.expressions=r,e.strings=o}return K(t,e);function S(e){return e.replace(/\r|\\|`|\${/g,function(e){return"\\"+("\r"==e?"r":e)})}}),e(AST_Undefined,function(e,n){if(n.option("unsafe_undefined")){var t=xe(n).find_variable("undefined");if(t)return(t=ke(AST_SymbolRef,e,{name:"undefined",scope:t.scope,thedef:t})).is_undefined=!0,t}t=is_lhs(n.self(),n.parent());return t&&tt(t,e)?e:ke(AST_UnaryPrefix,e,{operator:"void",expression:ke(AST_Number,e,{value:0})})}),e(AST_Infinity,function(e,n){var t=is_lhs(n.self(),n.parent());return(!t||!tt(t,e))&&(!n.option("keep_infinity")||t||xe(n).find_variable("Infinity"))?ke(AST_Binary,e,{operator:"/",left:ke(AST_Number,e,{value:1}),right:ke(AST_Number,e,{value:0})}):e}),e(AST_NaN,function(e,n){var t=is_lhs(n.self(),n.parent());return(!t||!tt(t,e))&&(t||xe(n).find_variable("NaN"))?ke(AST_Binary,e,{operator:"/",left:ke(AST_Number,e,{value:0}),right:ke(AST_Number,e,{value:0})}):e});var rt=makePredicate("+ - * / % >> << >>> | ^ &"),ot=makePredicate("* | ^ &");function at(e,n){var t;if(e)return"Call"!=(t=n.parent()).TYPE?1:t.expression!==n.self()||(!(e instanceof AST_SymbolRef)||(e=e.fixed_value()))&&e instanceof AST_Lambda&&!e.contains_this()}function st(e){return e instanceof AST_ObjectKeyVal&&"string"==typeof e.key&&!(e instanceof AST_ObjectMethod&&e.value.contains_super())}function ft(e){var n=e.definition().redefined();return n&&((e=e.clone()).thedef=n),e}function ct(n,e){var t=!1;return e.walk(new TreeWalker(function(e){return!!t||(e instanceof AST_SymbolRef&&n.variables.get(e.name)===e.definition()?t=!0:void 0)})),t}function lt(e,n){var t=[];e.references.forEach(function(e){e=e.fixed;e&&push_uniq(t,e)&&(e.assigns?e.assigns.unshift(n):e.assigns=[n])})}function ut(e,n){var t=ke(AST_SymbolRef,n),i=ke(AST_Assign,n,{operator:"=",left:t,right:ke(AST_Undefined,n).transform(e)}),e=n.definition();return e.fixed&&(t.fixed=function(){return i.right},t.fixed.assigns=[i],lt(e,i)),e.assignments++,e.references.push(t),i}function _t(e,n,t,i,r,o,a){for(var s=[],f=o.expressions,c=t,l=f.length-(a||0),u=l;0<=--l;r=!(c=!0)){var _=f[l].try_inline(e,n,c,i,r);_&&(S(),s.push(_))}if(0!=s.length)return S(),!t&&s[0]instanceof AST_SimpleStatement&&(s[0]=ke(AST_Return,o,{value:s[0].body})),ke(AST_BlockStatement,o,{body:s.reverse()});function S(){l+1<u&&s.push(ke(AST_SimpleStatement,o,{body:we(o,f.slice(l+1,u))})),u=l}}e(AST_Assign,function(o,a){if(a.option("dead_code"))if(o.left instanceof AST_PropAccess){if("="==o.operator){var e=o.left.expression;if(o.left.equals(o.right)){var n=e.defined,t=(e.defined=!1,!o.left.has_side_effects(a));if(e.defined=n,t)return o.right}if(e instanceof AST_Lambda||!a.has_directive("use strict")&&e instanceof AST_Constant&&!e.may_throw_on_access(a))return n=o.left instanceof AST_Dot?o.right:we(o,[o.left.property,o.right]),De(a.parent(),o,n).optimize(a)}}else if(o.left instanceof AST_SymbolRef&&be(o.left,a)){if("="==o.operator&&o.left.equals(o.right)&&!((l=a.parent())instanceof AST_UnaryPrefix&&"delete"==l.operator))return o.right;if(o.left.is_immutable())return d();var i,r=o.left.definition(),s=r.scope.resolve(),f=s===a.find_parent(AST_Lambda),c=0,l=a.self();if(!s.uses_arguments||!is_funarg(r)||a.has_directive("use strict"))do{if(i=l,(l=a.parent(c++))instanceof AST_Assign){if(l.left instanceof AST_SymbolRef&&l.left.definition()===r){if(S(c,l,!f))break;return d(r)}if(l.left.match_symbol(function(e){if(e instanceof AST_PropAccess)return!0}))break}else{if(l instanceof AST_Exit){if(!f)break;if(S(c,l))break;if(it(s,[r]))break;return d(r)}if(l instanceof AST_SimpleStatement){if(!f)break;if(it(s,[r]))break;do{if(u=l,(l=a.parent(c++))===s&&ze(l.body,u))return d(r)}while(u=u,(_=l)instanceof AST_BlockStatement||_ instanceof AST_Catch||_ instanceof AST_Finally?ze(_.body,u):_ instanceof AST_If?_.body===u||_.alternative===u:_ instanceof AST_Try?_.bfinally?_.bfinally===u:_.bcatch===u:void 0);break}if(l instanceof AST_VarDef&&l.name instanceof AST_SymbolDeclaration&&l.name.definition()===r){if(S(c,l))break;return d(r)}}}while(function(e,n){if(n instanceof AST_Binary)switch(e){case n.left:return n.right.is_constant_expression(s);case n.right:return 1;default:return}if(n instanceof AST_Conditional)switch(e){case n.condition:return n.consequent.is_constant_expression(s)&&n.alternative.is_constant_expression(s);case n.consequent:case n.alternative:return 1;default:return}if(n instanceof AST_Sequence){var t=n.expressions,i=t.indexOf(e);if(i<0)return;for(var r=t.length;--r>i;)if(!t[r].is_constant_expression(s))return;return 1}return n instanceof AST_UnaryPrefix}(i,l))}var u,_;if(a.option("sequences")){t=o.lift_sequences(a);if(t!==o)return t.optimize(a)}if(a.option("assignments")){if("="==o.operator&&o.left instanceof AST_SymbolRef&&o.right instanceof AST_Binary){if(o.right.left instanceof AST_SymbolRef&&o.right.left.name==o.left.name&&rt[o.right.operator])return p(o.right.right);if(o.right.right instanceof AST_SymbolRef&&o.right.right.name==o.left.name&&ot[o.right.operator]&&!o.right.left.has_side_effects(a))return p(o.right.left)}if(("-="==o.operator||"+="==o.operator&&(o.left.is_boolean(a)||o.left.is_number(a)))&&o.right instanceof AST_Number&&1==o.right.value)return e=o.operator.slice(0,-1),ke(AST_UnaryPrefix,o,{operator:e+e,expression:o.left})}return K(a,o);function S(e,n,t){var i=o.right,r=(o.right=ke(AST_Null,i),n.may_throw(a));return o.right=i,Be(a,e,n,s,r,t)}function p(e){var n=o.left.fixed;return n&&(n.to_binary=v(function(e){return e.left},n)),ke(AST_Assign,o,{operator:o.right.operator+"=",left:o.left,right:e})}function d(e){return e&&(e.fixed=!1),("="!=o.operator?ke(AST_Binary,o,{operator:o.operator.slice(0,-1),left:o.left,right:o.right}):De(a.parent(),o,o.right)).optimize(a)}}),e(AST_Conditional,function(a,n){if(n.option("sequences")&&a.condition instanceof AST_Sequence)return e=a.condition.expressions.slice(),(c=a.clone()).condition=e.pop(),e.push(c),we(a,e).optimize(n);if(n.option("conditionals")){var s=a.condition;if(n.option("booleans")&&!s.has_side_effects(n)&&Nn(n,s),!(s=N(n,s)))return AST_Node.warn("Condition always false [{start}]",a),we(a,[a.condition,a.alternative]).optimize(n);if(!(s instanceof AST_Node))return AST_Node.warn("Condition always true [{start}]",a),we(a,[a.condition,a.consequent]).optimize(n);var e=first_in_statement(n),t=s.negate(n,e),e=((e?Ie:Y)(s,t)===t&&(a=ke(AST_Conditional,a,{condition:t,consequent:a.alternative,alternative:a.consequent}),t=s,s=a.condition),a.consequent),i=a.alternative,r=$n(s,n);if(Xn(n,r)){if(r.equals(e))return ke(AST_Binary,a,{operator:"||",left:s,right:i}).optimize(n);if(r.equals(i))return ke(AST_Binary,a,{operator:"&&",left:s,right:e}).optimize(n)}r=e.tail_node();if(r instanceof AST_Assign){var o="="==r.operator,f=o?i.tail_node():i;if((o||e===r)&&f instanceof AST_Assign&&r.operator==f.operator&&r.left.equals(f.left)&&(o&&r.left instanceof AST_SymbolRef||!s.has_side_effects(n)&&h(e)&&h(i)))return ke(AST_Assign,a,{operator:r.operator,left:r.left,right:ke(AST_Conditional,a,{condition:s,consequent:m(e),alternative:m(i)})})}f=i.tail_node();if(r.equals(f))return we(a,e.equals(i)?[s,e]:[ke(AST_Conditional,a,{condition:s,consequent:v(e),alternative:v(i)}),f]).optimize(n);var c,l,o=function e(n,t,i){var r=n.tail_node();var o=t.tail_node();if(!T(r,o))return!i&&ke(AST_Conditional,a,{condition:s,consequent:n,alternative:t});i=r.clone();n=A(n,r,"expression");t=A(t,o,"expression");o=e(n,t);r.expression instanceof AST_Sequence&&(o=De(r,r.expression,o));i.expression=o;return i}(e,i,!0);if(o)return o;if(e instanceof AST_Call&&i.TYPE==e.TYPE&&0<=(o=d(e,i))&&e.expression.equals(i.expression)&&!s.has_side_effects(n)&&!e.expression.has_side_effects(n))return c=e.clone(),l=e.args[o],c.args[o]=l instanceof AST_Spread?ke(AST_Spread,a,{expression:ke(AST_Conditional,a,{condition:s,consequent:l.expression,alternative:i.args[o].expression})}):ke(AST_Conditional,a,{condition:s,consequent:l,alternative:i.args[o]}),c;if(r instanceof AST_Conditional&&r.alternative.equals(i))return ke(AST_Conditional,a,{condition:ke(AST_Binary,a,{left:s,operator:"&&",right:A(e,r,"condition")}),consequent:r.consequent,alternative:P(r.alternative,i)});if(r instanceof AST_Conditional&&r.consequent.equals(i))return ke(AST_Conditional,a,{condition:ke(AST_Binary,a,{left:t,operator:"||",right:A(e,r,"condition")}),consequent:P(r.consequent,i),alternative:r.alternative});if(f instanceof AST_Conditional&&e.equals(f.consequent))return ke(AST_Conditional,a,{condition:ke(AST_Binary,a,{left:s,operator:"||",right:A(i,f,"condition")}),consequent:P(e,f.consequent),alternative:f.alternative});if(f instanceof AST_Conditional&&e.equals(f.alternative))return ke(AST_Conditional,a,{condition:ke(AST_Binary,a,{left:t,operator:"&&",right:A(i,f,"condition")}),consequent:f.consequent,alternative:P(e,f.alternative)});if(r instanceof AST_Binary&&"&&"==r.operator&&r.right.equals(i))return ke(AST_Binary,a,{operator:"&&",left:ke(AST_Binary,a,{operator:"||",left:t,right:A(e,r,"left")}),right:P(r.right,i)}).optimize(n);if(r instanceof AST_Binary&&"||"==r.operator&&r.right.equals(i))return ke(AST_Binary,a,{operator:"||",left:ke(AST_Binary,a,{operator:"&&",left:s,right:A(e,r,"left")}),right:P(r.right,i)}).optimize(n);if(f instanceof AST_Binary&&"&&"==f.operator&&f.right.equals(e))return ke(AST_Binary,a,{operator:"&&",left:ke(AST_Binary,a,{operator:"||",left:s,right:A(i,f,"left")}),right:P(e,f.right)}).optimize(n);if(f instanceof AST_Binary&&"||"==f.operator&&f.right.equals(e))return ke(AST_Binary,a,{operator:"||",left:ke(AST_Binary,a,{operator:"&&",left:t,right:A(i,f,"left")}),right:P(e,f.right)}).optimize(n);var u=n.option("booleans")&&n.in_boolean_context();if(S(e))return p(i)?_(s):ke(AST_Binary,a,{operator:"||",left:_(s),right:i}).optimize(n);if(p(e))return S(i)?_(s.negate(n)):ke(AST_Binary,a,{operator:"&&",left:_(s.negate(n)),right:i}).optimize(n);if(S(i))return ke(AST_Binary,a,{operator:"||",left:_(s.negate(n)),right:e}).optimize(n);if(p(i))return ke(AST_Binary,a,{operator:"&&",left:_(s),right:e}).optimize(n);n.option("typeofs")&&z(s,e,i)}return a;function _(e){return e.is_boolean(n)?e:ke(AST_UnaryPrefix,e,{operator:"!",expression:e.negate(n)})}function S(e){return e instanceof AST_True||u&&e instanceof AST_Constant&&e.value||e instanceof AST_UnaryPrefix&&"!"==e.operator&&e.expression instanceof AST_Constant&&!e.expression.value}function p(e){return e instanceof AST_False||u&&(e instanceof AST_Constant&&!e.value||e instanceof AST_UnaryPrefix&&"void"==e.operator&&!e.expression.has_side_effects(n))||e instanceof AST_UnaryPrefix&&"!"==e.operator&&e.expression instanceof AST_Constant&&e.expression.value}function d(e,n){var t=e.args,i=n.args,r=t.length;if(r!=i.length)return-2;for(var o=0;o<r;o++)if(!t[o].equals(i[o])){if(t[o]instanceof AST_Spread!=i[o]instanceof AST_Spread)return-3;for(var a=o+1;a<r;a++)if(!t[a].equals(i[a]))return-2;return o}return-1}function A(e,n,t){var i;return e===n?n[t]:((i=e.expressions.slice(0,-1)).push(n[t]),we(e,i))}function T(e,n){var t,i;if(e.TYPE==n.TYPE&&e.optional==n.optional)return e instanceof AST_Call?-1!=d(e,n)?void 0:"Call"!=e.TYPE||!(e.expression instanceof AST_PropAccess||n.expression instanceof AST_PropAccess)||T(e.expression,n.expression):e instanceof AST_PropAccess?(i=n.property,((t=e.property)instanceof AST_Node?t.equals(i):t==i)&&!(e.expression instanceof AST_Super||n.expression instanceof AST_Super)):void 0}function h(e){return e===e.tail_node()||all(e.expressions.slice(0,-1),function(e){return!e.has_side_effects(n)})}function m(e){var n;return e instanceof AST_Sequence?((n=e.expressions.slice()).push(n.pop().right),we(e,n)):e.right}function v(e){return e instanceof AST_Sequence?we(e,e.expressions.slice(0,-1)):ke(AST_Number,e,{value:0})}}),e(AST_Boolean,function(e,n){return n.option("booleans")?n.in_boolean_context()?ke(AST_Number,e,{value:+e.value}):(n=n.parent())instanceof AST_Binary&&("=="==n.operator||"!="==n.operator)?(AST_Node.warn("Non-strict equality against boolean: {operator} {value} [{start}]",{operator:n.operator,value:e.value,start:n.start}),ke(AST_Number,e,{value:+e.value})):ke(AST_UnaryPrefix,e,{operator:"!",expression:ke(AST_Number,e,{value:1-e.value})}):e}),e(AST_Spread,function(e,n){var t=e.expression;return n.option("spreads")&&t instanceof AST_Array&&!(n.parent()instanceof AST_Object)?List.splice(t.elements.map(function(e){return e instanceof AST_Hole?ke(AST_Undefined,e).optimize(n):e})):e}),e(AST_Sub,function(e,t){var n=e.expression,i=e.property,r=zn(e,t);if(r)return r;if(t.option("properties")){var o=i.evaluate(t);if(o!==i){"string"==typeof o&&("undefined"==o?o=void 0:(d=parseFloat(o)).toString()==o&&(o=d)),i=e.property=Y(i,Z(o,i).transform(t));var a=""+o;if(is_identifier_string(a)&&a.length<=i.print_to_string().length+1)return ke(AST_Dot,e,{optional:e.optional,expression:n,property:a,quoted:!0}).optimize(t)}}var s,f,c,l,r=t.parent(),u=is_lhs(t.self(),r);if(t.option("arguments")&&n instanceof AST_SymbolRef&&ge(s=n.definition())&&!n.in_arg&&i instanceof AST_Number&&Math.floor(p=i.value)==p&&(f=s.scope)===function(){var e,n=0;for(;e=t.parent(n++);)if(e instanceof AST_Lambda){if(e instanceof AST_Accessor)return;if(!is_arrow(e))return c=t.parent(n),e}}()&&f.uses_arguments<(u?2:3)){r instanceof AST_UnaryPrefix&&"delete"==r.operator&&(s.deleted||(s.deleted=[]),s.deleted[p]=!0);var _=f.argnames[p];if(s.deleted&&s.deleted[p])_=null;else if(_)(!(_ instanceof AST_SymbolFunarg&&"await"!=_.name&&n.scope.find_variable(_.name)===(S=_.definition()))||(t.has_directive("use strict")||f.name||f.rest||!(c instanceof AST_Call&&p<c.args.length&&all(c.args.slice(0,p+1),function(e){return!(e instanceof AST_Spread)}))||!all(f.argnames,function(e){return e instanceof AST_SymbolFunarg}))&&(v()||S.assignments||1<S.orig.length))&&(_=null);else if((u||!v())&&p<f.argnames.length+5&&t.drop_fargs(f,c)&&!f.rest)for(;p>=f.argnames.length;)_=f.make_var(AST_SymbolFunarg,f,"argument_"+f.argnames.length),f.argnames.push(_);if(_&&find_if(function(e){return e.name===_.name},f.argnames)===_)return u&&s.reassigned--,(S=ke(AST_SymbolRef,_)).reference(),_.unused=void 0,S}if(u)return e;if(t.option("sequences")&&"Call"!=r.TYPE&&!(r instanceof AST_ForEnumeration&&r.init===e)){var S=G(e);if(S!==e)return S.optimize(t)}if(o!==i&&(u=e.flatten_object(a,t))&&(n=e.expression=u.expression,i=e.property=u.property),t.option("properties")&&t.option("side_effects")&&i instanceof AST_Number&&n instanceof AST_Array&&all(l=n.elements,function(e){return!(e instanceof AST_Spread)})){var p,r=l[p=i.value];if(at(r,t)){for(var d,A=r instanceof AST_Hole,T=!A,h=[],m=l.length;--m>p;)(d=l[m].drop_side_effect_free(t))&&(h.unshift(d),T)&&d.has_side_effects(t)&&(T=!1);for(T||h.unshift(r);0<=--m;)(d=l[m].drop_side_effect_free(t))?h.unshift(d):A?h.unshift(ke(AST_Hole,l[m])):p--;return T?(h.push(r),we(e,h).optimize(t)):ke(AST_Sub,e,{expression:ke(AST_Array,n,{elements:h}),property:ke(AST_Number,i,{value:p})})}}return K(t,e);function v(){return!t.option("reduce_vars")||s.reassigned}}),AST_LambdaExpression.DEFMETHOD("contains_super",function(){var n=!1,t=this;return t.walk(new TreeWalker(function(e){return!!n||(e instanceof AST_Super?n=!0:e!==t&&e instanceof AST_Scope&&!is_arrow(e)||void 0)})),n}),(n=function(e,n){e.DEFMETHOD("contains_this",n)})(AST_Arrow,return_false),n(AST_AsyncArrow,return_false),n(AST_Node,function(){var n=!1,t=this;return t.walk(new TreeWalker(function(e){return!!n||(e instanceof AST_This?n=!0:e!==t&&e instanceof AST_Scope&&!is_arrow(e)||void 0)})),n}),AST_PropAccess.DEFMETHOD("flatten_object",function(e,n){if(n.option("properties")&&"__proto__"!==e){var t=this.expression;if(t instanceof AST_Object)for(var i=t.properties,r=i.length;0<=--r;){var o=i[r];if(o.key===e){if(!all(i,st))return;if(!at(o.value,n))return;for(var a,s=[],f=0;f<i.length;f++){var c=i[f].value;if(i[f]instanceof AST_ObjectMethod){var l,u,_,S=!(c.uses_arguments||is_generator(c)||c.contains_this());if(S&&(l=l||n.find_parent(AST_Scope),u=jn(n,l),c.each_argname(function(e){u[e.name]&&(S=!1)})),S)_=is_async(c)?AST_AsyncArrow:AST_Arrow;else{if(!(r!=f||(a=n.parent())instanceof AST_Call&&a.expression===this))return;_=c.CTOR}c=ke(_,c)}s.push(c)}return ke(AST_Sub,this,{expression:ke(AST_Array,t,{elements:s}),property:ke(AST_Number,this,{value:r})})}}}}),e(AST_Dot,function(e,n){"arguments"!=e.property&&"caller"!=e.property||AST_Node.warn("Function.prototype.{property} not supported [{start}]",e);var t=n.parent();if(is_lhs(n.self(),t))return e;var i=zn(e,n);if(i)return i;if(n.option("sequences")&&"Call"!=t.TYPE&&!(t instanceof AST_ForEnumeration&&t.init===e)){i=G(e);if(i!==e)return i.optimize(n)}if(n.option("unsafe_proto")&&e.expression instanceof AST_Dot&&"prototype"==e.expression.property){var r=e.expression.expression;if(Ee(r))switch(r.name){case"Array":e.expression=ke(AST_Array,e.expression,{elements:[]});break;case"Function":e.expression=ke(AST_Function,e.expression,{argnames:[],body:[]}).init_vars(r.scope);break;case"Number":e.expression=ke(AST_Number,e.expression,{value:0});break;case"Object":e.expression=ke(AST_Object,e.expression,{properties:[]});break;case"RegExp":e.expression=ke(AST_RegExp,e.expression,{value:/t/});break;case"String":e.expression=ke(AST_String,e.expression,{value:""})}}t=e.flatten_object(e.property,n);return t?t.optimize(n):K(n,e)}),e(AST_DestructuredArray,function(e,n){return n.option("rests")&&e.rest instanceof AST_DestructuredArray?ke(AST_DestructuredArray,e,{elements:e.elements.concat(e.rest.elements),rest:e.rest.rest}):e}),e(AST_DestructuredKeyVal,function(e,n){var t;return n.option("objects")&&(t=e.key)instanceof AST_Node&&(t=t.evaluate(n))!==e.key&&(e.key=""+t),e}),e(AST_Object,function(t,i){var r,o,a,s,f,c,l,e;return i.option("objects")&&(a=o=r=!1,s=i.has_directive("use strict"),f=[],c=new Dictionary,l=[],t.properties.forEach(function(e){if(!(e instanceof AST_Spread))return _(e);o=!0;var n=e.expression;i.option("spreads")&&n instanceof AST_Object&&all(n.properties,function(e){return!(e instanceof AST_ObjectGetter||e instanceof AST_Spread||!("__proto__"!==e.key||e instanceof AST_ObjectSetter)&&e.value.has_side_effects(i))})?(r=!0,n.properties.forEach(function(e){var n=e.key,t=e instanceof AST_ObjectSetter;if("__proto__"===n){if(!t)return;n=Z(n,e)}_(t?ke(AST_ObjectKeyVal,e,{key:n,value:ke(AST_Undefined,e).optimize(i)}):e)})):(a=!0,u(),l.push(e))}),u(),r)?(o&&a&&1==l.length&&(e=l[0])instanceof AST_ObjectProperty&&e.key instanceof AST_Number&&(e.key=""+e.key.value),ke(AST_Object,t,{properties:l})):t;function u(){f.forEach(function(e){var n=c.get(e);switch(n.length){case 0:return;case 1:return l.push(n[0])}r=!0;e=s&&!a&&n.pop();l.push(1==n.length?n[0]:ke(AST_ObjectKeyVal,t,{key:n[0].key,value:we(t,n.map(function(e){return e.value}))})),e&&l.push(e),n.length=0}),f=[],c=new Dictionary}function _(e){var n=e.key;n instanceof AST_Node&&(o=!0,(n=n.evaluate(i))===e.key||"__proto__"===n?a=!0:n=e.key=""+n),st(e)?(e.value.has_side_effects(i)&&u(),f.push(n),c.add(n,e)):(u(),l.push(e)),o&&!a&&"string"==typeof n&&y.test(n)&&(a=!0,(e=c.has(n)?c.get(n)[0]:e).key=ke(AST_Number,e,{value:+n}))}}),(n=function(e,n){e.DEFMETHOD("try_inline",n)})(AST_Node,noop),n(AST_Assign,noop),n(AST_Await,function(t,e,n,i){if(t.option("awaits")){var r=this,e=r.expression.try_inline(t,e,n,i,!0);if(e)return n||yn(e,function(e){e.in_bool=!1;var n=e.value;n instanceof AST_Await||(e.value=ke(AST_Await,r,{expression:n||ke(AST_Undefined,e).transform(t)}))}),q(e)?e:ke(AST_BlockStatement,r,{body:[e,ke(AST_SimpleStatement,r,{body:ke(AST_Await,r,{expression:ke(AST_Number,r,{value:0})})})]})}}),n(AST_Binary,function(n,e,t,i,r){if(void 0!==t){var o=this,a=o.operator;if(Ne[a]){e=o.right.try_inline(n,e,t,i,r);if(e)return ke(AST_If,o,{condition:function(e){switch(a){case"&&":return e;case"||":return e.negate(n);case"??":return ke(AST_Binary,o,{operator:"==",left:ke(AST_Null,o),right:e})}}(o.left),body:e,alternative:t?null:ke(AST_Return,o,{value:ke(AST_Undefined,o).transform(n)})})}}}),n(AST_BlockStatement,function(e,n,t,i){if(!t&&this.variables){var r=this.body,o=r.length-1;if(!(o<0)){e=r[o].try_inline(e,this,t,i);if(e)return r[o]=e,this}}}),n(AST_Call,function(i,r,e,o,n){if(!(i.option("inline")<4)){var t=this;if(!t.is_expr_pure(i)){var a=t.expression;if(a instanceof AST_LambdaExpression&&!a.name&&!(a.single_use||a.uses_arguments||a.pinned()||is_generator(a))){var s=is_arrow(a);if(!(s&&a.value||a.body[0]instanceof AST_Directive||a.contains_this())){r=r||xe(i);var f=new Dictionary;for(f.set("NaN",!0);!(r instanceof AST_Scope);)r.variables.each(function(e){f.set(e.name,!0)}),r=r.parent_scope;if(member(r,i.stack)&&!(r.pinned()&&a.variables.size()>(s?0:1))){if(r instanceof AST_Toplevel){if(a.variables.size()>(s?0:1)){if(!i.toplevel.vars)return;if(0<a.functions.size()&&!i.toplevel.funcs)return}f.set("arguments",!0)}var c=!n&&is_async(a);if(c){if(!i.option("awaits"))return;if(!is_async(r))return;if(t.may_throw(i))return}var l=r.var_names();if(o=o&&[],a.variables.all(function(e,n){return o&&o.push(e),!f.has(n)&&!l.has(n)||!s&&"arguments"==n&&1==e.orig.length})&&!(o&&0<o.length&&it(a,o))){var u,_,S,p,d,A=!0;if(all(a.argnames,function(e){var n=!1,t=new TreeWalker(function(e){return!!n||(e instanceof AST_DefaultValue?ct(a,e.value)?n=!0:(e.name.walk(t),!0):e instanceof AST_DestructuredKeyVal?e.key instanceof AST_Node&&ct(a,e.key)?n=!0:(e.value.walk(t),!0):e instanceof AST_SymbolFunarg&&!all(e.definition().orig,function(e){return!(e instanceof AST_SymbolDefun)})?n=!0:void 0)});return e.walk(t),!n&&(e instanceof AST_SymbolFunarg||(A=!1),!0)})){if(a.rest){if(ct(a,a.rest))return;A=!1}if(e?u=function(e){var n=!1;return e.walk(new TreeWalker(function(e){return!!n||(c&&(e instanceof AST_Await||e instanceof AST_ForAwaitOf)||e instanceof AST_Return?n=!0:e instanceof AST_Scope||void 0)})),!n}:(n||is_async(a)||B(r))&&(u=function(e){var n=!1,t=new TreeWalker(function(e){return!!n||(e instanceof AST_Return?n=!0:e instanceof AST_Scope||void 0)});return e.walk(new TreeWalker(function(e){return!!n||(e instanceof AST_Try?e.bfinally?(all(e.body,function(e){return e.walk(t),!n})&&e.bcatch&&e.bcatch.walk(t),!0):void 0:e instanceof AST_Scope||void 0)})),!n}),!u||all(a.body,u))if(Ln(a,jn(i,r)))return a.functions.each(function(e,n){r.functions.set(n,e)}),_=[],a.variables.each(function(n,e){if((s||"arguments"!=e||1!=n.orig.length)&&(l.set(e,!0),r.enclosed.push(n),r.variables.set(e,n),n.single_use=!1,o)&&n.references.length!=n.replaced){switch(n.orig.length-n.eliminated){case 0:return;case 1:if(a.functions.has(e))return}var t;!all(n.orig,function(e){return!(e instanceof AST_SymbolConst||(e instanceof AST_SymbolFunarg?e.unused||n.scope.resolve()===a:e instanceof AST_SymbolLet))})||(t=n.orig[0])instanceof AST_SymbolCatch||(_.push(ke(AST_SimpleStatement,t,{body:ut(i,ft(t))})),n.first_decl=null)}}),S=Object.create(null),p=new Dictionary,A&&all(t.args,function(e){return!(e instanceof AST_Spread)})?(d=t.args.slice(),a.argnames.forEach(function(e){var n=d.shift();e.unused?n&&_.push(ke(AST_SimpleStatement,t,{body:n})):(n=ke(AST_VarDef,t,{name:e.convert_symbol(AST_SymbolVar,T),value:n||ke(AST_Undefined,t).transform(i)}),e instanceof AST_SymbolFunarg&&lt(e.definition(),n),_.push(ke(AST_Var,t,{definitions:[n]})))}),d.length&&_.push(ke(AST_SimpleStatement,t,{body:we(t,d)}))):_.push(ke(AST_Var,t,{definitions:[ke(AST_VarDef,t,{name:ke(AST_DestructuredArray,t,{elements:a.argnames.map(function(e){return e.unused?ke(AST_Hole,e):e.convert_symbol(AST_SymbolVar,T)}),rest:a.rest&&a.rest.convert_symbol(AST_SymbolVar,T)}),value:ke(AST_Array,t,{elements:t.args.slice()})})]})),p.each(function(e,n){n=S[n];[].unshift.apply(n.orig,e),n.eliminated+=e.length}),[].push.apply(_,o?a.body.filter(function(e){var n,t;return!(e instanceof AST_LambdaDefinition&&((t=(n=ke(AST_SymbolVar,ft(e.name))).definition()).fixed=!1,t.orig.push(n),t.eliminated++,_.push(ke(AST_Var,e,{definitions:[ke(AST_VarDef,e,{name:n,value:vn(e,!0)})]})),1))}):a.body),n=ke(AST_BlockStatement,t,{body:_}),e||(c&&yn(n,function(e){var n=e.value;Ce(n)||(e.value=ke(AST_Await,t,{expression:n}))}),_.push(ke(AST_Return,t,{value:B(r)?ke(AST_Undefined,t).transform(i):null}))),n}}}}}}}function T(e,n){n=n.definition();S[n.id]=n,p.add(n.id,e)}}),n(AST_Conditional,function(e,n,t,i,r){var o=this,a=o.consequent.try_inline(e,n,t,i,r),e=o.alternative.try_inline(e,n,t,i,r);if(a||e)return ke(AST_If,o,{condition:o.condition,body:a||s(o.consequent),alternative:e||s(o.alternative)});function s(e){return t?ke(AST_SimpleStatement,e,{body:e}):ke(AST_Return,e,{value:e})}}),n(AST_For,function(e,n,t,i){var r=this.body.try_inline(e,n,!0,!0),o=(r&&(this.body=r),this.init);return(o=o&&o.try_inline(e,n,!0,i))?(this.init=null,o instanceof AST_BlockStatement?(o.body.push(this),o):ke(AST_BlockStatement,o,{body:[o,this]})):r&&this}),n(AST_ForEnumeration,function(e,n,t,i){var r=this.body.try_inline(e,n,!0,!0),o=(r&&(this.body=r),this.object);if(o instanceof AST_Sequence){e=_t(e,n,!0,i,!1,o,1);if(e)return this.object=o.tail_node(),e.body.push(this),e}return r&&this}),n(AST_If,function(e,n,t,i){var r=this.body.try_inline(e,n,t,i),o=(r&&(this.body=r),this.alternative),t=((o=o&&o.try_inline(e,n,t,i))&&(this.alternative=o),this.condition);if(t instanceof AST_Sequence){e=_t(e,n,!0,i,!1,t,1);if(e)return this.condition=t.tail_node(),e.body.push(this),e}return(r||o)&&this}),n(AST_IterationStatement,function(e,n,t,i){e=this.body.try_inline(e,n,!0,!0);if(e)return this.body=e,this}),n(AST_LabeledStatement,function(e,n,t,i){e=this.body.try_inline(e,n,t,i);if(e)return this.body instanceof AST_IterationStatement&&e instanceof AST_BlockStatement?(n=e.body.pop(),this.body=n,e.body.push(this),e):(this.body=e,this)}),n(AST_New,noop),n(AST_Return,function(e,n,t,i){var r=this.value;return r&&r.try_inline(e,n,void 0,"try"===i)}),n(AST_Sequence,function(e,n,t,i,r){return _t(e,n,t,i,r,this)}),n(AST_SimpleStatement,function(e,n,t,i){for(var r=this.body;r instanceof AST_UnaryPrefix;){var o=r.operator;if(unary_side_effects[o])break;if("void"==o)break;r=r.expression}return(r=t||Ce(r)?r:ke(AST_UnaryPrefix,this,{operator:"void",expression:r})).try_inline(e,n,t||!1,i)}),n(AST_UnaryPrefix,function(t,e,n,i,r){var o=this,a=o.operator;if(!unary_side_effects[a]){e=o.expression.try_inline(t,e,n=n||"void"!=a?n:!1,i,r);if(e)return n||yn(e,function(e){e.in_bool=!1;var n=e.value;"void"==a&&Ce(n)||(e.value=ke(AST_UnaryPrefix,o,{operator:a,expression:n||ke(AST_Undefined,e).transform(t)}))}),e}}),n(AST_With,function(e,n,t,i){var t=this.body.try_inline(e,n,t,i),r=(t&&(this.body=t),this.expression);if(r instanceof AST_Sequence){e=_t(e,n,!0,i,!1,r,1);if(e)return this.expression=r.tail_node(),e.body.push(this),e}return t&&this}),n(AST_Yield,function(e,n,t,i){if(e.option("yields")&&this.nested){var r=this.expression;if("Call"==r.TYPE){var o=r.expression;switch(o.CTOR){case AST_AsyncGeneratorFunction:o=ke(AST_AsyncFunction,o);break;case AST_GeneratorFunction:o=ke(AST_Function,o);break;default:return}return(r=r.clone()).expression=o,r.try_inline(e,n,t,i)}}}),e(AST_Return,function(e,n){var t=e.value;return t&&n.option("side_effects")&&Ce(t,n)&&!B(n.find_parent(AST_Scope))&&(e.value=null),e})}(function(e,n){e.DEFMETHOD("optimize",function(e){return this._optimized||e.has_directive("use asm")?this:((e=n(this,e))._optimized=!0,e)})});


// prop
"use strict";function get_builtins(){var t=new Dictionary,e=(["NaN","null","true","false","Infinity","-Infinity","undefined"].forEach(n),["encodeURI","encodeURIComponent","escape","eval","decodeURI","decodeURIComponent","isFinite","isNaN","parseFloat","parseInt","unescape"].forEach(n),Function("return this")());return["Array","ArrayBuffer","Atomics","BigInt","Boolean","console","DataView","Date","Error","Function","Int8Array","Intl","JSON","Map","Math","Number","Object","Promise","Proxy","Reflect","RegExp","Set","String","Symbol","WebAssembly"].forEach(function(t){n(t);t=e[t];if(t&&(Object.getOwnPropertyNames(t).map(n),"function"==typeof t)){t.__proto__&&Object.getOwnPropertyNames(t.__proto__).map(n),t.prototype&&Object.getOwnPropertyNames(t.prototype).map(n);try{Object.getOwnPropertyNames(new t).map(n)}catch(e){try{Object.getOwnPropertyNames(t()).map(n)}catch(e){}}}}),(get_builtins=function(){return t.clone()})();function n(e){t.set(e,!0)}}function reserve_quoted_keys(e,t){function n(e){push_uniq(t,e)}e.walk(new TreeWalker(function(e){e instanceof AST_ClassProperty||e instanceof AST_DestructuredKeyVal||e instanceof AST_ObjectProperty?e.key instanceof AST_Node?addStrings(e.key,n):e.start&&e.start.quote&&n(e.key):e instanceof AST_Dot?e.quoted&&n(e.property):e instanceof AST_Sub&&addStrings(e.property,n)}))}function addStrings(e,t){e instanceof AST_Conditional?(addStrings(e.consequent,t),addStrings(e.alternative,t)):e instanceof AST_Sequence?addStrings(e.tail_node(),t):e instanceof AST_String&&t(e.value)}function mangle_properties(e,n){var r,o,t=(n=defaults(n,{builtins:!1,cache:null,debug:!1,domprops:!1,keep_quoted:!1,regex:null,reserved:null},!0)).builtins?new Dictionary:get_builtins(),a=(n.domprops||"undefined"==typeof domprops||domprops.forEach(function(e){t.set(e,!0)}),Array.isArray(n.reserved)&&n.reserved.forEach(function(e){t.set(e,!0)}),-1),i=(n.cache?(r=n.cache.props).each(function(e){t.set(e,!0)}):r=new Dictionary,n.regex),s=!1!==n.debug,c=(s&&(o=!0===n.debug?"":n.debug),new Dictionary),p=t.clone();function f(e){return!p.has(e)&&!/^-?[0-9]+(\.[0-9]+)?(e[+-][0-9]+)?$/.test(e)}function u(e){if(t.has(e))AST_Node.info("Preserving reserved property {this}",e);else{if(!i||i.test(e))return r.has(e)||c.has(e);AST_Node.info("Preserving excluded property {this}",e)}}function d(e){f(e)&&c.set(e,!0),u(e)||p.set(e,!0)}function l(e){if(!u(e))return e;var t,n=r.get(e);if(!n){if(!(n=s&&f(t="_$"+e+"$"+o+"_")?t:n))for(;!f(n=base54(++a)););/^#/.test(e)&&(n="#"+n),r.set(e,n)}return AST_Node.info("Mapping property {name} to {mangled}",{mangled:n,name:e}),n}function y(e){e instanceof AST_Sequence?y(e.tail_node()):e instanceof AST_String?e.value=l(e.value):e instanceof AST_Conditional&&(y(e.consequent),y(e.alternative))}e.walk(new TreeWalker(function(e){if("Call"==e.TYPE){var t=e.expression;if(t instanceof AST_Dot)switch(t.property){case"defineProperty":case"getOwnPropertyDescriptor":e.args.length<2||(t=t.expression)instanceof AST_SymbolRef&&"Object"==t.name&&t.definition().undeclared&&addStrings(e.args[1],d);break;case"hasOwnProperty":e.args.length<1||addStrings(e.args[0],d)}}else e instanceof AST_ClassProperty||e instanceof AST_DestructuredKeyVal||e instanceof AST_ObjectProperty?e.key instanceof AST_Node?addStrings(e.key,d):d(e.key):e instanceof AST_Dot?is_lhs(e,this.parent())&&d(e.property):e instanceof AST_Sub&&is_lhs(e,this.parent())&&addStrings(e.property,d)})),e.walk(new TreeWalker(function(e){if(e instanceof AST_Binary)"in"==e.operator&&y(e.left);else if("Call"==e.TYPE){var t=e.expression;if(t instanceof AST_Dot)switch(t.property){case"defineProperty":case"getOwnPropertyDescriptor":e.args.length<2||(t=t.expression)instanceof AST_SymbolRef&&"Object"==t.name&&t.definition().undeclared&&y(e.args[1]);break;case"hasOwnProperty":e.args.length<1||y(e.args[0])}}else e instanceof AST_ClassProperty||e instanceof AST_DestructuredKeyVal||e instanceof AST_ObjectProperty?e.key instanceof AST_Node?y(e.key):e.key=l(e.key):e instanceof AST_Dot?e.property=l(e.property):e instanceof AST_Sub&&(n.keep_quoted||y(e.property))}))}


// script
"use strict";var uglify_options,default_options={};function $(t){return document.getElementById(t)}var default_options_text,last_input,ait_timeout,$options=$("options"),$out=$("out"),$in=$("in"),$error=$("error"),$stats=$("stats"),$body=document.body,$btn_options=$("btn-options"),$btn_options_save=$("btn-options-save"),$cb_as_i_type=$("cb-as-i-type");function hide(t){for(var o=t.split(" "),e=" "+$body.className+" ",n=0;n<o.length;n++)for(;0<=e.indexOf(" "+o[n]+" ");)e=e.replace(" "+o[n]+" "," ");$body.className=e.replace(/^\s+|\s+$/g,"")}function show(t){$body.className+=" "+t}function show_options(){show("s-options"),hide("s-input")}function get_options(t){return new Function("return ("+(t||$options.value)+");")()}function set_options(){var o=uglify_options;try{uglify_options=get_options();try{default_options_text===$options.value?localStorage.removeItem("uglify-options"):localStorage.setItem("uglify-options",$options.value)}catch(t){}return go(!0),show("s-input"),hide("s-options"),!0}catch(t){return t instanceof JS_Parse_Error?(show_error(t,$in.value),!0):(uglify_options=o,show_error(t),!1)}}function reset_options(){$options.value=default_options_text,set_options()}function set_options_ait(){try{$cb_as_i_type.checked?localStorage.removeItem("uglify-options-disable-ait"):localStorage.setItem("uglify-options-disable-ait",1)}catch(t){}}function set_options_initial(){default_options_text=$options.textContent||$options.innerText,default_options=get_options(default_options_text);try{var t=localStorage.getItem("uglify-options");t&&($options.value=t),$cb_as_i_type.checked=!localStorage.getItem("uglify-options-disable-ait")}catch(t){}try{uglify_options=get_options()}catch(t){$options.value=default_options_text,uglify_options=default_options}}function encodeHTML(t){return(t+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/"/g,"&quot;")}function go(t){var o=$in.value;if(last_input=o,!0===t)e();else try{e()}catch(t){show_error(t,o)}function e(){if(o&&o!==$in.textContent){var t=minify(o,uglify_options);if(t.error)throw t.error;hide("s-info s-error"),show("s-output"),$out.value=t.code||"/* no output! */",$stats.innerHTML=t.code.length+" bytes, saved "+(100*(1-t.code.length/o.length)||0).toFixed(2)+"%"}else go_to_start()}}$("header-link").onclick=go_to_start,$("btn-go").onclick=go,$btn_options.onclick=show_options,$btn_options_save.onclick=set_options,$("btn-options-reset").onclick=reset_options,$in.oninput=$in.onkeyup=$in.onblur=$in.onfocus=go_ait,$cb_as_i_type.onclick=set_options_ait,$out.onfocus=select_text,set_options_initial();var ait_last_duration=50;function go_ait(){var t;$cb_as_i_type.checked&&(t=$in.value)!==last_input&&(last_input=t,clearTimeout(ait_timeout),ait_timeout=setTimeout(function(){var t=new Date;go(),ait_last_duration=new Date-t},ait_last_duration))}function show_error(t,o){var e;console.error("Error",t),hide("s-info s-output"),show("s-error"),t=t instanceof JS_Parse_Error?(e=(o=o.split("\n"))[t.line-1],"Parse error: <strong>"+encodeHTML(t.message)+"</strong>\n<small>Line "+t.line+", column "+(t.col+1)+"</small>\n\n"+(o[t.line-2]?t.line-1+": "+encodeHTML(o[t.line-2])+"\n":"")+t.line+": "+encodeHTML(e.substr(0,t.col))+"<mark>"+encodeHTML(e.substr(t.col,1)||" ")+"</mark>"+encodeHTML(e.substr(t.col+1))+"\n"+(o[t.line]?t.line+1+": "+encodeHTML(o[t.line]):"")):t instanceof Error?t.name+": <strong>"+encodeHTML(t.message)+"</strong>":"<strong>"+encodeHTML(t)+"</strong>",$error.innerHTML=t}function go_to_start(){return clearTimeout(ait_timeout),hide("s-options s-error s-output"),show("s-input s-info"),!1}function select_text(){var t=this;return t.select(),!(t.onmouseup=t.onkeyup=function(){return t.onmouseup=t.onkeyup=null,t.scrollTop=0,!1})}
